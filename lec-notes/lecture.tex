\documentclass[lang=cn,11pt]{elegantbook}
\usepackage[utf8]{inputenc}
\usepackage[UTF8]{ctex}
\usepackage{amsmath}%
\usepackage{amssymb}%
\usepackage{graphicx}
\usepackage{pdfpages}

\title{Math 597: advanced Real Analysis}
\subtitle{Following Folland' book.}

\begin{document}
\frontmatter
\tableofcontents
\mainmatter



\chapter*{Prologue}
\noindent In this Prologue, we will only state important prerequisites that we should know without proving them, for the sake of time saving.
\section{set theory}
\begin{definition}{$\limsup$ and $\liminf$ of of a sequence of sets}
$$
\limsup E_n = \intsec_{k=1}^\infty \union_{n=k}^\infty E_n
$$
$$
\liminf E_n = \union_{k=1}^\infty \intsec_{n=k}^\infty E_n
$$
\end{definition}
limsup represent the elements that occur in infinitely many $E_n$; and liminf represent the elements that occur in all but finitely many $E_n$.


    
\begin{definition}{Cartesian product}
Let $A$ be some index set, define
    $$
    \prod_{\alpha \in A} X_\alpha := \{ f: A\rar \union_{\alpha \in A} X_\alpha \mid f(\alpha) \in X_\alpha \forall \alpha   \}
    $$
\end{definition}
Notice that if all $X_\alpha = Y$ for a fixed $Y$, then we have $\prod_{\alpha \in A} X_\alpha = Y^A$.

\section{ordering}
\begin{definition}{partial ordering, linear ordering}
    A partial ordering on a nonempty set $X$ is a relation $R$ that is 
    \begin{enumerate}
        \item transitive: $xRy, yRz \implies xRz$
        \item reflexitive: $xRx \; \forall x$
        \item antisymmetric: $xRy,yRx \implies x=y$
    \end{enumerate}
    A linear ordering $R$ is a partial ordering that also satisfies:
    \begin{enumerate}[resume]
        \item strongly connected: $\forall x,y \in X$, either $xRy$ or $yRx$.
    \end{enumerate}
\end{definition}



\begin{axiom}{The Hausdorff Maximal Principle}\label{The Hausdorff Maximal Principle}
Every partially ordered set has a maximal linearly ordered subset. (i.e. there is a linearly ordered subset s.t. no other subset properly including it is linearly ordered.)
\end{axiom}

\begin{definition}{maximal/minimal element}
    A maximal element $x \in X$ means that no other element is greater than it. (notice: \textbf{It is possible that there exists another element that cannot be compared with it. The definition only says they cannot be greater than it.})\\
    Dually can define minimal element.
\end{definition}
\begin{axiom}{Zorn's Lemma} \label{Zorn's Lemma}
If $X$ is a partially ordered set and every linearly ordered subset has an upper bound, then $X$ has a maximal element.
\end{axiom}
\begin{remark}
    Zorn's Lemma and the Hausdorff Maximal Principle can imply each other.
\end{remark}

\begin{definition}{well ordering}
If $X$ is linearly ordered and every nonempty subset has a \textbf{unique minimal element}, then $X$ is said to be \textbf{well ordered}.
\end{definition}


\begin{lemma}{well ordering principle}
    Every nonempty set can be well ordered.
\end{lemma}

\begin{corollary}{Axiom of choice}
    The Cartesian product of a nonempty collection of nonempty sets is nonempty.
\end{corollary}

\section{cardinality}
\begin{proposition}
    Let $X$ be any set. We must have $\card(\cP(X)) > \card(X)$
\end{proposition}

\begin{definition}
 $$\mathfrak{c} := \card(\bR)$$
\end{definition}

\begin{proposition}
    \begin{equation}
        \card(\cP(\bN)) = \mathfrak{c}
    \end{equation}
\end{proposition}
\begin{proof}
    Using base-2 expansion, can create a bijective function from $\cP(\bN)$ to $[0,1]$.
\end{proof}


\begin{proposition}
    Given $f: X \rar [0,\infty)$, $A:= \{ f(x)>0 \}$, if $A$ is uncountable, then $\sum_{x \in X}f(x) = \infty$
\end{proposition}


\section{topology in metric space}
\begin{definition}{dense, nowhere dense, separable}
We say $E \sub X$ is dense in $X$ if $\overline{E} = X$.\\
We say $E \sub X$ is nowhere dense in $X$ if 
$\overline{E} = \emptyset $.\\
We say $X$ is separable if it has a countable dense subset.
\end{definition}


\begin{proposition}
    TFAE for metric spaces:
    \begin{enumerate}
        \item $x \in \overline{E}$.
        \item Every open ball centered at $x$ has nonempty intersection with $E$.
        \item There is a seq in $E$ converging to $x$.
    \end{enumerate}
\end{proposition}


\begin{definition}{Cauchy, complete}
    A sequence in metric space $X$ is said to be Cauchy if $d(x_n,x_m) \rar 0$ as $n,m \rar \infty$.\\
    A subset $E\sub E$ is said to be complete if every Cauchy sequence in $E$ converges.
\end{definition}

\begin{proposition}
    Complete is a stronger condition than closed, in any metric space. And a closed subset of a complete metric space is complete.
\end{proposition}

\begin{theorem}
    TFAE for metric spaces:
    \begin{enumerate}
        \item $E$ is complete and totally bounded.
        \item $E$ is compact.
        \item $E$ is sequentially compact. (Every sequence in $E$ has a subseq converging to some point in $E$.)
    \end{enumerate}
\end{theorem}


\chapter{$\sigma$-algebra}
\noindent 我们在 395 中已经证明: 在 $\bR$ 上不存在一个 measure function $\mu : \cP(\bR) \rar [0,\infty]$ satisfying:
\begin{enumerate}
    \item $\mu(\emptyset) = 0$;
    \item translate invariant
    \item countably additivite
\end{enumerate}

\noindent 因而, 对于比如 $\bR$ 的这种无法在其幂集上定义良好的 measure function 的集合, 我们要定义一个 $\cA \sub \cP(X)$, 使得我们能在这个 power set 的子集上, 定义一个 make sense 的 measure.\\\\
\noindent 
首先, 为了对于一个任意的集合 $X$ 都能在其上定义 measure, 我们要考虑在 $X$ 的一个什么样的子集簇上有希望定义这样的 measure. 

\begin{definition}{algera, $\sigma$-algebra}
对于 set $X$, $S \sub \cP(X)$ 被称为 $X$ 上的一个 $\sigma$-algebra, if 其满足:
\begin{enumerate}
    \item $\emptyset \in X$;
    \item \textbf{closed under complement}: if $E \in S$ then $X \setminus E \in S$;
    \item \textbf{closed under countable union}: if $E_1,E_2,\cdots \in S$ then $\union_{k=1}^\infty E_k \in S$.
\end{enumerate}
如果第三条并不满足, 而是只满足 \textbf{closed under finite union}, 则称 $S$ 是 $X$ 上的一个 algebra. 当然, $\sigma$-algebra 是比 algebra 严格更强的条件.
\end{definition}

\noindent 我们定义 $X$ 的一个子集簇为一个 $\sigma$-algebra 如果它包含空集并 closed under complement and countable union. 但这并不是 $\sigma$-algebra 的全部性质. 这三个性质还蕴涵了: $\sigma$-algebra 也一定包含 $X$, 且 \textbf{closed under set difference}, \textbf{symmetric difference} 以及 \textbf{countable intersection}. \\
\noindent \textbf{对于 algebra, 它也有以上的所有性质的 finite version.}


\begin{theorem}{$\sigma$-algebra also closed under set difference, symmetric difference and countable intersection}
    Let $S$ be a $\sigma$-algebra on set $X$.\\
    Claim: 
    \begin{enumerate}
        \item $X \in S$
        \begin{proof}
            Directly from def.
        \end{proof}
        \item $D,E \in S \implies D\cup E, D\cap E, D \setminus E \in S$
        \begin{proof}
            union: from def by leaving others as $\emptyset$; \\intersection: $$(D\cap E)^C = D^C \cup E^C \in S$$
            setminus: $$ D\setminus E = D \cap (X \setminus E) \in S$$    
        \end{proof}
        \item $D,E \in S \implies D \Delta S\in S$
        \begin{proof}
        $$
        D \Delta E = (D \setminus E) \union (E \setminus D)
        $$
        \end{proof}
        \item $A_1,A_2,\cdots \in S \implies \intsec_{i=1}^\infty A_i \in S$
        \begin{proof}
            $$(\intsec_{n=1}^\infty )^C = \union_{n=1}^\infty E_n ^C \in S  $$
        \end{proof}
    \end{enumerate}
\end{theorem}

\begin{remark}
    我们发现 $\sigma$-algerbra 很像是 topology. 实际上 $\sigma$-algerbra 和 topology 的区别就是: $\sigma$-algebra 只保证了 closed under countable union 而 topology closed under any union; topology 只保证 closed under finite intersection 而 $\sigma$-algebra closed under countable intersection.
\end{remark}


\begin{lemma}{任意 $\sigma$-algebra 的 intersection 仍是 $\sigma$-algebra}
Let $\{S_\alpha \}_{\alpha \in A}$ be a collection of $\sigma$-algebra on $X$, then $\intsec_{\alpha \in A} S_\alpha$ is a $\sigma$-algebra on $X$. 
\end{lemma}
\begin{proof}
    这是个 trivial proof. 但是它具有一定理解上的启发.\\
    我们对 $\sigma$-algebra 有一个直观理解: 如果我们想把一些集合做成一个 $\sigma$-algebra, 那么首先我们把它们的补集放进这个 $\sigma$-algebra 里, 其次我们把这些集合的 up to countable 的任意组合的并集也放进这个 $\sigma$-algebra 里.\\
    因而即便我们把一些 $\sigma$-algebra 给 intersect 起来, 其中每个集合的补集和这些集合的 up to ctbl 的任意组合的并集也在这个 intersection 里.\\
    这是个重要的直观理解. 我们想到, 如果我们要把一个 sigma-algebra 里的一部分去掉，并保持它仍然是一个 sigma-algebra，那么我们得把这些集合的补集, 以及能够 ctbly union 成这些集合的小集合也去掉, 并对这些小集合也 recursively 进行这个操作.
\end{proof}

\begin{corollary}{unique smallest $\sigma$-algebra containing a collection of subsets}
    Given $\varepsilon  \sub \cP(X)$
    $$
    <\varepsilon> := \intsec_{\varepsilon  \sub S \sub \cP(X), \newline S \text{ is }\sigma \text{ -algebra on } X} S
    $$
\end{corollary}

\begin{definition}{$\sigma$-algebra generated by a subset}
We call  $$
    <\varepsilon> := \intsec_{\varepsilon  \sub S \sub \cP(X), \newline S \text{ is }\sigma \text{ -algebra on } X} S
    $$ \textbf{the $\sigma$-algebra generated by $\varepsilon$ }
\end{definition}



\chapter{Borel $\sigma$-algebra on $\bR$ and measure}
\noindent Recall: the $\sigma$-algebra generated by $\varepsilon$
    $$
    <\varepsilon> := \intsec_{\varepsilon  \sub S \sub \cP(X), \newline S \text{ is }\sigma \text{ -algebra on } X} S
    $$ is the smallsest $\sigma$-algebra containing $\varepsilon$.


\begin{example}
\begin{equation}
    <\{ E\}> = \{ \emptyset, E, E^c, X       \}
\end{equation}
\end{example}


\begin{lemma}{inclusion properties of generated $\sigma$-algebra}
\label{inclusion properties of generated sigma-algebra}
\begin{enumerate}
    \item if $\cE \sub \cA$ where $\cA$ is a $\sigma$-algebra, then $<\cE> \sub \cA$.
    \item if $\cE \sub \cF$, then $<\cE> \sub <\cF>$.
    \item if $\cE \sub <\cF>$, then $<\cE> \sub <\cF>$.
\end{enumerate}
\end{lemma}
\begin{proof}
    trivial.
\end{proof}

\begin{definition}{Borel $\sigma$-algebra defined on a topological space}
For topological space $(X, \cT)$, we define:
$$
\cB_X := <\cT>
$$
\end{definition}
\noindent \textbf{Borel $\sigma$-algebra} on a topological space 就是 $\sigma$-algebra generated by the topology. Its members are called \textbf{Borel sets}. 当然, 所有的 open sets 和 closed sets 都是 Borel sets.




\section{generating Borel $\sigma$-algebra on $\bR$}
\begin{example}
    Let
    $\cE_1 $: $\bR$ 上所有的 open intervals; \\ 
    $\cE_2 $: $\bR$ 上所有的 closed intervals;\\
    $\cE_3 $: $\bR$ 上所有的左开右闭 intervals;\\
    $\cE_4 $: $\bR$ 上所有的左闭右开 intervals;\\
    $\cE_5 $: $\bR$ 上所有的左开右无界 intervals;\\
    $\cE_6 $: $\bR$ 上所有的左闭右无界 intervals;\\
    $\cE_7 $: $\bR$ 上所有的左无界右开 intervals;\\
    $\cE_8 $: $\bR$ 上所有的左无界右闭 intervals;\\
    $\union_{i=1,\cdots,8}\cE_i$ 即 $\bR$ 上的所有形式的 interals.
\begin{lemma}
    任意以上 $\cE_i, i=1,\cdots,8$ 都可以 generate $\cB_{\bR}$
\end{lemma}
\begin{proof}
    我们 recall: 所有的 countable 以及 second countable 的 topological space 都具有 \textbf{Lindelöf property}: 任意 open covering 都存在一个 countable 的 subcovering.\\
    Lindelöf property 的一个推论就是, 在具有 Lindelöf property 的 metric space 或者 second countable 的 space 中, 任意 open set 都可以写成 countable 个 open balls 的 union.\\
    我们在 elementary 的 real analysis 中已经学过, $[a,b) = \cap_{n \geq 1}(a-1/n, b)$, 以其作为例子, 这些 intervals 彼此之间都可以相互转换.
\end{proof}
\end{example}




\section{measure}
\begin{definition}{measurable space and measure space}
    Let $X$ be a set, $\cM$ be a $\sigma$-algebra on $X$.\\
    A measure on $(X,A)$ is a function $\mu: \cM \rar [0, \infty)$ satisfying:
    \begin{enumerate}
        \item $\mu(\emptyset) = 0$
        \item countable additive: 
        $$
        \mu(\union_{i=1}^\infty E_i) = \sum_{i=1}^{\infty} \mu(E_i)  
        $$ for disjoint seq of $E_i \in \cM$.
    \end{enumerate}

    如果这样的 $\mu$ 存在, 我们则称 $(X,\cM)$ 为一个 measurable space, 并称 $(X,\cM, \mu)$ 为一个 measure space.
\end{definition}
\begin{remark}
    一个 probability space 就是一个 measure space, satisfying $\mu(X) = 1$.
\end{remark}

\begin{example}
\begin{enumerate}
    \item 对于任意的 $(X, \cM)$, 我们可以定义:
    $$
    \mu(A) := \#A \;\;\;(\in \bZ_{\geq 0} \cup \{\infty \})
    $$
    这个 measure 叫做 \textbf{counting measure}.
    \item 
    Fix $x_0 \in M$, 可以 define
    $$
    \mu(A) := \delta_x := \begin{cases}
        1 \; \text{, if } x_0 \in A \\
        0 \; \text{, if } x_0 \not\in A \\
    \end{cases}
    $$
    这个 measure 叫做 the \textbf{Dirac measure at $x_0$}.
    \item 
    给定一个 $X$ 上的函数 $f: X \rar [0, \infty)$, 我们可以通过这个函数来定义:
    $$
    \mu(A) := \sum_{x \in A} f(x)
    $$
    这个测度依赖于函数值来表示每个点的单点集的 measure, 并通过一个集合上所有点的单点集 measure 相加得到这个集合在这个函数下的 measure. (缺点: 我们已经知道, 如果一个函数在一个集合上的正集是 uncountable 的, 那么这个集合上的这个测度一定是 $\infty$.)
    \end{enumerate}
\end{example}



\noindent 以下是 measure function 由它的定义的两条性质(空集为0以及 ctbl additivity)推导出的一些基本性质:

\begin{lemma}{measure is finitely additive}
    Measure is finitely additive.
\end{lemma}
\begin{proof}
    显然, ctbl additive implies finite additive.
\end{proof}

\begin{remark}
    反向则不成立. 这让我们想起: Jordan measure 和 Lebesgue measure. 
\end{remark}

\begin{lemma}
    $A,B\in \cM \implies$
    $$
    \mu(A) + \mu(B) = \mu(A \cap B) + \mu(A \cup B)
    $$
\end{lemma}
\begin{proof}
    $$A \cup B = (A \setminus B) \sqcup (A\cap B) \sqcup (B\setminus A)$$
    而后使用 finite additive 可得. 这是一个 direct corollary of countable additivity.
\end{proof}

\begin{corollary}
    $A,B\in \cM, A\sub B, \mu(A) < \infty \implies$
    $$
    \mu(B\setminus A) = \mu(B) - \mu(A)
    $$
\end{corollary}




\begin{theorem}{properties of measure}
    对于任何 measure space $(X,\cM, \mu)$:
    \begin{enumerate}
        \item \textbf{monotonicity}: $A \sub B \in \cM \implies \mu(A) \leq \,\mu(B)$
        \begin{proof}
            trivial.
        \end{proof}
        \item \textbf{countable subadditivity}: 
        $$
        \mu(\union_{i=1}^\infty A_i) \leq \sum_{i=1}^\infty \mu(A_i)
        $$
        \begin{proof}
            By setting $B_i = A_i \setminus \union_{j=1}^{i-1} A_j$, 而后通过 ctbl disjoint additivity 与 monotonicity 可得
        \end{proof}
        \item \textbf{continuous from above}: 
        如果 $A_i \sub A_{i+1} \forall i \geq 2\implies $
        $$
        \mu(\union_{i=1}^{\infty}A_i   ) = \lim_{i \rar \infty} \mu(A_i)
        $$
        \begin{proof}
            使用 same trick as 2.
        \end{proof}
        \item \textbf{countinuous from below}:
        如果 $A_i \supseteq A_{i+1} \forall i$ 且存在某个 $j$ 使得 $\mu(A_i) < \infty$, 则
        $$
        \mu(\intsec_{i=1}^{\infty}A_i) = \lim_{n \rar \infty} \mu(A_n)
        $$
        \begin{proof}
            前面的都无视, 直到第一个 measure $< \infty$ 的集合, 是可能出现在最后的 intersection 里的最大集合. 我们 Fix 这个 $A_j$. 通过构造补集的方式, 把交转为并, 从而用 (3) 得证.
            Define:
            $
            E_i := A_j \setminus A_i \forall i \geq j
            $
            从而
            $$
            \union_{i=j}^\infty E_i = A_j \setminus (\intsec_{i=j}^\infty A_i)
            $$进而 
            $$
            \mu( \union_{i=j}^\infty E_i) = \mu(A_j) - \mu(\intsec_{i=j}^\infty A_i)
            $$
            进而 by (3)
            $$
            \mu(\intsec_{i=1}^\infty A_i) = \mu(\intsec_{i=j}^\infty A_i) = \mu(A_j) - \lim_{i\rar \infty}\mu(E_i)  = \mu(A_j) - \lim_{i\rar \infty}(\mu(A_j) - \mu(A_i))
            = \lim_{i\rar \infty} A_i
            $$
            
        \end{proof}
    \end{enumerate}
\end{theorem}



\chapter{complete measure space and outer measure}

\begin{definition}{nul set, subnull set, almost everywhere}
对于 measure space $(X, \cM, \mu)$
\begin{enumerate}
    \item 我们称 $A \in \cM$ 为一个 \textbf{null set}, 如果 $\mu(A) = 0$;
    \item 我们称 $B \sub \cM$ 为一个 \textbf{subnull set}, 如果存在某个 null set $A$ containing it.
    \item 我们称一个 statement about $X$ 是 \textbf{almost everywhere (a.e.)} 的, 如果这个 statement 除了在某个 null set 上之外, 在 $X$ 上处处成立.
\end{enumerate}
\end{definition}


\begin{definition}{complete measure space}
    我们称 $(X,\cM, \mu)$ 是一个 complete measure space, 如果它其中的任意 subnull set 都是 null set. (即它 measurable)
\end{definition}
\begin{remark}
    我们知道, 根据 measure 的 monotonicity, subnull set 的 measure, 如果存在, 一定是 $\leq$ 它所在的 null set 的, 即一定 $=0$. 所以 complete measure space 的实际意思是： 这个 measure space 里, 任意 null set 的所有子集都是 measurable 的, 即所有足够小的集合都在这个 $\sigma$-algebra 里.
\end{remark}




\begin{example} 一个 not complete 的 measure space 的例子:
$$
X = \{1,2\}, \cM = {\emptyset, X}, \mu(\forall) = 0.
$$
这个例子中, $\{1\}, \{2\}$ 这两个集合不是 measurable 的, 但是却是 nullset (全集) 的子集.
\end{example}



\begin{theorem}{every measure space can be completed}
    Suppose $(X, \cM,\mu)$ is a measure space.\\
    Let 
    \[
    \cN := \{\text{all null sets in }   \cM \}
    \]
    Claim:
    \[
    \ol{M}  := \{   E\cap F \mid E \in \cM, F \sub N \text{ for some } N \in \cN \}
    \]
    is a $\sigma$-algebra, 并且在 $\ol{\cM}$ 上存在一个 unique 的 extension $\ol{\mu}$ of $\mu$.
\end{theorem}
\begin{proof}
    这一部分的 proof 以及 remark 在 hw2. 这里, $\overline{M}$ 称为 \textbf{completion of $\cM$ with respect to $\mu$}, 以及 $\overline{\mu}$ 称为 \textbf{completion of $\mu$.}
\end{proof}




\section{outer measure}
\begin{definition}{outer measure}
    An outer measure on $X$ is a function $\mu^*: \cP(X) \rar {0,\infty)}$ such that
    \begin{enumerate}
        \item $\mu(\varnothing) = 0$
        \item monotone ($A \sub B \implies \mu^*(A) \leq \mu^*(B)$)
        \item countable subadditive ($\mu^*(\union_{i=1}^\infty E_i)  \leq \sum_{i=1}^\infty \mu^*(E_i)$)
    \end{enumerate}
\end{definition}
\begin{remark}
    我们对比 measure 和 outer measure 的定义:
    measure 的条件比 outer measure 强在:
    \begin{enumerate}
        \item measure 是定义在一个严格的 $\sigma$-algebra 上的, 而 outer measure 则是定义在整个幂集上的. 
        \item measure 要求 disjoint countable additivity, outer measure 并不要求
    \end{enumerate}
\end{remark}

在这两个条件的缩减下, 我们规定 outer measure 具有 monotonicity 和 countable subadditivity. 注意: measure 本身也有这个性质, 这是 measure 的 countable additivity 的推论. \\
outer measure 的意义在于, 我们的 measure 只定义在 $\sigma$-algebra 上, 而我们想要给每个子集都赋予一个近似于测度的东西. 

\section{induce outer measure out of a "elementary length function"}
\begin{theorem}{construct outer measure out of an "elementary  length function" }\label{construct outer measure out of a "elementary length function"}
    另 $\cE \sub \cP(X)$ 为一个包含 $\varnothing, X$ 的集合, 并定义 $\rho: \cE \rar [0,\infty)$ 为一个满足 $\rho(\varnothing) = 0$ 的函数, 则
\[
\mu^*(A )  = \inf \{    \sum_{i=1}^\infty \rho(E_i) \mid E_i \in \cE \text{ for each i and }  A \sub \union_{i=1}^\infty E_i    \}
\]
is an outer measure.
\end{theorem}
\begin{proof}
\begin{enumerate}
    \item 取所有 $E_j = \varnothing$, 得到 $\mu^*(\varnothing) = 0$
    \item monotonicity 显然, 因为如果 $A \sub B$, 那么 $A$ 取 inf 的这个集合是包含于 $B$ 的, 因而取到的 inf 是小于等于的.
    \item  证明 ctbl subadditivity, 我们使用经典的 $\epsilon  / 2^i$ argument. 这个 statement 直观上是显然的, 因为对一个 seq of sets, 每一个里面都有一个 seq of covering, 那么这个 seq of seq of covering 总体也是这个 seq union 的一个  covering. 不过我们不能这么说, 因为这里有一个 inf 操作的换序. 所以我们令 $\epsilon >0$, 对于每个 $A_i$ 的 covering $(E_{i,k})_{k\in\bN}$, 我们令 $\sum_k \rho(E_{i,k}) \leq \mu^*(A_i) + \epsilon / 2^i$,  最后可以得到 $\mu^*(\union_i A_i) \leq \sum_i \mu^*(A_i)$. 由于 $\epsilon$ arbitrary, 得证.
\end{enumerate}
\end{proof}
\begin{example}
    我们取 $\cE$ 为 $\bR$ 上所有的 intervals, 并取 $\rho $ 为 interval 的 length, 就得到了一个外测度. (也就是 Lebesgue outer measure)
\end{example}





\chapter{$\mu^*$-measurability and Carathéodory's Theorem}


\section{$\mu^*$-measurable}
\begin{definition}{$\mu^*$-measurable}
    Given outer measure $\mu^*$, 我们称 $A \sub X$ 是 $\mu^*$-measurable 的, if:
    $$
    \mu^*(E) = \mu^*(E \cap A) + \mu^*(E \cap A^c)
    $$
\end{definition}
\begin{remark}
countable subadditivity 蕴含的信息是: 如果我们把一个集合 divide 成几部分, \textbf{其 outer measure 有可能 increase.}  而 $\mu^*$-measurable 的含义是: 任何一个其他集合, 分割为和 $E$ 重合以及和 $E$ 的两部分之后, 其 measure 都不会增大.\\
\noindent \textbf{Note: }\textbf{by subaddivity, must have $\mu^*(E) \leq \mu^*(E\cap A) + \mu^*(E\cap A^c)$}, 而 $\mu^*$-measurable 的集合, 则有 equality 总是成立.\\
\noindent 同时注意: 这个行为对于 complement 是对称的.
\end{remark}

\begin{remark}
 outer measure 是对于整个 power set 中每一个集合都赋予的, 并且其性质 ctbl subadditivity 严格弱于 countable additivity. 
 我们自然想到: 是否有一个 power set 的子集, 其不仅是一个 $\sigma$-algebra, 并且其上满足 countable additivity? 如果存在, 那么我们就从 outer measure induce 出了 measure. 
 \\ \noindent 再加上之前的用随意的 length function 来 induce outer measure 的方法, 我们就可以通过一个随意的 length function $\rar $ outer measre $\rar$ measure. (eg: 从 box length induce 出 Legesgue outer measure, 再 induce 出 Lebesgue measure).\\
 \noindent 而实际上这个想法是正确的. 只要把 $\mu^*$ 的范围限制在所有 $\mu^*$-measurable sets 上, 就形成了 $\sigma$-algebra, 并且其 restriction 是一个 measure,  甚至是一个 complete measure.
\end{remark}

\section{Carathéodory's Theorem}

\begin{theorem}
\label{Carathéodory's Theorem}
对于任意的 outer measure $\mu^*$, 
\[
\cM := \{ \text{all } \mu^* \text{-measurable sets}    \}
\]\textbf{is a $\sigma$-algebra}.\\
并且, $\mu^* |_\cM$ \textbf{is a complete measure.}
\end{theorem}
\begin{proof}
我们首先证明这个 $\cM$ 是一个 $\sigma$-algebra
\begin{enumerate}
    \item  $\varnothing \in \cM$ by def.
    \item $\cM$ closed under complement, by def of $\mu^*$-measurablity. (它对于 complement 是对称的.)
    \item 为证明 $\cM$ closed under countable union, 我们首先 prove it for two sets.
    假设 $A, B \in \cM$, 且 disjoint. 
    Let $E \sub X$.
    我们已知 
    \begin{equation}
        \mu^*(E) = \mu^*(E \cap A) + \mu^*(E \cap A^c)
    \end{equation}
 \textbf{我们 WTS: $\mu^*(E) = \mu^*(E \cap (A\cup B)) + \mu^*(E \cap (A\cup B)^c)$}\\
\noindent 我们对于 $E \cap A$, $E\cap A^c$ 可以得到: \begin{equation}
    \mu^*(E \cap A) = \mu^*(E \cap A \cap B) + \mu^*(E \cap A \cap B^c)
\end{equation}
\end{enumerate}
\begin{equation}
    \mu^*(E \cap A^c) = \mu^*(E \cap A ^c\cap B) + \mu^*(E \cap A^c \cap B^c)
\end{equation}

By  $A \cup B = (A \setminus B) \sqcup (A\cap B) \sqcup (B\setminus A)$, 可以得到:
\begin{equation}
   \mu^*(E \cap (A\cup B)) \geq \mu^*(E \cap A \cap B) + \mu^*(E \cap A \cap B^c) + \mu^*(E \cap A^c \cap B)
\end{equation}
结合以上四个 equations 可以得到
\begin{equation}
    \mu^*(E) \geq \mu^*(E\cap (A\cup B)) + \mu^*(E\cap (A \cup B^c))
\end{equation}
又 $\leq$ by countable subadditivity 成立, 我们得证 closed under two union (从而 inductively closed under any finite union, $\cM$ 因而是一个 algebra).\\
\begin{remark}
    (Note: 这里我会想: 证明了这个 statement for any union of two sets 不就是证明了它对 any union 都成立吗? 实则不然, 因为 set union 的从属关系并不是可以从对任意 $n$ 成立推广到对无穷成立, 因为这里的无穷是一个真实存在的 sequence, 而我们可以从"任意 $n$ 成立推广到对无穷成立" 的是比较数值大小, 因为 infinite series sum 的定义就是 limit, 而 set union 并没有 limit. 所以这里不能够直接得证.)\\\\
\end{remark}
\noindent (Continuing the proof:)
\noindent 现在我们再把这个 closed under finite union 推广到 closed under countable union, 以映证 $\cM$ 是一个 $\sigma$-algebra. 注意到 \textbf{STS (suffices to show): $\cM$ closed under countable disjoint union}. 因为任意不 disjoint 的两个集合都可以拆分成三个 disjoint 的集合.\\
\noindent 我们令 $(A_i)$ 为一个 $\cM$ 中的 disjoint sequence, 并定义 $B_n := \union_{i=1}^n A_i$, 我们由上一步的结论知道, $B_n \in \cM$ for all $n$.  
\noindent Define $B := \union_{i=1}^\infty A_i$,  Let $E\sub X$, WTS: $\mu^*(E ) = \mu^*(E \cap B) + \mu^*(E\cap B^c)$.
\\
\noindent 考虑 $\mu^*(E \cap B_n ) = \mu^*(E \cap B_n \cap A_n) + \mu^*(E \cap B_n \cap A_n^c) = \mu^*(E \cap A_n) + \mu^*(E \cap B_{n-1})$, 因为 inductively 可得到:
\begin{equation}
    \mu^*(E \cap B_n) = \sum_{i=1}^n \mu^*(E \cap A_i)
\end{equation}
\noindent 从而：
\begin{equation}
    \mu^*(E) = \mu^*(E \cap B_n) + \mu^*(E\cap B_n^c) \geq \sum_{i=1}^n \mu^*(E\cap A_i) + \mu^*(E \cap B^c)
\end{equation}
\noindent by monotonicity ($\mu^*(E\cap B_n^c) \geq \mu^*(E \cap B^c)$), 这里是一个 infinite sum, 并且 true for every $n$, 因而可以推广到 infinity, 得到 
\begin{equation}
    \mu^*(E) \geq \sum_{i=1}^\infty \mu^*(E\cap A_i) + \mu^*(E \cap B^c) \geq \mu^*(\union_{i=1}^\infty (E \cap A_i)) + \mu^*(E \cap B^c) = \mu^*(E\cap B) + \mu^*(E \cap B^c) \geq \mu^*(E)
\end{equation}
\end{proof}
\noindent\textbf{This finishes the proof of $\cM$ being a $\sigma$-algebra.} 我们同时发现,  $\mu^*|_\cM$ 是一个 \textbf{complete measure} on $\cM$ 是一个 trivial fact after the proof, 因为 taking $B = E$, 可以得到 
\begin{equation}
    \mu^*(B) = \sum_{i=1}^\infty \mu^*(A_i)
\end{equation}
\noindent 并且 by monotonicity, 对于任意的 $\mu^*(A) = 0$, 任取 $E \sub X$, 都有
\begin{equation}
    \mu^*(E )  \leq \mu^*(E \cap A) + \mu^*(E \cap A^c) = \mu^*(E \cap A^c) \leq \mu^*(E)
\end{equation}
因而
\[
\mu^*(E )  = \mu^*(E \cap A) + \mu^*(E \cap A^c)
\]
得到 $A \in \cM$. 从而得证这是一个 complete measure.\\

\begin{remark}
    证明 Carathéodory's Theorem 的 punchline 在于: 我们令 $(A_i) \in \cM$ be a sequence, $B_n$ be its partial union for $n$ terms, 可以得到$$\mu^*(E \cap B_n ) = \mu^*(E \cap B_n \cap A_n) + \mu^*(E \cap B_n \cap A_n^c) = \mu^*(E \cap A_n) + \mu^*(E \cap B_{n-1})$$, 因为 inductively 可得到:
\begin{equation}
    \mu^*(E \cap B_n) = \sum_{i=1}^n \mu^*(E \cap A_i)
\end{equation}
\noindent 这个 statement 对于 $\cM$ 是 $\sigma$-algebra 以及 $\mu^*|_{\cM}$ 是 measure 的证明都很重要. 我们在 outer measure 的定义中, 只声明了 countable subadditivity, 而我们需要证明的是 countable diskjoint additivity, 也就是需要把不等式变成一个等式. 
\\\noindent 为此我们看到 $\mu^*$-measurable 的定义 (Carathéodory condition) 中的等号, 并从中找到这个等式关系: \textbf{通过 disjoint set sequence 上 inductively 对于前一项使用 Carathéodory condition, 得到 disjoint additivity.} (笔者的感觉是 Carathéodory condition 的直观看似不明显, 但是如果把一个 disjoint union 自身作为 $E$, 并把自身的某项作为 $A$, 就非常明显, 表示的是 disjoint measure sum 就是 measure of disjoint union.)
\end{remark}


\chapter{premeasure and Hahn-Kolmogrov extension Theorem}
我们发现: 有些子集簇上的 "length" 很明显, 并且也符合 measure 的定义, 但是这个子集簇却并不构成一个 $\sigma$-algebra. 比如:
\begin{example}
    $\{ \text{all half-open, half-closed intervals}\} \sub \bR$ 上, 以 interval 的 length 作为 measure, 很显然符合 measure function 的定义, 但是 $\{ \text{all half-open, half-closed intervals}\} \sub \bR$ 并不是一个 $\sigma$-algebra, 因为它可以通过 ctbl union 出 open interval, 并不在这个子集簇中. 不过, 这是一个 algebra.\\
\end{example}
因此, 我们想要一个方法来 \textbf{extend a "measure" function on an algebra, to a measure on a $\sigma$-algebra.}

\begin{definition}{premeasure}
给定 $\cP(X)$ 上的一个 \textbf{algebra} $\cA_0$, 我们称 \(\mu_0: \cA_0 \rar [0,+\infty]\)  为一个 premeasure, if
\begin{enumerate}
    \item \(\mu_0(\varnothing)  = 0\)
    \item \(\mu_0\) ctbl disjoint additive in $\cA_0$
\end{enumerate}
\end{definition}

\begin{remark}
premeasure 就是定义在 algebra instead of $\sigma$-algebra 上的 measure. 显然, 通过和 measure 相同的方式可证明, premeasure 在 $\cA_0$ 上是 \textbf{monotone 以及 ctbl subadditive 的.  }  
\end{remark}


\section{induce outer measure out of a premeasure: preserving $\mu_0$ on $\cA_0$}
\begin{proposition}
\label{construct outer measure out of a premeasure}
    Any premeasure can induce an outer measure:
    \begin{equation}
        \mu^*(E) = \inf \{  \sum_{i=1}^\infty \mu_0(A_i) \mid A_i \in \cA_0, E \sub \union_{i=1}^\infty A_i   \}
    \end{equation}
    并且, we have:
    \begin{equation}
        \mu^*|_{\cA_0} = \mu_0
    \end{equation}
    并且 \textbf{every set in $\cA_0$ is $\mu^*$-measurable.}
\end{proposition}
\begin{proof}
    \textbf{这个 outer measure 的 construction directly follows from} \ref{construct outer measure out of a "elementary length function"}.\\
    \noindent \textbf{Proof that $\mu^*$ restricted to $\cA_0$ is $\mu_0$}: 令 $E \in \cA_0$, 假设 $E \sub \union_{i=1}^\infty A_i$, 我们令 $B_n := E \cap (A_n \setminus \union_{i=1}^{n-1} A_i)$, 即把 covering intersecting $E$ 变成 disjoint covering $(B_n)$, 从而由 $\mu_0$ 的 ctbl disjoint additivity 可得, 这一个新 covering 的 measure sum $\sum_{i=1}^\infty \mu_0(B_i) := \mu_0(E)$. 并且由于 $\cA_0$ 是一个 algebra, 这些 $B_n$ 也在 $\cA_0$ 里面, 从而它满足 monotonicty, then $\mu_0(E) = \sum_{i=1}^\infty \mu_0(B_i) \leq \sum_{i=1}^\infty \mu_0(A_i) $\\
    \noindent \textbf{Proof that every set in $\cA_0$ is $\mu^*$-measurable}: Fix $A \in \cA_0$, 我们取任意 $E \sub X$.
    Let $\epsilon > 0$, by def of the outer measure, 存在一个 seq $\{ B_i\}_{i=1}^\infty \sub \cA_0$, 使得 $E \sub \union_{i=1}^\infty B_i$ 并且 $\sum_{i=1}^\infty \mu_0(B_i) \leq \mu^*(E) + \epsilon$. 有 disjoint additivity of $\mu_0$ 可得, $\sum_{i=1}^\infty \mu_0(B_i) = \sum_{i=1}^\infty \mu_0(B_i\cap A) + \sum_{i=1}^\infty \mu_0(B_i\cap A^c)$. 从而 $\mu^*(E) \geq \mu^*(E \cap A) + \mu^*(E\cap A^c)$, 得证. (实际上这是个 trivial argument, 通过$\epsilon$ argument 来严格证明.)
\end{proof}
\begin{remark}
    这一 simple proposition 表明的是, $\mu_0$ induce 出的 outer measure 在 $\cA_0$ 上 \textbf{presearve $\mu_0$ 的 measure 与 measurability.}
\end{remark}






\section{Hahn-Kolmogrov Theorem}
\begin{definition}{$\sigma$-finite measure}
Let $(X,\cM, \mu)$ be a measure space.\\
如果 $\mu(X) < \infty$, 则称 $\mu$ 是 finite 的.\\
如果存在一个 sequence $(E_i)$ in $\cM$ 使得 $\union_{i} E_i = X$ 并且每个 $\mu(E_i) < \infty$, 则称 $\mu$ 是 $\sigma$-finite 的.
\end{definition}
\begin{remark}
一个 finite measure 说明 $\cM$ 中的所有集合的 measure 都 finite.
\end{remark}



\begin{theorem}{Hahn-Kolmogrov Theorem}
\label{Hahn-Kolmogrov Theorem}
给定一个 premeasure $\mu_0$ on algebra $\cM_0$ of $X$, 以及其 induced outer measure $\mu*$, 我们令 
$$
\cM := <\cM_0>
$$
表示 $\sigma$-algebra generated by the algebra $\cM_0$.\\
并令
$$
\mu := \mu^* |_\cM
$$
then we have:
\begin{enumerate}
    \item $(X,\cM_0, \mu_0)$ extends to $(X,\cM,\mu)$\\
    即: $\mu  |_{\cM_0} = \mu_0$
    \item $\mu | _\cM$ 是 \textbf{the largest extension of $\mu_0$ to $\cM$} (即: 对于任意其他的 $\cM$ 上的 measure $\nu$ that extends $\mu_0$ to $\cM$, 都有 $\nu(E) \leq \mu(E)$ for all $E \in \cM$);\\
    并且 \textbf{if $\mu_0$ is $\sigma$-finite}, 则 $\mu$ 是 \textbf{the unique extension} of $\mu_0$ to $\cM$.
\end{enumerate}
\end{theorem}
\begin{proof}
\textbf{Proof of $(X,\cA_0, \mu_0)$ extends to $(X,\cM,\mu)$:}\\
这个 Statement directly follows from \ref{Carathéodory's Theorem}(Carathéodory's Theorem) 以及上一个 proposition \ref{construct outer measure out of a premeasure}. \\
\noindent 1. 我们首先用 $\mu_0$ induce 出 $\mu^*$, 再 restrict $\mu^*$ to $ \cM^* :=\{ \text{all } \mu^* \text{-measurable sets}  \}$, 得到一个 $\sigma$-algebra $\cM^*$.\\
\noindent 注意此时: 由上一个 proposition \ref{construct outer measure out of a premeasure} 可得 $\cM_0$ 中所有集合都是 $\mu^*$-measurable 的, thus $M_0 \sub \cM^*$, 由于 $\cM^*$ 是一个 $\sigma$-algebra, 由 \ref{inclusion properties of generated sigma-algebra} 可得: $\cM := <\cM_0> \sub \cM^*$. \\
\noindent 2. 由 Carathéodory's Theorem 可以得到: $\mu^* | _{\cM^*}$ 是一个 measure, 从而 $\mu :=\mu^* |_{\cM}$ 也是一个 measure(等于把 $\mu^* | _{\cM^*}$ 限制在了一个更小的 sub-$\sigma$-algebra 上).\\
\noindent\textbf{(Note: this is a trivial fact that if $M^*$ is a $\sigma$-algebra and $M \subset M^*$is also a $\sigma$-algebra, then $\mu |_{M}$ is a measure if given that $\mu$ is a $\sigma$-algebra on $M^*$)}\\\\
\noindent \textbf{Proof of $\mu$ being the largest extension of $\mu_0$ to $\cM$:}
\noindent 假设 $\nu$ 是一个 $\cM$ 上的 $\sigma$-algebra s.t. $\nu|_{\cM_0} = \mu_0 $.\\
\noindent Let $E \sub \cM$. (WTS: $\nu(E) \leq \mu(E)$, 即$\nu(E) \leq \mu^*(E)$ .)\\
\noindent 由外测度 \(\mu^*\) 的定义, 对于任意 \(\epsilon>0\), 存在一列集合 \(\{A_i\}_{i=1}^\infty \subset \mathcal{A}_0\) 满足
\[
E\subset \bigcup_{i=1}^\infty A_i \quad \text{且} \quad \sum_{i=1}^\infty \mu_0(A_i) \le \mu^*(E)+\epsilon.
\]
由于 \(\nu\) 在 \(\mathcal{A}_0\) 上和 \(\mu_0\) 一致，即
\[
\nu(A_i) = \mu_0(A_i) \quad \forall i,
\]
因此，
\[
\sum_{i=1}^\infty \nu(A_i) = \sum_{i=1}^\infty \mu_0(A_i) \le \mu^*(E)+\epsilon
\]
利用 \(\nu\) 的 additivity 和 monotoncity 得
\[
\nu(E) \le \nu\Bigl(\bigcup_{i=1}^\infty A_i\Bigr) \le \sum_{i=1}^\infty \nu(A_i) = \sum_{i=1}^\infty \mu_0(A_i) \le \mu^*(E)+\epsilon
\]

由于 \(\epsilon\) arbitrary, 得到
\[
\nu(E) \le \mu^*(E)
\]


\noindent (证明思路: 在 $\cM$ 上 $\mu$ 就等于 $\mu_0$ induce 的外测度, 对于其他的 extended measure, 其作用在一个集合上的测度一定小于等于任意的 $\cM_0$ covering 的 premeasure 和, 而我们可以通过控制这个 covering 的测度和与它的外测度的差距(since inf), 从而使得这个测度小于等它的外测度加一个无限小的 $\epsilon$, 从而得证.) \\\\

\noindent \textbf{Proof of $\mu$ being the unique extension of $\mu_0$ to $\cM$, provided that $\mu_0$ is $\sigma$-finite}:\\
\noindent (recall $\mu_0$ is $\sigma$-finite 即 $\mu_0(X) < \infty$) It remains to show that $\nu(E) \geq \mu^*(E)$.

\noindent Continuing 上一个 proof, we have:
$$
\mu^*(E) \leq \mu^*(\union_{i=1}^\infty A_i) = \nu(\union_{i=1}^\infty A_i) = \nu(E) + \nu(\union_{i=1}^\infty A_i \setminus E)
$$
$$
\leq \nu(E) + \mu^*(\union_{i=1}^\infty A_i \setminus E)
$$
我们只要 controling $\mu^*(\union_{i=1}^\infty A_i \setminus E) = \mu^*(\union_{i=1}^\infty A_i ) - \mu^*(E) = \epsilon $ 逼近 0, 即可得到反向的不等式关系.\\
\noindent (证明思路: 我们证明了 $\nu(E) \leq \mu^*(E)$ 之后, 注意到 covering set 和 $E$ 之间的差集的 $\nu$-measure 自然也小于等于这个差集的 $\mu^*$-measure, which can approximate 0.)
\\\\

\end{proof}


\begin{remark}
\noindent 1. 我们首先容易定义 $X$ 上的一个 algebra $\cM_0$ 和一个 algebra 上的 premeasure $\mu_0$; \\\\
    \noindent 2. 然后用 inf of covering sum 来 induce 出一个 $\cP(X)$ 上的 outer measure $\mu^*$, 而后我们限制 $\mu^*$ 到 $\mu^*|_{\cM^*}$ (where $\cM^*$ 表示所有的 $\mu^*$-measurable sets), by Carathéodory's theorem 这就 induce 出了一个 complete measure. \\\\
    \noindent 3. 我们可以再取 $\cM^*$ 的一个 sub $\sigma$-algebra $\cM := <\cM_0>$, 限制在这个集合上的 $\mu^*|_{\cM}$ 自然也是一个 measure, 并且是 $\cM_0$ extend 到 $\cM$ 上的 lartest measure. By Hahn-Kolmogrov Thm, 这个 measure 如果是 $\sigma$-finite 的则是 $\cM_0$ extend 到 $\cM$ 上的 unique measure.\\
    \noindent (Notice: \textbf{自然地, $(X, \cM^*, \mu^* |_{\cM^*})$ 是 $(X, \cM, \mu^*|_{\cM})$ 的一个 completion.})
    
\end{remark}








\chapter{distribution function and Borel measures on $\bR$}
This lecture: 
1. distribution function 是 increasing 且 right continuous 的, 
2. 任意 increasing 且 right continuous 的函数可以作为 distribution function, 用它来构造它对应的 measure.


\section{distribution function of a locally finite Borel measure}
\begin{definition}{distribution function of $\mu$}
给定一个 \textbf{locally finite (finite on all compact sets)} 的 \textbf{Borel measure} on $\bR$ (即 $(\bR, \cB(bR), \mu)$), 我们定义:
$$
F_\mu(x ) := \begin{cases}
    \mu((0,x]) \quad  , x \geq 0 \\
     -\mu((x,0]) \; , x < 0
\end{cases}
$$
这个函数被称为 $\mu$ 的 \textbf{distribution function.}
\end{definition}

\begin{remark}
\begin{proposition}
        容易发现: $F$ 是 $\mu$ 的 distribution function, 当且仅当 $\mu((a,b]) = F(b) - F(a)$, 任取这样的 interval.
\end{proposition}
这两个定义是等价的. 
\end{remark}

\begin{theorem}{distribution function is increasing and right ctn}
对于 $\bR$ 上的任意 locally finite Borel measure $\mu$, 其 distribution function $F_\mu$ 都是 increasing 且 right continuous 的.
(right ctn:$$F_\mu(a) = \lim_{x\rar a^+} f(x)$$
\end{theorem}
\begin{proof}
    increasing: trivially by monotonicity of measure.\\
    right continuous: follows from measure 的 ctnity. 正轴上: $\mu((0,x+ 1/n])$ 的 sequence 极限为 $\mu(0,x])$, by ctn from above; 负轴上, $\mu((x+ 1/n,0])$ 的 sequence 极限为 $\mu((x,0])$, by ctn from below.\\
\end{proof}
\begin{remark}
   \textbf{ Note: distribution function 是 right ctn 的, 但却未必是 left ctn 的.}
   因为我们构造离散的 measure, 使得这个 distribution function 具有间断点. 这样导致了左不连续.
   反例: 例如 atomic measure. 
\end{remark}





\section{any increasing and right ctn function is a unique distribution function}

\begin{definition}{h-interval}
    我么定义形如 $(a,b]$, $(-\infty, b]$ 的 $\bR$  的子集, 以及 $\varnothing$, $\bR$, 为 h-intervals.
\end{definition}
h-intervals 即\textbf{所有的左开右闭区间.}
\pic[0.2]{ch1-pics.assets/1.png}


\begin{lemma}{h-intervals form an algebra and generate borel set}
    $$
    \cA_0 := \{  \text{finite (disjoint) unions of h-intervals}\}
    $$
是一个 algebra, 并且
$$
<\cA_0> = \cB(\bR)
$$
\end{lemma}
\begin{proof}
    trivial. follows from lec 2 的 generating set of borel set on $\bR$.
\end{proof}




\begin{theorem}{\textbf{任意 increasing 且 right ctn 函数都是某个 locally finite Borel measure 的 distribution 函数}}
取 lemma 中的 $\cA_0$.
对于\textbf{任意的 increasing 且 right ctn 的 $F: \bR \cup \{\pm\infty\} \rar \bR\{\pm\infty\}$,} 我们 define $\mu_0: \cA_0 \rar [0,\infty]$, by:
$$
\mu_0(\union_{i=1}^n (a_i, b_i]) = \sum_{i=1}^n (F(b_i) - F(a_i))
$$ 并规定 $\mu_0(0) = 0$, 以及 $F(\infty) = \lim_{x\rar \infty } F(x)$\\,
\textbf{Claim 1: $\mu_0$ 是一个 $\cA_0$ 上的 $\sigma$-finite premeasure.}\\
\textbf{Claim 2: (by Hahn-Kolmogrov) $\mu_0$ extend to a locally finite Borel measure $\mu_F$}, 并且 $\mu_F ((a,b]) = F(b) - F(a)$ for any h-interval, i.e. $F$ 是 $\mu_F$ 的 distribution function.\\
Claim 3: \textbf{$F$ 是 $\mu_F$ 的唯一 distribution function up to constant term}, in the sense that 任意其他的 such function $G$ 如果也是$\mu_F$ 的 distribition function, 则必然有 $F-G$ 为 const. 
\end{theorem}

\begin{proof}
Claim1 
\begin{enumerate}
    \item well-definedness of $\mu_0$: 对于两个结果一样的 union, finding common refinement 即可.
    \item $\mu_0(\varnothing) = 0$: 因为 $\varnothing$ 就是 $(a,a]$.
    \item finite additivity: trivial.
    \item $\sigma$-finiteness: each $\mu_0((n, n+1]) < \infty$
    \item \textbf{ctbl additivity: nontrivial, 下面详细展开.}
\end{enumerate}
Suppose $A_1, A_2, \cdots$ 是 seq of disjoint h-intervals in $\cA_0$. Let $A := \bigsqcup_{i}A_i $.\\
WTS: $\mu_0(A) = \sum_i \mu_0(A_i)$.\\
(1) WTS $\mu_0(A) \geq \sum_i \mu_0(A_i)$
这个 direction easy. We define $B_n  := \bigsqcup_1^n A_i$, 由 finite additivity 得到: $\mu_0(B_n) = \sum_{i}^n \mu_0(A_i)$, 从而 
$$
\mu_0(A) = \mu_0(B_n) + \mu_0(A \setminus B_n) \geq \mu_0(B_n)
$$ for each $n$, 由于这是一个 numerical seq, 可以 conclude $\mu_0(A) \geq \sum_i \mu_0(A_i)$.
(2) WTS $\sum_i \mu_0(A_i) \geq \mu_0(A)$.\\
这个 direction 较难, 需要用到 $\epsilon / 2^n$ 的 argument.\\
For simplicity, 我们只需要考虑 $A_i = (a_i, b_i]$ 的 interval 形式, 其他形式 can trivially prove. 并且, 由于 $\cA_0$ 中任何一个元素至多只有 finite 个离散的 h-intervals, 我们 \textbf{suffice to assume $A$ 是一个 h-interval.} \\
从而, 我们也可以 denote $A = (a,b]$.\\
Let $\epsilon > 0$.\\
By $F$ 的 increasing 和 right ctn, 存在 $\delta, \delta_i$ s.t.
$$
F(a+ \delta)- F(a) \leq \epsilon
$$
同样地, 对于每个 $A_i$. 我们都可以找到 $\delta_i$ 使得 
$$
    F(b_i + \delta_i) - F(b_i) \leq \frac{\epsilon}{2^i}
$$
于是 $(a_i, b_i+\delta_i)_{i \in \bN}$ 就形成了一个 open covering for $[a+ \delta, b]$. By cptness, 存在一个 finite subcovering $(a_i, b_i+\delta_i)_{1 \leq i \leq N}$.\\
By relabelling, \textbf{我们 suppose $A_i$ 是从左到右排序的. 于是每个 $b_i + \delta_i$ 都处于下一个 $A_{i+1}$ 之内.}
\pic[0.2]{ch1-pics.assets/image-20250130183842172.png}
从而:
\begin{align}
    \mu_0(A) & \leq F(b) - F(a+ \delta) - \epsilon \\
    &\leq F(b_N + \delta_N) - F(a_1) + \epsilon \\
    & =  F(b_N + \delta_N) - F(a_N) +\sum_1^{N-1} (F(a_{i+1}  ) - F(a_i)) + \epsilon \\
    & \leq  F(b_N + \delta_N) - F(a_N) +\sum_1^{N-1} (F(b_i + \delta_i  ) - F(a_i)) + \epsilon \\ & < \sum_1^N (F(b_i) - A(a_i) + \frac{\epsilon}{2^i}) + \epsilon
    \\ & < \sum_ 1^\infty \mu_0(A_i) + 2\epsilon
\end{align}
Claim 2, 3 都 directly follows from Hahn-Komogrov Thm.
\end{proof}
\begin{remark}
    这一证明实则简单. 关键的步骤是 1. 简化问题为 union 成一个 h-interval; 2. 通过 cptness 取 finite covering；3. 对每个 $A_i $ 取一个 $\epsilon / 2^i$ 的小 cover, 最后可以被 $\epsilon$ bound.
\end{remark}



\begin{example}
我们已经证明, 从任意的 increasing 且 right ctn 的函数都可以构造出一个以其为 distribution function 的 locally finite Borel measure on $\bR$, 因而我们简称这样的函数都叫做 distribution function.\\
以下为两个 distribution function 的例子:\\
1.  Heaviside function $$H(x)  = \begin{cases}
    1 \;\; ,x\geq 0\\
    0 \;\; ,x < 0
\end{cases}    $$
2. 我们将 $\bQ$ 以某种形式列出: $\bQ = \{q_1, q_2, \cdots\}$
而后定义:
$$
F(x) := \sum_{i = 1} ^\infty 2^{-n} H(x - r_n)   \in (0,1)
$$
这个函数通过有理数的次序给每个有理数赋了一个"weight", 并对于每个$x$, 把所有有理数分为 $> x$ 和 $\leq x$ 的两部分, 只把 $\leq x$ 的那部分有理数的权重算进 $F(x)$. 于是 $x$ 越大, 被算进 $F(x)$ 的有理数越多, $F(x)$ 就越大. (虽然每个有理数的权重是乱的). 这个函数在每一点上都 discrete.\\
这个过程可推广, 不取 $\bQ$ 而取任意的 countable sets in $\bR$ 作为参照.
\end{example}





本 lec 总结: 通过直接定义 distribution function 来得到的 measure, 实则就是不同于直接取 interval 长度, 我们隐性地给每个点一个 mass (类似概率密度), 从而把区间的长度中每一个点加上一个权重. 最后形成一个不一定均匀的 measure. 这个 distribution 的分布曲线决定了这个 measure.






\chapter{Lebesgue-Stieltjes measure}
给定一个 increasing 且 right ctn 的函数 $F$, 我们已经展示了用它作为 distribution function 来 induce 出一个 Borel measure $\mu_F$ on $\cB(\bR)$. \\
在构造这个函数时, 我们使用的是用 premeasure $\cA_0$ (of all finite unions of h-intervals), 使用 Hahn-Kolmogrov 来 induce outer measure $\mu_F^*$, 再把 restrict 它到 $<\cA_0>$, 即 $\cB(\bR)$ 上, 获得的 measure. \textbf{这一个 measure 是一个 Borel measure, 但是它并不 complete. }\\
recall in lec 6: 我们其实可以 complete 这个 measure, 只需要在第二步, 用 premeasure $\cA_0$ induce 出 outer measure 后, 不要 restrict 它到 $\cB(\bR)$ 上, 而是 restrict 到取 $\cM_\mu := \{ \text{all } \mu_F^* \text{-measurable set\}}$ 上, 得到的就是 completion of $\mu_F$, 即 $$(\bR, \cM_\mu, \overline{\mu_F})$$
其中, $\cA^*$ 是 $<\cA_0>$ 即 $\cB(\bR)$ 的 proper super set. \textbf{我们把这个 completed measure 叫做 Lebesgue Stieltjes measure associated with $F$, 并用 $\mu_F$ 来指代它. (刚才, 我们把未完备的 measure 叫做 $\mu_F$, 但现在我们不再使用这个 measure, 而是使用它的 completion, 并转而称它的 completion ($\overline{\mu_F}$) 为 $\mu_F$.)}



\begin{definition}{Lebesgue-Stieltjes measure associated with $F$}
给定一个 distribution function $F$, 我们使用它来定义 h-intervals 的 premeasure $\mu_0$, 并把这个 premeasure induce 出的 outer measure $\mu^*$ 限制在 $$\cM_\mu := \{ \text{all } \mu^* \text{-measurable set\}}$$ 上, 由 Carathéodory Thm 得它是 complete 的. 称这个 complete 的 measure $$\mu_F := \mu^* |_{\cM_\mu}$$ 为 \textbf{Lebesgue Stieltjes measure associated with $F$. }
\end{definition}
\begin{remark}
根据定义, 对于任意 $E \in \cM_\mu$, 它的 measure 为:$$
\mu_F(E) = \inf \{ \sum_1^\infty (F(b_i) - F(a_i))   \mid E \sub \union_1^\infty (a_i, b_i]      \}
$$
\end{remark}

\section{inner and outer regularity of LS measure}

虽然我们使用 h-intervals 来 induce 了这个 measure, 但是实际上我们在表示 measure 时,可以用 open intervals 来代替 h-intervals:
\begin{lemma}{open intervals can substitute for h-intervals when computing measure}
固定一个 Lebesgue-Stieltjes measure associated with $F$, 任意 $E \in \cM_\mu$, 它的 measure 等于:$$
\mu_F(E) = \inf \{ \sum_1^\infty (F(b_i) - F(a_i))   \mid E \sub \union_1^\infty (a_i, b_i)      \}
$$
\end{lemma}
\begin{proof}
    每个 open interval 都等于 a ctbl disjoint union of h-intervals, 从而是在这个被取 inf 集合内的; 所以只需要证明能取到这个 inf 即可.
    Fix $\epsilon > 0$, 我们根据定义可以取到一个 seq $(a_i, b_i]$ 使得它 measure sum $\leq \mu(E) + \epsilon /2$, 而我们对于每个 $i$, 在 interval 的右边再取一个 $ <\epsilon/2^{i+1}$ 的 $\delta_i$, 就变成了一个 open interval, 并且最后距离这个 h-interval seq 的 measure sum 差距至多 $\epsilon/2$. 从而得证.
\end{proof}


\begin{theorem}{\textbf{outer regularity}}
\label{outer regularity}
对于一个 Lebesgue-Stieltjes measure associated with $F$, 任意 $E \in \cM_\mu$, 它的 measure 等于:
\begin{equation}
    \mu_F(E) = \inf \{ \mu_F(U) \mid  U \text{ open , and } E \sub U  \}
\end{equation}
\end{theorem}


\begin{proof}
    Directly follows from lemma. 首先, by monotonicity, 一个包含 $E$ 的开集 $U$ 的 $\mu_F$ 一定比 $E$ 的大. 并且, 对于任意的 $\epsilon > 0$, 都可以找到一个 open covering 使得 measure sum $< \mu_F(E) + \epsilon$, by def.\\
\end{proof}

\begin{theorem}{\textbf{inner regularity}}
\label{inner regularity}
对于一个 Lebesgue-Stieltjes measure associated with $F$, 任意 $E \in \cM_\mu$, 它的 measure 等于:
\begin{equation}
    \mu_F(E) = \sup \{ \mu_F(K) \mid  K \text{ compact , and } K \sub E  \}
\end{equation}
\end{theorem}
\begin{proof}
    首先证明 $E$ bounded 的 case. 假设 $E$ bdd. \\
    如果 $E$ closed, 则 $E$ cpt, trivially true. \\
    如果 $E$ open, 那么 $E$ 的 bounadry 是 closed (cpt) 的, 从而 $\partial E \in \cM_\mu$ 
    我们 let $\epsilon >0$. 我们对 $\partial E$ 使用 outer regularity, 可以取一个 open set $U$ covering $\partial E$, 并且使得 $\mu_F(U) \leq \mu_F(E) + \epsilon$\\
    此时取 $K := E \setminus U$, 我们发现这是一个 approximating $E$ 的 compact set, 并且有:
    $$
    E = K \sqcup (U \cap E)
    $$
从而:
\pic[0.4]{ch1-pics.assets/image-20250131003019214.png}
而对于 unbounded 的 case, 直接由 
$$
E  = \bigsqcup_j (E \cap (j,j+1])
$$得到.
\end{proof}
\begin{remark}
outer / inner regularity 表示, $\bR$ 上一个 (LS-measurable set 的) LS measure 就等于它内部用 cpt set 逼近它的 measure limit; 以及等于它外部用 open set 逼近它的 measure limit.\\
这个性质也可以推广到 $\bR^n$ 上.
\end{remark}




\section{Lebesgue-Stieltjes measurable 的等价条件}
\begin{definition}{$G_\delta, F_\sigma$ sets}
Topological space 中, 一个 \textbf{coutable intersection of open sets 被称为一个 $G_\delta$ set}, 一个 \textbf{countable union of closed sets 被称为一个 $F_\sigma$ set}.
\end{definition}
\begin{remark}
    topological space 中, finite intersection of open sets 还是 open set, 但是 countable intersection 则未必; finite union of closed sets 还是 closed set, 但是 countable union 则未必.\\
$G_\delta$ sets 包括了所有的 open sets, 以及一部分扩充; $F_\sigma$ sets 包括了所有的 closed sets, 以及一部分扩充.
\end{remark}



\begin{theorem}{Lebesgue-Stieltjes measurable 的等价条件}
\label{Lebesgue-Stieltjes measurable 的等价条件}
TFAE:
\begin{enumerate}
    \item[i] $$E \in \cM_\mu$$
    \item[ii] 存在一个 $G_\delta$ set $V$ 以及一个 measure zero set $N_1$ ($\mu_F(N_1) = 0$) 使得   $$E = V \setminus N_1$$
    \item[iii] 存在一个 $F_\sigma$ set $H$ 以及一个 measure zero set $N_2$ ($\mu_F(N_2) = 0$) 使得 $$E = H \cup N_2$$
    \item[iv] 存在一个 open set $U$ 使得对于任意的 $\epsilon > 0$, 都有 $$\mu^*(U \setminus E) < \epsilon $$
\end{enumerate}
\end{theorem}

\begin{proof}
由 (ii) 和 (iii) 推得 (i) 是 trivial 的. 这是因为 LS measure 是 complete measure, 任意 null set 都是 measurable 的.
由 (i) 推 (ii) 和 (iii): follows from outer 与 inner regularity. 假设 $E$ 是 LS-measurable 的, 我们直接取一个 inner seq of cpt subsets 以及一个 outer seq of open super sets, 使得
\begin{equation}
    \mu_F(U_j) -  \frac{1}{2^i} \leq \mu_F(E) \leq \mu_F(K_j ) + \frac{1}{2^i}
\end{equation}
于是就得到: $V := \intsec_i U_i$, $H := \union_i K_i$, 与 $E$ 的差集都是一个 null set. 并且它们分别为 $G_\delta$ 和 $F_\sigma$ sets.
\end{proof}
\begin{remark}
    $\sigma$-algebra 和 topology 各自只 closed under finite 的交和并, 而 $<\cB(\bR)>$ 则 closed under ctbl 交和并, 从而所有的  $G_\delta$ 和 $F_\sigma$ sets 都在其中. $\cM_\mu$ 是一个比 $<\cB(\bR)>$ 更大的集合, 但是其实它其中的元素都可以用 $G_\delta$ 和 $F_\sigma$ sets, 即 $<\cB(\bR)>$ 中的集合来逼近. 这是合理的, 因为 completion 就是把一些 subnull sets 加入到了 $\sigma$-algebra 里.
\end{remark}





\section{Lebesgue measure and its invariance properties}
\begin{definition}{Lebesgue measure}
Lebesgue measure 即 Lebesgue-Stieltjes measure associated with $F(x) = x$.
我们用 $m:=\mu_F$ 来表示它, 并用 $\fL := \cM_m$ 来表示所有的 Lebesgue measurable sets.\\
从而 $\bR$ 上的 Lebesgue measure space 表示为:
$$
(\bR, \fL, m)
$$
\end{definition}
\begin{remark}
    Lebesgue measure 是最 normal 的 Lebesgue-Stieltjes measure, 它 preserve intervals 的长度作为其 measure: 
    $$
    m((a,b]) = b -a
    $$
\end{remark}


\begin{theorem}{$\fL$ preserves translation and scaling}
    if $E \in \fL$ $\Longrightarrow$ $E+s, rE \in \fL$ $\forall s,r \in \bR$.\\
    并且, $m(E+s) = m(E), m(rE) = |r| m(E)$
\end{theorem}
\begin{proof}
首先, 如果 $E \in \cB(\bR)$, 那么 by hw 1, 我们证明了 $\cB(\bR)$ 是 closed under translation 和 scaling 的, 因而 $rE, E+s \in \cB(\bR)$.\\
我们 define on $\cA_0:=$ $\{\text{finite union of h-intervals}\}$:
$$
m_s(E) := m(E+s)
$$
$$
m^r(E) := m(rE)
$$
显然, 这两个函数 agree with $m, |r|m$. \textbf{由于 $m$ 是 $\sigma$-finite 的, 从而 by Hahn-Kolmogrov, 它 uniquely extend to $\cB(\bR)$}. 因而, $m_s$ 在 $\cB(\bR)$ 上和 $m$ 相等, $m^r$ 在 $\cB(\bR)$ 上和 $|r|m$ 相等. 并且, 我们知道\textbf{ $(\bR, \fL, m)$ 是 completion of $(\bR, \cB(\bR),m)$}, 因而 $m_s$ 也同样 complete to $m$ on $\fL$. (同理, $m^r$ 也同样 complete to $|r|m$ on $\fL$)
\end{proof}
\begin{remark}
    我们只要证明两个 measure function 在 premeasure 上相等或称倍数关系, 就能证明它们在 induced (complete) measure 上相等.\\
此外, 有另一种证明方式. After we know $m_s$ 在 $\cB(\bR)$ 上和 $m$ 相等, $m^r$ 在 $\cB(\bR)$ 上和 $|r|m$ 相等, 我们由 \ref{Lebesgue-Stieltjes measurable 的等价条件} Lebesgue-Stieltjes measurable 的等价条件 可知: $\fL$ 上的集合一定是一个 Borel set 并上一个 null set, 由于 null set 的 measure 在经过 translation 和 scaling 后仍然是 0, 同样得证.
 \end{remark}









\chapter{measurable function}
\section{general measurable function}
\begin{definition}{$(\cM, \cN)$-measurable function}
Let $(X,\cM)$, $(Y,\cN)$ be measurable spaces, 如果 $f: X \rar Y$ 满足: $$B \in \cN \implies f^{-1}(B) \in \cM$$, 则称 $f$ 为一个 $(\cM, \cN)$-measurable function.
\end{definition}
从一个 measurable space 到另一个 measurable space 的 function 被称为 measurable 的条件是: 被映射到可测集的集合只能是可测集.

这个定义和 topological space 上 continuous 的定义: 被映射到开集的只能是开集, 形式是完全一样的. 并且我们知道, topological space 和 measure space 也有很多相似之处. 因而连续性和可测性有一定的关系.

函数的可测性的定义是 with respect to 它们所在可测空间选定的 $\sigma$-algebra 的, 就像 topologica spaces 之间函数的连续性的定义是 with respect to 它们所在的 topological spaces 选定的 topology.

这两个定义都表示的是: 性质不好的集合不会被映射到性质良好的集合. (但是性质良好的集合有可能被映射到性质不好的集合.)


\begin{proposition}{composition preserves measurability}
    如果 $f$ 是 $(\mathcal{A},\mathcal{B})$-measurable 的, $g$ 是 $(\mathcal{B}, \mathcal{C})$-measurable 的, 那么 $g \circ f$ 是 $(\mathcal{A}, \mathcal{C})$-measurable 的.
\end{proposition}
\begin{proof}
    Trivial.
\end{proof}

\begin{lemma}
    Let $(X,\cM)$, $(Y,\cN)$ be measurable spaces, 如果 $\cN = <\varepsilon>$ for some $\varepsilon \sub Y$, 那么 
\begin{center}
    $f: X \rar Y$  $(\cM,\cN)$-measurable  $\Longleftrightarrow$ $f^{-1}(E) \in \cM  \quad \forall E \sub \varepsilon$
\end{center}

\end{lemma}
\begin{proof}
foward direction: trivial.\\
backward direction: Let
$$
D: = \{ E \sub Y \mid f^{-1}(E) \in \cM\}
$$
容易证明: $D \supseteq \varepsilon$, 并且 $D$ 是一个 $\sigma$-algebra.\\
因而 $D \supseteq <\varepsilon> = \cN$
\end{proof}
\begin{remark}
    如果我们知道 $\cN$ 是由某个子集生成出来的, 那么对于映射到这个 measurable space 的函数, 只要保证这个子集中的每个集合的 preimage 都是可测集就可以了, 可以 reduce 判断 $f$ measurable 的条件.

    同样类比 topological space, 如果 $Y$ 的 topology 存在一个 basis, 那么判断 $f: X\rar Y$ 连续, 只需要判断这个 basis 的 preimage 都是 open 的就好了.
\end{remark}

\begin{proposition}
对于 topological space $X,Y$, let $f:X\rar Y$
\begin{center}
    $f$ continuous $\implies$$f$ 是 $(\cB(X),\cB(Y))$ measurable 的.
\end{center}
\end{proposition}
\begin{remark}
    topological spaces 之间, 连续函数一定是在它们的 Borel algebra 之间 measurable 的.
\end{remark}




\section{real and complex-valued measurable function}
\begin{definition}{(real-valued) measurable functions}
Let $(X,\mathcal{A})$ be a measurable space, 
对于 $f: X \rightarrow \overline{\mathbb{R}}$ 如果它是 $(\mathcal{A}, \mathcal{B}(\overline{\mathbb{R}}))$-measurable 的, 我们直接简称它是 $\mathcal{A}$-measurable 的, 或者简称为 measurable 的.

\end{definition}
\begin{remark}
    实际上, 使用无穷作为值, 就是把\textbf{原本不在定义域上的无穷跳跃点放到了定义域上}, 些情况下, 仅仅是一种方便的记号，但它们通常不会被视为真正的值.
    
    但是等价地, 我们为了便利一般都会使用 extended real number system 来进行分析, 把这些无穷间断当作无穷的值来进行分析. 
    
    这样做法的合理性是, 对于\textbf{零测集大小多个这样的无穷间断点}, 在 Lebesgue 积分体系下这一行为\textbf{并不会影响函数的 integrability 以及 integral 的值}, 因而我们可以这么做. 这一点之后并不会造成困扰, 因为我们在之后定义可积空间时, 会避开有超过零测集大小多个无穷间断点的函数, 以及无法定义的行为.

    我们容易验证:
    $$
    \mathcal{B}(  \overline{\mathbb{R}}) = \{  E \subseteq \overline{\mathbb{R}}  \mid  E\cap \mathbb{R} \in \mathcal{B}(\mathbb{R})   \}
    $$
    
    以及, $   \mathcal{B}(  \overline{\mathbb{R}}) $ 的 generating set 可以是所有的 $(a, \infty]$ 集合或者 $[-\infty, a)$ 集合\textbf{.} 所以\textbf{一个 map to $\overline{\mathbb{R}}$ 的函数是可测的, 当且仅当任意 $ (a, \infty]$ 的 preimage 都可测}.\\
    \end{remark}


\begin{definition}{(complex-valued) measurable functions}
    如果 $f: X \rightarrow \mathbb{C}$ 满足: $\re f, \im f$ 都是 (real-valued) $X$-measurable 的, 那么也称 $f$ 是 $X$-measurable 的, 或者直接说是 measurable 的.
\end{definition}
\begin{remark}
    任意 complex function $f$ 都可以写为
$$
    f = \re f + i \im f
    $$
    这个定义其实等价于 $f$ 是 $(\mathcal{M}, \mathcal{B}(\mathbb{C}))$-measurable 的, 因为这个 statment 等价于 $\re f$, $\im f$ 都是 (real-valued) $X$-measuable 的, 这是因为 $$\borel(\mathbb{C}) \equiv \borel(\mathbb{R}^2) = \borel(\mathbb{R}) \otimes \borel(\mathbb{R})$$
\end{remark}




\begin{definition}{Lebesgue measurable functions, Borel measurable functions}
Naturally, 如果 $f: \mathbb{R} \rightarrow \mathbb{C}$ 是一个 $\mathfrak{L}$-measurable 的函数, 那么我们称 $f$ 是 \textbf{Lebesgue measurable} 的.

同样地, 如果它是一个 $\mathcal{B}(\mathbb{R})$-measurable 的函数, 称 $f$ 是 \textbf{Borel measurable} 的. 
\end{definition}


\begin{proposition}
    在任何 $\mathcal{M}$-measurable function $f$ 前 compose 一个 Borel measurable 的 function, 结果仍然是 $\mathcal{M}$-measurable 的, follows from composition preserves measurability.
\end{proposition}
\begin{proof}
    Follows from def.
\end{proof}
\begin{example}
    $f^2$, $-3f$, $\frac{1}{|f|}$ ($f\not= 0$) 都仍然是 $\mathcal{M}$-measuble 的.
\end{example}



\section{arithmetic and sequential preservation of measurable functions}
\begin{proposition}{addition and multiplication 保留 measuability}
    如果 $f,g$ 是 $\mathcal{M}$-measurable function, 那么 $f+g, fg$ 也是.
\end{proposition}
\begin{proof}
Suffices to assume $f,g$ is (extended) real-valued. Complex case follows trivially.

Suppose $f,g$ 是 $\mathcal{M}$-measurable 的, 我们想要证明: $f+g$ 是 $\mathcal{M}$-measurable 的, suffices to show: $(f+g)^{-1}(a,\infty] \in \mathcal{M}$ for any $a\in \mathbb{R}$.

我们 notice:
\begin{equation}
    \{x\in X \mid f(x) + g(x) > a  \} = \bigcup_{r \in \mathbb{Q}} \{  x \mid f(x) > r \} \cap \{  x \mid g(x) > a-r \}
\end{equation}
于是 finishes the proof.

对于 $fg$, 我们发现有 
$$
fg = \frac{1}{2}((f+g)^2 - f^2 - g^2)
$$
于是也 finishes the proof, following 前一个 proposition.
\end{proof}

\begin{lemma}{sequential behavior of real-valued measurable function}
如果 $\{ f_n :X\rightarrow   \overline{\mathbb{R}}\}_{n\in\mathbb{N}}$ 是一个 seq of $\mathcal{M}$-measurable functions, 那么
\begin{itemize}
    \item $$g_1(x) : = \sup_j f_j(x)$$
    \item $$g_2(x) : = \inf_j f_j(x)$$
    \item $$g_3(x) : = \limsup_{j \rightarrow \infty} f_j(x)$$
    \item $$g_4(x) : = \liminf_{j \rightarrow \infty} f_j(x)$$
\end{itemize}
都是 $\mathcal{M}$-measurable 的.
\end{lemma}
\begin{proof}
 \[
g_1(x) = \sup_{j \in \mathbb{N}} f_j(x).
\]
由上确界的定义：
\[
g_1(x) > a \iff \exists j \in \mathbb{N}, \text{ such that } f_j(x) > a.
\]
因此，
\[
\{ x \mid g_1(x) > a \} = \bigcup_{j \in \mathbb{N}} \{ x \mid f_j(x) > a \}.
\]
因而:
$$
g_1 ^{-1}((a,\infty]) = \union_1^\infty f_j ^{-1} ((a,\infty])
$$

由于 \( f_j \) 可测，集合 \( \{ x \mid f_j(x) > a \} \) 是 \(\mathcal{M}\)-measurable ，而可测集合的可数并仍然是可测的，因此 \( g_1 \) 可测。

inf: dually.

limsup: 等于 inf of sup ($k\geq n$)

liminf: 等于 sup of inf  ($k\geq n$)
\end{proof}
\begin{remark}
    从这个 proof 里笔者发现了这个惊人的事情。居然有
  $$
(sup_{j} f_j) ^{-1}((a,\infty]) = \union_1^\infty f_j ^{-1} ((a,\infty])
$$
但是仔细想想也是合理的. 因为 function seq 的 sup 函数能够 map 到的值大的元素肯定比其中任何一个 function $f_n$ 更多. 并且其中存在一个 limit 关系.

以及得出了一个很重要的结论: \textbf{可测函数的 seq 的各种极限仍然是可测函数.}
\end{remark}


\begin{corollary}
    如果 $\{ f_n :X\rightarrow   \overline{\mathbb{R}}\}_{n\in\mathbb{N}}$ 是一个 seq of $\mathcal{M}$-measurable functions, 且在任意 $x$ 处极限都存在, 那么
$$
f(x) := \lim_{j\rightarrow \infty} f_j(x)
$$
是 $\mathcal{M}$-measurable 的.
\end{corollary}
\begin{proof}
    directly follows from lemma. 因为 $x$ 处极限如果存在, 那么 $\sup_f f_j (x)  = \inf_j f_j(x) $
\end{proof}





\begin{corollary}
    $f,g$ $\mathcal{M}$-measurable $\implies$ $\max(f,g), \min(f,g)$$\mathcal{M}$- measurable 
\end{corollary}
\begin{proof}
    two element sequence, 剩余的用空集, 于是 follows form above.
\end{proof}



\begin{remark}
    于是我们知道, 当我们把 $f$ 拆分成 $f^+ := \max(f,0)$, $f^- := \max(-f,0)$, 我们有 

    \begin{center}
 \textbf{ $f$ $\mathcal{M}$-measurable $\implies$ $f^+, f^-$ $\mathcal{M}$-measurable}
    \end{center}

并且由于 $f = f^+ - f^-$, 反向也成立. 并且 $|f| = f^+ + f^-$, 因而有:
\begin{center}
     \textbf{ $f$ $\mathcal{M}$-measurable $\Longleftrightarrow$ $f^+, f^-$ $\mathcal{M}$-measurable} \textbf{$\Longleftrightarrow$ $|f|$ $\mathcal{M}$-measurable}
\end{center}
\end{remark}








\chapter{simple function and integration of nonnegative functions}

\section{indicator and simple function}
\begin{definition}{characteristic (indicator) function}
    Given $E \subseteq X$, 我们定义:
    $$
    \chi_E(x) := \begin{cases}
        1 \quad,x\in E\\
        0 \quad, x\not \in E
    \end{cases}
    $$
\end{definition}

\begin{lemma}
如果 $(X,\mathcal{M})$ 是一个 measurable space, 那么一个 indicator function
\begin{center}
   \textbf{ $\chi_E$ on $X$ 是 measurable 的 $\Longleftrightarrow$ $E \in  \mathcal{M}$}
\end{center}
\end{lemma}
indicator function measurable 当且仅当它 indicate 的集合是 measurable 的.







\begin{definition}{simple function}
    一个 simple function on measurable space $(X,\mathcal{A})$ 是一个 $\mathcal{A}$-measurable function $\phi:X \rightarrow \mathbb{C}$, taking only finitely many values.

即: $\phi(X) = \{c_1,\cdots, c_k\}$
\end{definition}

\begin{proposition}{使用 \textbf{a sum of indicator functions of measurable sets} 来定义 simple function}
对于 simple function $\phi:X \rightarrow \mathbb{C}$ s.t. $\phi(X) =\{ c_1,\cdots,c_n\} $, 我们也可以定义它为:  $$
    \phi(x) = \sum_{j=1}^n c_j \chi_{E_j}
    $$
其中, $E_j  =  \phi^{-1}(\{c_j\})$.
我们称之为: the \textbf{standard representation of simple $\phi$.}
\end{proposition}
这是因为, 单点集在 $\borel(\mathbb{C})$ 上是 measurable 的, \textbf{由于 $\phi$ measurable, 我们得到 $E_j \in \mathcal{M}$.}
\begin{remark}
    对于 simple function $$
    \phi(x) = \sum_{j=1}^n c_j \chi_{E_j}
    $$ 一定有 $$
    \bigsqcup_{j=1}^n E_j = X
    $$其中通常有一个 $E_j$ 上 $\phi$ 的值是 0.
\end{remark}



\begin{lemma}
    如果 $\phi, \psi: X \rightarrow \mathbb{C}$ 是 simple functions, 那么 
    \begin{itemize}
        \item  $\phi + \psi$
        \item $\phi \psi$
        \item $|\phi|$
        \item $k\phi$ $\forall k \in \mathbb{C}$
    \end{itemize}
都是 simple functions.

特别地, 如果  $\phi, \psi: X \rightarrow  \mathbb{R}$, 那么 $
\max(\phi,\psi), \min(\phi,\psi)
$ 也是 simple functions.
\end{lemma}
\begin{proof}
    trivial.
\end{proof}




\section{measurable function is a limit of simple functions}
\begin{theorem}{approximating a nonneg measurable function by simple function}
\label{approximating a nonneg measurable function by simple function}
    任意的 measurable $f:X \rightarrow [0,\infty]$ 都是 \textbf{pointwise limit} of an \textbf{increasing sequence of simple functions} $\{\phi_n:X\rightarrow [0,\infty]\}_{n\in\mathbb{N}}$.
\end{theorem}
\begin{proof}
    这个构造看起来有点复杂但是其实非常直观.

    对于 $n\in \mathbb{N}$, 我们都 index $0 \leq k \leq 2^{2n}-1$

    然后对每个 $k$ 取:
    $$
    E_n^k := f^{-1}((\frac{k}{2^n},\frac{k+1}{2^{n+1}}])
    $$
    以及:
    $$
    F_n := f^{-1}((2^n,\infty])
    $$

    即, 我们把 $(0,2^n]$ 这一部分值域切成了 $2^{2n}$ 份, 再把 $(2^n,\infty]$ 这一部分值域单独列成一份.
    
    这 $2^{2n} +1$ 份值域的切片, 我们对每一份所对应的 function graph, 都取它对应的 Preimage 上的 indicator function 乘以 $\frac{k}{2^n}$, 这段值域的最小值的 constant 函数, 于是一定会得到一个 well approximation:

$$
\phi_n := \sum_{k=0}^{2^{2n}-1} k\frac{k}{2^n} \chi_{E_n^k} + 2^n \chi_{F_n}
$$
易得, $$\phi_n \leq \phi_{n+1} \leq f$$
for all $n$. 并且\textbf{在 $X \setminus F_n = \{ x\mid f(x) \leq 2^n  \}$ 上我们有}:

$$
0 \leq f-\phi_n \leq \frac{1}{2^n}
$$

    
    随着 $n$ 增大, 最终这个近似会覆盖整个 image, (除非具有非零测数量的无穷间断点, 那样的话最后结果也是无穷), 并且值域的划分越来越精细, 最后会得到: 
    \begin{itemize}
        \item \textbf{$\phi_n \rightarrow f$ pointwisely}
        \item \textbf{在 $f$ bounded 的定义域 $\{x \mid f(x) <\infty\}$ 上, $\phi_n \rightarrow f$ uniformly.}
    \end{itemize}

    \pic[0.6]{ch2-pics.assets/simple.png}    
\end{proof}
\begin{remark}
我们在构造 simple function 的时候这样用到 measurability:
这里的每个 $\phi_n$ 是 simple function, 是由于 $f$ measurable, 以至于每个 \textbf{$E_n^k, F_n$ 作为 interval 的 preimage, 都是 measurable sets. } 
\end{remark}

\begin{corollary}{approximating a complex-valued measurable function by simple function}
对于任意的 measurable $f:X\rightarrow \mathbb{C}$, 都存在 a seq of simple functions $$0 \leq |\phi_1| \leq |\phi_2| \leq \cdots \leq |f|$$ 使得 
\begin{itemize}
    \item \textbf{$\phi_n \rightarrow f$ pointwisely}
    \item \textbf{$\phi_n \rightarrow f$ uniformly on $\{ x \mid |f(x)| < \infty\}$}
\end{itemize}
\end{corollary}

\begin{proof}
    我们可以把 $f$ 拆为 $\im f, \re f$, 然后再把它们分别拆为 $\im f^+ - \im f^-$, 以及 $\re f^+ - \re f^-$. 得到四个 real-valued nonng functions.
\end{proof}




\section{integration of non-neg functions}


\begin{definition}{$L^+$ space and integration on it}
给定一个 measure space $(X, \mathcal{M},\mu)$
    我们定义: $$
    L^+(\mu)  := \{  \textbf{measurable functions }  f: X \rightarrow [0,\infty]   \} $$
对于所有的 \textbf{simple functions $\phi = \sum_{j=1}^n a_j \chi_{E_j} \in L^+(\mu)$}, 即所有非负的 simple functions, 我们定义\textbf{ the integral of $\phi$ with respect to $\mu$} by:
$$\int \phi d \mu  \;(= \int_X   \phi d\mu  ) := \sum_{i=1}^n a_j \mu(E_j)$$
对于任意的 $f \in L^+(\mu)$, 我们定义 \textbf{the integral of $f$ with respect to $\mu$ }by: 
$$ \int f d \mu \;(= \int_X  fd\mu ) := \sup \{   \int \phi d\mu \mid 0\leq \phi \leq f, \phi  \text{ simple} \}$$
\end{definition}

\begin{remark}
因而对于 general 的非负可测函数, 我们通过 \ref{approximating a nonneg measurable function by simple function} 得知, 我们可以用 simple function 来近似它. 从而, 我们使用 simple function 的积分的极限来定义 general measurable function 的积分.

而 simple function 的积分, 即等于它下方的面积. 因而我们发现, 这个积分的定义和 $\mathbb{R}^n \rightarrow \mathbb{R}$ 上 Rieamnn 积分有很大的相似之处, 不同在于一个竖切定义域一个横切值域.

之后我们也会证明, 在 $\mathbb{R}^n \rightarrow \mathbb{R}$ 上, 所有 Riemann 可积的函数也 Lebesgue 可积, 并且得到的结果相同.

这一积分的定义是对 Riemann 积分的推广.
\end{remark}

\begin{remark}
    measure theory 中的积分理论是把从 $\mathbb{R}^n$ 出发的函数 推广到了从抽象的测度空间出发的函数; 而还有其他的积分理论, 比如微分形式上的积分则是把实值函数的积分推广到了 oriented smooth manifolds 上, 不仅可以积分 scalars 还可以积分向量场. 这些积分理论的共同点是对 $\mathbb{R}^n\rightarrow \mathbb{R}$ 上的函数的积分是 coincide 的.

笔者感觉积分理论就是在一个抽象空间上，通过一个抽象的密度函数(被积函数) 以及体积指标(measure function), 得到一个抽象质量。由于这个理念本身是从 $\mathbb{R}^n$ 上 generalize 的，因而各种不同的积分理论在 $\mathbb{R}^n$ 上的积分总是 coincide 的
\end{remark}



\begin{definition}{integration on a subset}
    对非负 \textbf{simple functions $\phi = \sum_{j=1}^n a_j \chi_{E_j} \in L^+(\mu)$}, 我们定义 \textbf{the integral of $\phi$ on $A\in \mathcal{M}$ with respect to $\mu$} by:
$$
\int_A \phi \;d\mu  := \int \phi \chi_A \; d\mu
$$
对于 general 的 $f \in L^+(\mu)$, 我们也从而定义:
$$ \int_A  fd\mu  := \sup \{   \int_A \phi d\mu \mid 0\leq \phi \leq f, \phi  \text{ simple} \}$$
\end{definition}
\begin{remark}
$$
\int_A \phi \;d\mu  := \int \phi \chi_A \; d\mu = \sum_j a_j \chi_{A \cap E_j}
$$
\end{remark}




\begin{proposition}{integral of simple functions 的性质}
Let $\phi, \psi$ be simple functions in $L^+(\mu)$, 有:
\begin{itemize}
    \item \textbf{homogeneity:} 对于任意非负 $c$, 有 $\int c\phi = c\int \phi$
    \item \textbf{linearity:} $\int (\phi + \psi) = \int \phi + \int \psi$
    \item \textbf{monotonicity:} $\phi \leq \psi \implies \int \phi \leq \int \psi$
    \item \textbf{induced measure}: $A \mapsto \int_A \phi \; d\mu$ 是一个 $\mathcal{M}$ 上的 measure.
\end{itemize}
\end{proposition}
\begin{proof}
   \textbf{ homogeneity}  trivial .

  \textbf{  linearity:} Let  $$
    \phi = \sum_{i=1}^n a_i \chi_{E_i} \quad , \psi = \sum_{j=1}^n b_j \chi_{F_j}
    $$ 则有: $$
    E_j = \bigsqcup _k (E_j \cap F_k)\quad , F_k = \bigsqcup_j (E_j \cap F_k) $$ for each $j,k$. 从而有 $$ \int \phi + \int \psi = \sum_{j,k} (a_j + b_k) \mu(E_j \cap F_k)  $$

    \textbf{Monotonicity}: trivial.

    induced measure: 只需要证明 countable additivity, 于是我们让 $A$ be the union of a disjoint seq in $\mathcal{M}, 有:  $$$  \int_A  \phi = \sum_j a_j \mu(A \cap E_j) = \sum_{j,k}  a_j \mu(A_k \cap E_j)    = \sum_k \int_{A_k} \phi$$
\end{proof}
\begin{remark}
    本身, 我们已经基于一个 measure 作为 "体积密度", 来定义一个 simple function 按照这个体积密度得到的积分, 而它在每个可测集上的积分又可以定义另一个 measure; 
    
    这个 measure 表示 "某个集合和 $E_1, \cdots, E_n$ 的交集在这个体积密度以及 simple function 放缩下有多大".
\end{remark}



那么对于 general 的 $f\in L^+(\mu)$, 有刚才的四条性质成立吗? \textbf{显然, monotonicity 和 homogeinity 是成立的}, 但是我们会发现, 很难证明
$$
\int f \; d\mu + \int g \;d\mu = \int(f+g) \;d \mu
$$
$\leq $ 是容易证明的, 但是 $\geq$ 有点困难. 为了证明 $\geq$ 这个方向, 我们需要下面这个重要定理:




\section{MCT}
\begin{theorem}{monotone convergence theorem}
\label{MCT}
Let $\{f_n\}_{n\in\mathbb{N}}$ be a seq in $L^+(\mu)$, 并且有 $f_n \leq f_{n+1}$ for each $n$. \\
我们 define:$$f := \lim_n f_n \; \; (= \sup_n f_n)$$, 则一定有 $$\int f = \lim_{n\rightarrow \infty } \int f_n$$
 \end{theorem}
\begin{proof}
首先 Note 几个事情: 
1. 这个极限函数 \textbf{$f$ 是 well-defined 的} (可能 $\infty$), by \textbf{numerical sequence 的 monotone bounded convergence theorem}. 

2. 同样地, 由于 $\int f_n \leq \int f_{n+1} \leq \int f$, 这个 \textbf{$\lim \int f_n$ 也是存在的}.

3. 并且, $f$ 也是一个可测函数, 因为 by 上个 lecture 的定理: \textbf{可测函数序列的极限也是可测函数.}

现在进行证明: 
By monotonicity of integral, $$\lim \int f_n \leq \int f$$ 

是 natural 的. 因而只需要证明另一方向.

By def, $\int f = \sup \{ \int \phi \mid \phi \leq f\}$ where $\phi $ is simple.
因而 it \textbf{suffices to show: 对于任意 simple $\phi \leq f$, 都有 $\lim \int f_n \geq \int \phi$.}

我们 fix 一个 $0 \leq \phi \leq f$. WTS: $$\lim_n \int f_n \geq \int \phi$$

要证明 $\lim \int f_n \geq \int \phi$, 我们再把它转化成证明: $$\forall \alpha \in (0,1)\;\;\lim_n \int f_n \geq \alpha \int \phi$$
我们取 $$ E_n := \{x \mid f_n(x) \geq \alpha \phi  \} = f^{-1} ([\alpha \phi,\infty]) \in \mathcal{M}$$

容易发现, $E_n \subseteq E_{n+1}$ for each $n$. 并且 Claim: $\union_n E_n = X$.  (这就是为什么要做取 $\alpha$ 这个意义不明的行为) 这是因为 $\alpha < 1$, 并且 $f_n$ converge pointwisely to $f$, by measurable function 的 limit behavior.  \textbf{而由于 simple function $\phi$ 是 bounded 的, 从而 $f_n$ 会 uniformly 向上接近(以至于超过) $\phi$. 取 $\alpha$ 是为了保证, 一定存在一个 $n$ 使得 $E_n = X$ }

于是我们有:
$$
\int f_n \geq \int f_n \chi_{E_n}  \geq \int \alpha \phi \chi_{E_n} = \alpha \int_{E_n} \phi
$$

我们此处又可以用到一条冷门的性质: \textbf{由于 $E \mapsto \int_E \phi$ 是一个 measure on $(X,\mathcal{A})$, by continuous from below, 有:}
$$
\lim_n \int_{E_n} \phi  = \int \phi
$$
从而有$$\lim_n \int f_n \geq \alpha \int \phi$$ finishing the proof.
\end{proof}
\begin{remark}
    这是一个非常重要的定理. 它表示了\textbf{非负可测函数的极限的积分等于积分的极限, 可以把取极限和积分这两个操作进行换序.}
\end{remark}

以下为一个应用 MCT 得到的结论.

\begin{example}
    取 $$(\mathbb{N}, \mathcal{P}(\mathbb{N}), \mu_{counting})$$
    于是$$L^+(\mu) = \{f:\mathbb{N}\rightarrow [0,\infty]  \}$$
    是所有的从自然数到 reals 的函数. (因为我们取了 power set 作为 $\sigma$-algebra)

   \noindent  注意到任何一个这样的函数都可以被 $$\phi_n :=  \sum_{j=1}^n f(j) \mu(\{j\}) =  \sum_{j=1}^n f(j)   $$ 来逼近. 从而 $$
    \int f = \sum_{j=1}^\infty f(j)  \in [0,\infty]
    $$ 
如果取一个从下逼近 $f$ 的可测函数序列 $\{f_n\}_{n\in\mathbb{N}}$, 那么 by MCT, 我们总有:
$$
\sum_1^\infty f_n (j) \nearrow \sum_1^\infty f (j) 
$$
\end{example}


\subsection{(countable) linearity of integral}
\begin{corollary}
$$f,g \in L^+(\mu) \quad \Longrightarrow \quad \int(f+g) = \int f + \int g$$
\end{corollary}
\begin{proof}
使用 approximation by simple functions 以及 MCT.
取 $$\phi_n \nearrow f, \quad \psi_n \nearrow g$$, 从而 $$\phi_n + \psi_n \nearrow f+g$$, 从而我们有 $$ \int (f+g)  \overset{MCT}{=}  \lim_{n} \int (\phi_n + \psi_n)$$
从而由 simple function 的 Linearity 得到:$$ \int (f+g) = \lim_n\int \phi_n + \lim_n \int \psi_n$$
并且由于 $$ \int \phi_n \nearrow \int f, \int \psi_n \nearrow \int g$$
我们得到:
$$
\int (f+g) \geq \int f + \int g
$$
另一方向 trivial.
\end{proof}


\begin{remark}
    由此可见, \begin{center}
\textbf{$f\mapsto \int f$ 是 $\mathbb{R}$-linear 的映射.}
    \end{center}
\end{remark}

\subsection{Tonelli for sum and integrals}
\begin{corollary}{Tonelli for sum and integrals}
\label{Tonelli for sum and integrals}
for $\{f_i\}_{i\in\mathbb{N}}$ in $L^+(\mu)$, 有:
$$
\int \sum_{i=1}^\infty f_i = \sum_{i=1}^\infty \int f_i
$$
\end{corollary}\begin{proof}
Apply MCT to 
$$
g_n = \sum_{i=1}^n f_i
$$ 可得证.
\end{proof}
\begin{remark}
    这是 linearity of integral 的 countable version.\\
    由此可见 MCT 的用处很大.
\end{remark}




\chapter{properties of integration on $L^+(\mu)$}
\section{Fatou's Lemma}
\begin{theorem}{Fatou's Lemma}
    \label{Fatou's Lemma}
 令 $(f_n)$ be a seq of functions in $L^+(\mu)$, then $$ \liminf_n \int f_n \geq \int \liminf_n f_n$$
\end{theorem}

\begin{proof}
    Set \[g_n := \inf_{m \geq n }     f_n   \]于是 \[g_n \nearrow \liminf_n f_n\]
于是\textbf{ by MCT}, we have: \[  \lim_n \int g_n =  \int \lim_n g_n =      \int \liminf_n f_n  \]
By def, 我们有 $g_n \leq f_n \;\;\forall n$, 于是 by monotonicity, $\int g_n \leq \int f_n$. 因而 \[  \liminf_n \int f_n \geq \liminf_n \int g_n  = \lim_n \int g_n = \int \liminf_n f_n   \]
\end{proof}
\begin{remark}
    对于 increasing 的从而有 limit 的可测 $(f_n)$, 我们可以使用 MCT.

    但是对于任意的可测 $(f_n)$, 我们无法使用 MCT, 不过有弱化的版本 Fatou's Lemma. 它表示\textbf{下极限的积分 小于等于 积分的下极限}.

    这是一个符合直觉的事情, 因为取函数的 pointwise 极限是一个很容易极端的事情. 
    
    积分的极限是一个 numerical seq 的极限, 比较 robust. 而函数的逐点极限是一个比较不稳定的事情, \textbf{在对函数逐点极限的过程中, 它的 "质量" 会存在一个比较大的损失, 因为其中可能包含了 uncountably many 个点的函数值的逐点极限的累积, 而积分的极限只是单个点的逐点极限. 因而大小关系很显然. }
\end{remark}


\begin{example}
    取 $(\mathbb{R},\mathfrak{L}, m)$, 考虑 $L^+(m)$ 上的函数, 即非负 Lebesgue 可测函数.

    下面有几个非常经典的 Fatou's Lemma 的例子:

\noindent 1. \textbf{escape to hat}: \[f_n = \chi_{(n,n+1)}\]
$f_n$ 在 $\mathbb{R}$ 上平移

   \noindent 2. \textbf{escape to width}: \[f_n = \frac{1}{n}  \chi_{(0,n)}\]
    $f_n$逐渐变得平坦
    
 \noindent   3. \textbf{escape to height}: \[ f_n = n \chi_{(0,n)}\]
$f_n$ 逐渐变成一根针.

这三个例子中都有 $f_n \rightarrow 0$ pointwisely. 因而 $$\int \lim f_n = 0$$, 而 $$\lim \int f_n = 1$$, 因为对于所有 $f_n$ 都有 $\int f_n = 1$
\end{example}


\section{Chebyshev's inequality with corollaries}

\begin{lemma}{Chebyshev's inequality}
\label{Chebyshev's inequality}
对于 measure space $(X,\mathcal{M}, \mu)$, 如果 $f \in L^+(\mu)$ 并且 $c > 0$, 那么
\[
\mu\{ f \geq c\}  \leq \frac{1}{c} \int f
\]
\end{lemma}\begin{proof}
  Let $E := \mu\{f \geq c\}$
    \[
    \int f \geq \int f \chi_{E} \geq \int c \chi_E = c \int \chi_E = c\mu(E)
    \]
\end{proof}
\begin{remark}
    一个可测集的测度, 就等于 constant 1 在它上面的积分, by definition.

    这是一个简单而常用的结论.
\end{remark}








\begin{proposition}{非负函数积分为 0 等价于几乎处处为 0}
    令 $f \in L^+(\mu)$, 有:
    \begin{center}
        $\displaystyle \int f = 0$ $\Longleftrightarrow$ $f = 0$ a.e. (即只在一个零测集上非 0)
    \end{center}
\end{proposition}
\begin{proof}
    forward direction: directly follows from Chebyshev: set $A_n := \{f \geq \frac{1}{n}\}$, 对于任意 $n$ 都有 $\mu(A_n) \leq n\int f = 0$. 从而 by ctn from below, $>0$ 处构成零测集.
    
    backward direction: 对于 simple function, trivial by 积分的定义; 对于 general $f$, 通过 limit 得到 (它下方的所有 simple functions 也 a.e. 为 0 从而积分为 0).
\end{proof}






\begin{corollary}{几乎处处相等的非负函数积分相等}
Let $f,g \in L^+(\mu)$ 且 $f = g$ a.e., 则有  \[ \int f = \int g\]
\end{corollary}
\begin{proof}
    Set $D : = \{ x \mid f(x) \not = g(x)\}$, 则 $\mu(D) = 0$ by def
    \[
    \int f = \int_{D} f + \int_{D^c} f = 0 + \int_{D^c} g = \int g
    \]
\end{proof}





\begin{corollary}{liminf version of MCT}suppose $(f_n)_{n\in\mathbb{N}} $ 是一个 seq of functions in $L^+(\mu)$, 且 $f_n \rightarrow f \in L^+(\mu)$, 则:
$$
\liminf_n \int f_n \geq \int f
$$
\end{corollary}
\begin{proof}
    这是一个条件稍微弱化的 MCT: 把 $f_n\nearrow f$ 的条件改成了 $f_n \rightarrow f$ a.e., 得到的结论也稍弱化.\\
   \textbf{ modify $f_n$ and $f$ on a null set} (thus without chaning the integral) 后, follows directly from \textbf{Fatou's lemma}, 
\end{proof}


\begin{theorem}{积分收敛 $\implies$ 发散点集零测, 以及 support $\sigma$-finite}
    如果 $f\in L^+(\mu)$ 且 $|\int f| < \infty$, 则有: \[   \mu( \{x\in X \mid f(x) = \infty\} ) = 0\] 并且 \[ \{ x \mid f(x) > 0  \}\] is \textbf{$\sigma$-finite}
\end{theorem}

\begin{proof}
    直接 follows from Chebyshev. 取 \[ A_t := \{ x \mid f(x) \geq t\}\] for $t > 0 $.

于是: \[ \{x\in X \mid f(x) = \infty\}  = \bigcap_{n=1}^\infty A_n  \]
By Chebyshev, each $A_n$ 都有: $\mu(A_n) \leq \frac{1}{n} \int t$, 从而 by continuous from above 可得这个交集的 measure 为 0.

又有:\[ \{x\in X \mid f(x) >0 \} = \bigcup_{n=1}^\infty A_{\frac{1}{n}} \]
其中, each set has measure $\leq n\int f \leq \infty$. By def, 这个集合 $\sigma$-finite.
\end{proof}



\chapter{integration of real and complex functions I}

我们目前只定义了 non-negative $\overline{\mathbb{R}}$-valued measurable function 的积分, 而我们想要完整地定义: $\overline{\mathbb{R}}$-valued measurable function 的积分 $\int f \in \extR$, 以及 $\mathbb{C}$-valued  measurable function 的积分 $\int f \in \mathbb{C}$.

recall: 对于任意 $\extR$-valued $f$, \[f = f^+ - f^-\]

\textbf{因而我们希望 define:}\[ \int f = \int f^+ -\int f^-\]
但是其中有一个 undefined 的问题: 我们要避免 $\infty - \infty$ 这一类的问题. 因而我们无法对所有的可测函数进行积分, 而是定义 "integrable" 的可测函数.

\begin{lemma}
    \[
    \begin{cases}
        \int f^+ < \infty \\
        \int f^- < \infty
    \end{cases} \Longleftrightarrow \int|f| < \infty
    \]
\end{lemma}
\begin{proof}
    trivial.
\end{proof}
 正负部分都可控, 肯定是当且仅当绝对值函数可控.

 我们接下来将定义可积函数的空间是: 所有绝对值积分非无穷的函数. (怎么和预期不一样...这样的话这个空间在积分运算下的值域就是 $\mathbb{R}$ 而不是 $\extR$ 了. 我期待的是为了避免无穷之间相减的 undefined behavior 只需要正负部分有一个积分非无穷就行了. 但是我们要求的是都不是无穷.  不过既然这么定义了肯定有其道理.)




\section{$\tilde{L}(X, \mu, \mathbb{C})$ and $L^1(X, \mu, \mathbb{C}$)}
\begin{definition}{real-valued integrable function}
Given measure space $(X,\mathcal{M},\mu)$,  \textbf{measurable $f : X \rightarrow \extR$ 被称为 integrable} 的, 如果它满足 \[ \int |f| < \infty\] 并定义其 integral 为: \[\int f = \int f^+ - \int f^-\]
\end{definition}
\begin{definition}{complex-valued integrable function}
    Further, 我们定义 \textbf{measurable $f:X \rightarrow \mathbb{C}$ 是 integrable 的}, 如果它同样满足: \[\int |f| < \infty\]
\textbf{注意到这个条件等价于 \(\re f, \im f\) integrable, 因为}
\[|f| \leq |\re f| + |\im f| \leq 2|f|\]
我们定义其 integral 为: \[\int f = \int \re f+ i \int \im f\]
\end{definition}
\begin{remark}
    所以说,\textbf{ 实值函数的积分要计算两个, 复值函数的积分要计算四个}. (好麻烦.)
\end{remark}


\begin{proposition}
    所有的 real-valued integrable functions 构成一个 $\mathbb{R}$-vector space, 并且 integral 是一个 linear functional on it.
    
    所有的 complex-valued integrable functions 构成一个 $\mathbb{C}$-vector space, 并且 integral 是一个 linear functional on it.
\end{proposition}
\begin{proof}
    trivial.
\end{proof}
下面我们可以定义这个 vector space 并在上面进行一定研究. 此处为一个 temporary 的记号:
    
\begin{definition}{$\tilde{L}(X, \mu, \mathbb{R})$ 以及$\tilde{L}(X, \mu, \mathbb{C})$ space}
给定 measure space $(X, \mathcal{M},\mu)$
    我们定义 \[\tilde{L}(X,\mu, \mathbb{R}) := \{  \text{all (extended) real-valued integrable functions on } X\} \] 以及 \[\tilde{L}(X, \mu, \mathbb{C}) := \{  \text{all complex-valued integrable functions on } X\} \]
\end{definition}
\begin{remark}
    这基本接近我们最终的可积空间的定义了. 只需要再 quotient 掉所有的 a.e. 相等的函数就可以. 在此之间, 我们首先在这临时的空间上证明一些结论.

   \textbf{ 我们基本不使用 \(\tilde{L}(X,\mu, \mathbb{R})\), 因为它是 \(\tilde{L}(X,\mu, \mathbb{C})\) 的 subspace, 而且大部分结论基本都在更 general 的 \(\tilde{L}(X,\mu, \mathbb{C})\) 上成立.}
\end{remark}
\begin{remark}
    这个 $\mathbb{C}$-vector space 的 dimension 是多少呢: \\
    如果 $X$ 是一个 finite set, 那么 \(\tilde{L}(X,\mu, \mathbb{C})\)  的 dimension 是 $|X|$, 因为 $e_i : x_j \mapsto \delta_{ij}$ 是一个 basis; 同样的, 如果 $X$ countable, 那么 \(\tilde{L}(X,\mu, \mathbb{C})\) 的 dimension 也是 countably infinite 的; 如果 $X$ uncountable, 那么 \(\tilde{L}(X,\mu, \mathbb{C})\) 的 dimension 也是 uncountable 的.\\
    比如, \(\tilde{L}(\mathbb{R}^n,\mu, \mathbb{C})\) 的 dimension 就是 uncountable 的.
\end{remark}

\begin{proposition}
    \(\tilde{L}(X, \mu, \mathbb{C})\) 上, $f\mapsto \int f$ 为一个 linear functional.
\end{proposition}
因为积分是 linear 的, as we have proved.


\begin{proposition}
$$f \in \tilde{L}(X,\mu, \mathbb{C}) \implies |\int f| \leq \int |f|$$
\end{proposition}
\begin{proof}
    For real-valued case, $$ \Big| \int f  \Big| =\Big|\int f^+ - \int f^- \Big|  \leq \Big|\int f^+\Big| +  \Big|  \int f^- \Big|  = \int f^+  + \int f^- = \int |f|$$
For complex-valued case,
Set $$\alpha = \frac{\int f}{|\int f|}$$
    于是有 $\alpha \in \mathbb{C}$ 且 $|\alpha| = 1$. \textbf{Note: 一个绝对值为 1 的 complex number 的倒数是它的 conjuate.} \\
   因而:
   $$
  \Big|\int f \Big| = \overline{\alpha} \int f = \int \overline{ \alpha } f  \in \mathbb{ R}
   $$
   从而 $$ \Big| \int f \Big|  = \int \overline{\alpha} f = \int \re (\overline{\alpha } f) \leq \int |\re (\overline{\alpha} f)  | \leq \int |\overline{\alpha} f| = \int |f|$$
\end{proof}



\begin{definition}{integratal restricted to a measurable set}
    if $f \in \tilde{L}(X, \mu, \mathbb{C})$, $E \in \mathcal{A}$ ($\mu$ 的 $\sigma$-algebra), 我们 define: $$\int_E f   \, d \mu := \int f  \chi_E \, d \mu$$\end{definition}
\begin{remark}
    容易验证, restricted to a measurable set 的积分也是 linear 且 monotone 的.
\end{remark}



\begin{proposition}{可积函数几乎处处相等的等价条件}
    if $f,g \in \tilde{L}(X, \mu, \mathbb{C})$, 则 TFAE: 
    \begin{itemize}
        \item $f=g $ a.e.
        \item $\int |f-g| = 0$
        \item $\int _E f = \int _E g$ for all $E \in \mathcal{A}$
    \end{itemize}
\end{proposition}
\begin{proof}
    $(i) \Longleftrightarrow (ii) $: by last time proposition.\\
    $(ii) \implies (iii)$: 因为 $$
    \Bigg|\int_E f - \int _E g  \Bigg|  = \Bigg| \int (f-g_)\chi_E  \Bigg| \leq \int |f-g| \chi_E \leq \int|f-g| = 0
    $$
    $(iii) \implies (ii)$: 令 $u := \Re (f-g)$, $v := \Im (f-g)$, 则 $$
    \int |f-g| = \int u^+ + \int u^- + i\int v^+ + i\int v^-
    $$
\textbf{这四个积分都是正值. }容易发现如果 $u^+$ 在一个 positive measure set $E$ 上非 0, 那么 $\int_E u^+ > 0$ , 那么 $\int |f-g| > 0$. (其他三个积分同理.)
\end{proof}
\begin{remark}
    $\int |f-g| = 0$ 是一个比 $\int f-g = 0$ 更强的条件. $\int f-g = 0$ 可以是非零集有交错并且正负抵消, 而 $\int |f-g| = 0$ 则表示 a.e. 相等.
    \end{remark}



\begin{remark}
    有这个定理得:\textbf{ 我们可以 integrate $f:X\rightarrow \mathbb{C}$ a.e. defined}.\\
    即: $$
    f: E^c \rightarrow \mathbb{C}\quad , \quad \mu(E) = 0
    $$
    其中的一种情况是: $$
    f: X \rightarrow \overline{\mathbb{R}} \quad s.t. \quad |f| < \infty  \;\;\ a.e.
    $$
\end{remark}

并且我们发现, a.e. 相等的两个可积函数 $f,g \in \tilde{L}(X, \mu, \mathbb{C})$ 在任意可测集上的积分都相等. 于是这两个函数在 $\tilde{L}(X, \mu, \mathbb{C})$ 中的表现是相等的. 因而我们可以把 a.e. 相等的这种关系 quotient 掉, 简化这个空间:


\begin{definition}{$L^1(\mu)$ space}
    我们定义 $L^1(X, \mu, \mathbb{C})$, 或简称为 $L^1(\mu)$, 为:$$
    \tilde{L}(X, \mu, \mathbb{C}) / \sim 
    $$
其中 $\sim$ 表示一个 equivalent class: $f\sim g$ if $f=g$ a.e. (等价于 $\int |f-g| = 0$)
 \end{definition}
$L^1(\mu)$ 中的每个函数之间彼此至少都在一个正测度集上相互不同. 这减去了分析上考虑几乎处处相等的集合的顾虑, 对于处处相等的函数, 我们认为它们在 $L^1(\mu)$ 上直接相等. 并且, 我们有: $$
f \mapsto \int f
$$
在 $L^1(\mu)$ 上是一个 well-defined function.




\section{DCT}


\begin{lemma}
    令 $(f_n)$ 为 a seq of \textbf{a.e. defined functions} on $X$., s.t. \[
    f(x) := \lim_{n\to \infty} f_n(x) 
    \] \textbf{exists a.e.}
    Claim: \textbf{$f$ is measurable.}
\end{lemma}
\begin{remark}
    Measurability is well preserved by taking limit, 并且更改一个零测集上函数的 definedness 不会改变这个 behavior. (这是一个很宽的条件了)
\end{remark}



\begin{theorem}{dominated convergence theorem}
    \label{DCT}
    Let $(f_n)$ be a seq of functions in $L^1(\mu)$, s.t. \begin{itemize}
        \item $f_n \rightarrow f $ a.e.
        \item 存在 $g \in L^1(\mu)$ s.t. $|f_n| \leq g $ a.e. for all $n$. 
    \end{itemize}
    Claim: $f \in L^1(\mu)$ 并且 \[
    \int f = \lim_n \int f_n
    \]
\end{theorem}
\begin{proof}
    首先由于 $f_n \to f$ a.e.,  by lemma 可以得到 $f$ 是 measurable 的.\\
    并且 $$|f_n| \leq |g| \text{ a.e. } \implies  |f| \leq |g| \text{ 
a.e.}$$ 于是 \[\int |f| \leq \int |g| < \infty \] 即 $f \in L^1$. (从而 $|f|$ 至多在一个 measure zero set 上无穷).\\
并且 $ g(x) \pm f_n(x) \geq 0 $ a.e. 这一点很重要, 因为从而我们可以对 $g+f_n$, $g-f_n$ 使用 Fatou's Lemma: 
\begin{align}
    \int g + \int f = \int (g+f) &= \int (g + \lim_{n\to\infty} f_n) \\
    &= \int \lim_{n\to\infty} (g+f_n) \\
    &  \overset{\text{by Fatou}}{\leq }  \liminf_n \int (g+f_n) \\
    &= \int g + \liminf_n \int f_n
\end{align}从而 (由于 $\int g < \infty$)\[
\int f \leq \liminf_n \int f_n
\]
以及 similarly get: \[
\int g - \int f \overset{\text{by Fatou}}{\leq } \liminf_n \int (g-f_n) = \int g - \limsup_n \int f_n
\]
从而: \[
\int f  \geq \limsup_n \int f_n
\]
(这里注意, negate 一个 numerical seq 后 liminf 变 limsup. 由此可见 Fatou'e Lemma 其实是很强大的, 只需要对 $\int g + \int f$ 和 $\int  g - \int f$ 各用一次就可以得到: )\[
\int f = \lim_{n\to \infty } \int f_n
\]
\end{proof}

\begin{remark}
DCT 是 MCT 在 $L^1$ 上的推广. MCT 只作用于非负的可测函数, 并且要求序列递增. 而 DCT 则作用于更加广泛的情况.\\

DCT 增加的要求是存在一个 $L^1$ 的 (a.e.) bound function, 以及极限 a.e. 存在于 extened $\mathbb{R}$. 这两个要求都是合理的, 一个控制了函数的上下浮动程度, 一个控制了序列的收敛性.\\

而进一步, 我们可以把 "存在 $g \in L^1$ s.t. $|f_n| \leq |g| $ a.e. for all $n$." 这一 条件放宽到 : 存在一个 seq $(g_n)$ 以及 $g$ in $L^1$, 使得 \begin{itemize}
        \item $|f_n| \leq g_n$
        \item  $g_n \to g$ a.e.
        \item $\int g_n \to \int g$
    \end{itemize}
Proof 在 hw 5.
\end{remark}

\begin{example}
    Suppose $u:[0,1] \to [0,1]$ is Lebesgue measurable. \\
    考虑这一 seq of function: $( u^n)$.\\
    容易发现 $u^n \rightarrow \chi_{\{u = 1\}}$ p.w.
    我们可以用 $g = 1$ 作为 bound function. 从而得到: \[
\int f=    \lim_{n\to\infty} \int f_n = \int_{\{u=1\}}1 = m(\{\mu =1 \})
    \]
\end{example}


\begin{example}
    compute \[
    I = \lim_{n\to \infty} \int_{[0,1]} \frac{1 + n x^2}{(1+ x^2)^n}
    \]
令 $f_n(x) : = \frac{1 + n x^2}{(1+ x^2)^n}$, 有: $f_n(x) \to 0$ as $n\to \infty$ for $x \in (0,1]$;\\
并且考虑 $g=1$, 作为 bound.\\
因而有 $I = 0$
\end{example}


\chapter{integration of real and complex functions II}
\section{corollaries of DCT}
以下为 DCT 的 corollaries:

\subsection{Fubini for series and integral}
\begin{corollary}{Fubini for series and integral}
对于 $L^1(\mu)$ 中的 sequence $(f_n)$,  如果 $\sum_{n=1}^\infty \int |f_n| < \infty$, 则 $$\sum_{n=1}^\infty f_n   \overset{a.e.}{\to}  F\in L^1(\mu) \;\;$$ 并且 \[  \int \sum_{n=1}^\infty f_n 
 =    \int F = \sum_{n=1}^\infty \int f_n\]
\end{corollary}
\begin{proof}
Recall \textbf{Tonelli for sum and integrals}: 对于 $\{f_n\}_{n\in\mathbb{N}}$ in $L^+(\mu)$, 有:
$$
\int \sum_{n=1}^\infty f_n = \sum_{n=1}^\infty \int f_n
$$
(又是经典 Fubini 补充 Tonelli) 这个定理是 Tonelli for sum and integrals 在 $L^1$ 上的推广.\\
我们 set \[
F_n : = \sum_{i=1}^n f_j\quad G:= \sum_{n=1}^\infty  |f_n|
\]
By Tonelli for sum and integrals, 有: \[
\int G = \int \sum_{n=1}^\infty  |f_n| =  \sum_{n=1}^\infty \int  |f_n| 
\]
由条件知道, $\int G < \infty$, 因而 $G \in L^1(\mu)$.
所以 $G$ 可以作为 $F_n $ 的 DCT bound: \[
\int |F| \leq \int G = \sum_{n=1}^\infty \int  |f_n| 
\] 因而 by DCT:: \[
\int F = \lim_{n\to \infty } \sum_{i=1}^n \int f_i =  \sum_{n=1}^\infty \int f_n
\]
\end{proof}
\begin{remark}
    Fubini's for sum and integrals : 对于一个 seq of 可积函数, \textbf{如果它们的绝对积分和收敛, 那么它们的 infinite sum 函数也是可积的}, 并且可以交换积分和极限次序. \\
    其实显然. 因为绝对积分和肯定 by tri ineq 是大于等于和的积分的, 绝对积分和能作为一个 bound function.
\end{remark}


\subsection{a function that is measurable in one var and ctn/diffble in another}

\begin{corollary}
  令 $(X,\mathcal{A}, \mu)$ be a measure space.\\
  如果 $f: X \times [a,b] \to \mathbb{C}$ 满足 $f(\cdot, t) \in L^1(\mu)$ for all $t \in [a,b]$, 令 \[
F(t) := \int f(x,t) \; d\mu(x)
  \] 则有:
  \begin{enumerate}
      \item 如果 $t \mapsto f(x,t) $  对于任意 $x$ 都连续, 并且存在一个 $g \in L^1(\mu)$ 使得 $|f(t,x)| \leq g(x)$ for all $t,x$, 那么 \textbf{$F$ 也是 ctn 的.}
      \item 如果 $\frac{\partial f}{\partial t} (x,t)$ 对于任意 $x,t$ 都存在, 并且存在一个 $g \in L^1(\mu)$ 使得 $|\frac{\partial f}{\partial t} (x,t)| \leq g(x)$ for all $t,x$, 那么 \textbf{$F$ 是 differentiable 的}, 并且 $$F'(t) = \int \frac{\partial f}{\partial t} (x,t) \; d\mu(x)$$
  \end{enumerate}
\end{corollary}
\begin{proof}
    这一证明并不困难.\\
    For part(1), STS: $t_n \to t \implies F(t_n) \to F(t)$\\
    Apply DCT with $f_n(x) = f(x,t_n)$, $f(x) = f(x,t)$.\\
    For part(2), Suppose $t_n \to t$.\\
    Apply DCT to \[
    h_n(x) := \frac{f(x,t_n) - f(x,t)}{t_n - t}
    \]
    由可导得连续得 $x \mapsto \frac{\partial f}{\partial t}(x,t)$ measurable.\\
    并且 \textbf{by MVT, }\[
    |h_n(x)| \leq \sup_{t \in [a,b]} \Big| \frac{\partial f}{\partial t} (x,t) \Big| \leq g(x)
    \]
    从而我们也用 $g$ bound 住了 $h_n(x)$. \textbf{Apply DCT: }\[
  F'(t) = \lim_{n\to \infty}  \frac{F(t_n) - F(t)}{t_n -t}  =  \lim_{n\to \infty} \int \frac{f(x, t_n) - f(x,t)}{t_n - t} = \lim_{n\to \infty} \int h_n  = \int \frac{\partial f}{\partial t} (x,t) \; d\mu(x)
    \]
\end{proof}
\begin{remark}
    由 DCT, 我们不仅可以交换积分和求极限的次序, 还可以在足够的条件下交换多变量的求导和积分的次序. 这一点是值得注意的, 因为 \textbf{DCT 描述的 sequential behavior 可以应用到证明函数 continuous 和 derivative 存在}, 使用 sequential definition. \\
    如: 如果一个多变量函数对于 $x$ 是 measurable 的, 并且满足对于 $t$ 的 partial derivative 处处符合 DCT 条件. 那么我们可以\textbf{调换它对于 $x$ 积分和对于 $t$ 求导的顺序}.\\
    看起来很雾但是我们看一个例子 (此为一个反例):
\end{remark}

\begin{example}
是否有: \[
    \frac{\partial}{\partial t} \int_{\mathbb{R}_{> 0}} e^{-tx} \; dm(x)  \overset{???}{=} \int_{\mathbb{R}_{> 0}} -x e^{-tx} \; dm(x)   = -\frac{1}{t^2} 
    \]
Here \[
f(t,x) = e^{-tx}, \quad t>0, x>0
\] 因而 \[
\bigg| \frac{\partial}{\partial t} f(t,x) \bigg|=  xe^{-tx}, \quad t> 0 , x> 0
\]
尝试找到它的 dominating $g(x)$: 这个函数在 $t \to 0$ 处的上极限是 $g(x,t) = x$, 但是这个 $g$ 却不是一个 $L^1$ 函数 (在半轴上积分为 $\infty$). 从而它不可以这么交换积分和求导顺序. 但是如果把 $t$ 的范围限制在 $t \geq a \in \mathbb{R}_+$ 而不是 $t>0$, 我们就可以交换这个积分和求导顺序, 因为此时可以设定 \[
g(x,t)  = xe^{-ax}
\]
\end{example}




\section{$L^1$ as a Banach space}
\begin{theorem}{$L^1(\mu)$ 以 integral w.r.t. $\mu$ 作为 norm 是一个 normed VS}  在 $L^1(\mu)$ 上, 我们 set \[
||f||  := \int |f|
\]
    则 $(L^1(\mu), ||\cdot||)$ 为一个 \textbf{normed $\mathbb{C}$-vector space. 即, 这是一个 well-defined norm.}
\end{theorem}
\begin{proof}
    recall norm 的定义, 需要符合: \begin{itemize}
        \item Homogeneity: \[
        ||af|| = |a|\cdot ||f||
        \]
        \item triangle ineq: \[
        ||f+g|| \leq ||f|| + ||g||
        \]
        \item nonnegativity: \[
        ||f|| \geq 0,\quad = \text{ iff  } f=0 \in L^1 \text{ (i.e. } f(x) = 0 \text{ a.e.)}
        \]
    \end{itemize}
前两条是积分的 linearity 的下位推论. 后一条 by def.
\end{proof}

\begin{corollary}{$(L^1(\mu), ||\cdot||)$ 是一个 Banach space}
    $(L^1(\mu), ||\cdot||)$ 的 induced metric space 是 complete 的. 即, every Cauchy seq converges.\\
    (\textbf{从而这是一个 Banach space}. )
\end{corollary}
\begin{proof}
    取一个 Cauchy seq $(f_n) $ in $L^1$.\\
这里有一个值得 recall 的 proposition: \begin{proposition}
在一个 metric space 中, 一个 Cauchy seq converges 当且仅当它存在一个 convergent 的 subsequence.
\end{proposition}
证明很简单. 对于任意的 $\epsilon$, 可以取 $\max(N,M)$, 其中 N 为使得这个子序列所有元素距离 $x_* < \epsilon / 2$ 的下标，M 为使得主序列所有元素两两之间距离 $< \epsilon / 2$ 的下标. \\
因而我们\textbf{只需要证明存在一个 subseq $(f_{n_j}) $ s.t. $f_{n_j} \overset{j\to \infty}{\longrightarrow} f \in L^1$ 即可.}\\
已知 Cauchy, WTS: $f_n$ 收敛且极限在 $L^1$ 中. 我们直觉: 用 Cachy 条件构造 $1/\epsilon^2$ argument. \\
我们 pick 子下标 $(n_j)_{j\in \mathbb{N}}$ 使得对于每个 $j$ 都有 \[
m,n \geq n_j \implies       ||f_m - f_n||_1 \leq \frac{1}{2^j}
\]
并 set \[
g_j := f_{n_j} - f_{n_{j-1}}, \quad g_1 = f_{n_1}
\]则有 \[
\sum_{j=1}^\infty \int |g_j| \leq 1 < \infty
\]
从而 \textbf{by Fubini's Thm for series and seqs,} 存在: 
\[
f: = \lim_{j \to \infty} \sum_{i=1}^j g_j = \lim_{j \to \infty} f_{n_j}  \in L^1 \;\; \exists a.e.
\]
同时有 \[
\int |f - f_{n_j} | \leq \sum_{j+1}^\infty  \int |g_j|  \leq \frac{1}{2^j} \overset{j\to \infty}{\longrightarrow} 0
\]
\end{proof}
\begin{remark}
这里就发现了 Fubini for series and seq 的用处: 把求和与积分的换序从有限推广到无限求和上, 以绝对积分和有限为条件. 因而, \textbf{绝对积分和有限的 seq 是性质强大的. }\\
而我们可以运用这一点来发掘 function seq 的性质, 比如这里\textbf{把一个 function seq 通过构造前后项差的方式, induce 出一个绝对积分和有限的 seq, 从而用这个 seq 的积分和反向证明原 seq 的性质}.
\end{remark}



\section{density of simple function of $L^1(\mu)$}

\begin{theorem}{density of simple functions in $L^1(\mu)$}
  令 $(X, \mathcal{A}, \mu)$ 为一个 measure space,  令 $f \in L^1(\mu)$, \\
    对于任意 $\epsilon > 0$, 都存在 simple $\phi: X \rightarrow \mathbb{C}$ in $L^1(\mu)$, 使得 \[
    \int |f - \phi| 
< \epsilon
    \]
\end{theorem}
\begin{proof}
    这是显然的, by 积分的定义. 我么首先把 $f$ divide 为 \[
    f = u +iv, \quad u = u^+ - u^-,\quad v = v^+ - v^-
    \]
    而后对这四个非负函数 $u^+,u^-, v^+, v^-$分别使用 simple function seq approximation, 再使用 DCT:
    \[
   \int \lim \phi_n =     \int u^+ =  \lim \int \phi_n
    \]
    比方说 $(\phi_n)$ 为从下逼近 $u^+$ 的 simple function seq, 那么 $u^+$ 是它的 dominating function, 同时也是极限. 那么对于任意的 $\epsilon > 0$ 都存在一个 $n$ 使得  \[
||u^+ - \phi_n||_1 \leq  \int u^+ -    \int \phi_n  < \epsilon
    \]
\end{proof}


尤其是这一特殊情况: 
\subsection{density of step functions in $L^1(m)$ }
\begin{theorem}{LS measure space 的 $L^1$ space 上的 density of step functions}
考虑 $(\mathbb{R}, \mathcal{L}, m_s)$ where $m_s$ 为一个 Lebesgue-Stieljes measure on $\mathbb{R}$, let $f \in L^1 (\mu)$,\\
对于任意 $\epsilon >0$, 都存在 step function $\phi = \sum_{j=1}^N c_j \chi_{I_j}$, 使得 \[
\int (f-\phi) < \epsilon
\] where each $I_j$ 都是 open intervals.
\end{theorem}
\begin{proof}
和 general case 相似. 利用 the fact that 任意一个 Lebesgue mble function 都可以用 step function 来 approximate.
\end{proof}







\chapter{integration of real and complex functions III}
\section{another dense subspace of $L^1(m_s)$: $C_c (\mathbb{R})$}

上一节课我们知道了: 所有的 simple functions 在 $L^1(\mu)$ 中构成了一个 dense subspace. 尤其是特殊情况: 对于 $(\mathbb{R}, \mathcal{L}, m_s)$, \textbf{所有的 step functions 构成了一个 dense subspace of $L^1(m_s)$. }

今天我们先介绍另一个特殊情况 $(\mathbb{R}, \mathcal{L}, m_s)$ 的 $L^1(m_s)$ 的 \textbf{另一个 dense subspace: 所有的 cpt supported continuous function. }

也就是说, \textbf{任意的 Lebesgue intble function 都可以用 ctn function with compact supp 来近似. } 一个可积函数可以是 supp 非常怪异的以及非常 unctn 的, 但是却可以用 ctn and cpt supp functions 来逼近, in $L^1$ sense. 当然这是一种弱逼近. 函数可以差异很大.

\begin{definition}{$C_c (X)$}
令 $X$ be a metric space, 我们定义:
\[
C_c(X) := \{\text{all ctn functions }f:X \to \mathbb{C}  \text{ with cpt supp}  \}
\]
\end{definition}

\begin{theorem}{$C_c(X) \subset L^1(\mu)$ 是一个 dense linear subspace}
$C_c(\mathbb{R}) \subset L^1(\mu_m)$ 为一个 dense linear subspace.
\end{theorem}
\begin{proof}
对于 $f \in L^1(m_s)$, let $\epsilon > 0$.我们首先 pick 一个 step function 来approximate $f$:   \[
\phi = \sum_{j=1}^n c_j \chi_{I_j} , \quad  s.t. ||f-\phi||_1 < \frac{\epsilon}{2}
\]
空出来的 $\frac{\epsilon}{2}$, 我们使用 ctn and cpt supp function $f_j$对每个 $\chi_{I_j}$ 进行逼近, by:
 \pic[0.6]{ch2-pics.assets/image-20250219092808932.png}
从而 $||\sum_j f_j  - \phi|| < \frac{\epsilon}{2}$, 因此 $||\sum_j f_j  - f|| < \frac{\epsilon}{2}$ by tri ineq. 得证.
\end{proof}






\section{Riemann v.s. Lebesgue integral}
我们已经完成了一个任意的 measure space 上的 Lebesgue 积分的定义, 以及可积空间的定义.\\
Recall: Riemann integral 是对于 $\mathbb{R}^n \rightarrow \mathbb{R}$ 的函数定义的, 经典定义为 $\mathbb{R} \to \mathbb{R}$ 的函数.\\
现在我们比较对于 $\mathbb{R} \to \mathbb{R}$ 的函数的 Riemann 和 Lebesgue 积分. 我们将会得出结论: \textbf{Riemann 积分是 Lebesgue 积分的特殊情况, 即, Riemann 可积的函数一定也 Lebesgue 可积, 并且积分值相同}. (对于 $\mathbb{R}^n \rightarrow \mathbb{ R}$ 的函数也一样, 之后将展开.)\\

Recall Riemann integral 的定义: \begin{definition}
    对于 $f: [a,b] \rightarrow \mathbb{R}$ bdd, 一个 \textbf{partition} $\mathcal{P} = \{t_j\}_{j=0}^n$ on $[a,b]$ 满足 \[
    a = t_0 < t_1 < \cdots < t_n = b
    \]
Define: \[
S_{\mathcal{P}}(f) : = \sum_{j=1}^n \sup _{[t_{j-1}, t_j]}  f(t_j - t_{j-1})
\]\[
s_{\mathcal{P}}(f) : = \sum_{j=1}^n \inf _{[t_{j-1}, t_j]}  f(t_j - t_{j-1})
\]
Define over all possible partition on $[a,b]$: \textbf{lower integral} and \textbf{upper integral}\[
\overline{I}(f) : = \inf_\mathcal{P \text{ partition}} S_{\mathcal{P}}(f)
\]\[
\underline{I}(f) : = \sup_\mathcal{P \text{ partition}} s_{\mathcal{P}}(f)
\]
注意到, 对于任意的 $f$, 总是有 \[
\underline{I}(f) \leq \overline{I}(f)
\]
我们称 $f$ 是 \textbf{Riemann integrable} 的, if \[
\underline{I}(f) = \overline{I}(f) := I(f)
\]
这个 $I(f)$ 称为 $f$ 在 $[a,b]$ 上的 Riemann integral. 
\end{definition}


\subsection{Riemann intble $\implies$ Lebesgue intble  }
\begin{theorem}{Riemann integral 是 Lebesgue integral 的特殊情况}
\[  f \text{ Riemann integrable} \implies\begin{cases}
        f \in L^1([a,b], \mathcal{L}. m) \\
        I(f) = \int_{[a,b]} f \; dm
    \end{cases} \]
\end{theorem}
\begin{proof}
    for (a): 对于给定 partition $\mathcal{P}$, 我们 set: \[
    G_\mathcal{P} : = \sum_j M_j  \chi_{[t_{j-1},t_j]} , \quad     g_\mathcal{P} : = \sum_j m_j  \chi_{[t_{j-1},t_j]} 
    \]
    从而有: \[
    S_\mathcal{P}(f) = \int G_\mathcal{P} \; dm , \quad s_\mathcal{P}(f) = \int g_\mathcal{P} \; dm
    \]
    我们知道, refinement 能增加 $s_\mathcal{P}$, 减小 $S_\mathcal{P}$ 从而增加逼近精度, 这一点在 Lebesgue integral 中更加明显: \begin{align}
 \mathcal{P } \subset \mathcal{P}' &\implies g_\mathcal{P} \leq g_\mathcal{P'} \leq f \leq G_{\mathcal{P}'} \leq  G_\mathcal{P}         \\
 & \implies s_\mathcal{P} \leq s_{\mathcal{P}'} \leq I(f) \leq S_\mathcal{P'} \leq S_\mathcal{P}
    \end{align}
由于$f$ Riem integrable, \textbf{存在一个 seq of partitions $(\mathcal{P}_n)$ 使得 $\mathcal{P_n}\subset \mathcal{P}_{n+1}$, $||\mathcal{P}|| \to 0$ (mesh), 并且} \[
s_{\mathcal{P_n}}, S_{\mathcal{P_n}} \overset{n \to \infty}{\longrightarrow}  I(f)
\]
因而 settiing \[
g : = \lim_{n\to \infty} g_{\mathcal{P}_n} 
\] 为一个 increasing limit; \[
G : = \lim_{n\to \infty} G_{\mathcal{P}_n} 
\] 为一个 decreasing limit; 由 mble seq 的 limit behvior 得 $g,G \in L^1(m)$ 且 $g \leq f \leq G$
并且 by DCT: \[
\int g \; dm = \lim_n \int g_{\mathcal{P}_n} = I(f) 
\]\[
\int G \; dm = \lim_n \int G_{\mathcal{P}_n} = I(f) 
\]
从而 \[
g \leq f \leq G , \quad \text{and }  \int (G-g) \; dm = 0
\]因而 \[ g =G \;\; a.e.  \;\;(\implies = f \;\; a.e.)
\]
因而 \[
I(f)  = \int f  \; dm
\]
(由于  $m$ complete, $f$ 是 Lebesgue mble 的.)
\end{proof}
\begin{remark}
    整体 intuitive. 对定义域的切分是对值域的切分的特殊情况. 
\end{remark}



\subsection{Lebesgue's criterion for Riemann integrability}

\begin{theorem}{Lebesgue's characterization of Riemann integrability}
     定义 \[
    D_f = \{ x \text{ where } f \text{ is not ctn at}   \}
    \]
    则有 \[
    f \text{ Riemann intble } \Longleftrightarrow m(D_f) = 0 \]
\end{theorem}
\begin{proof}
    在 395 中已经证明一次. 这里再回顾一次.\\
    Backward direction: trivial. \\
    Forward direction: assume $   f \text{ Riemann intble }$. \\
    对于 $f:[a,b] \to \mathbb{R}$,  我们 define: \[
    H(x)  := \lim_{\delta \to 0} \sup_{|y-x| \leq \delta} f(y), \quad h(x) := \lim_{\delta \to 0} \inf_{|y-x| \leq \delta} f(y)
     \]
    即 $f$ 在 $x$ 处的上下极限. 从而: \[
    f \text{ ctn at } x \Longleftrightarrow  \lim_{y \to x} f(y) = f(x)  \Longleftrightarrow H(x) = h(x)
    \]因而要证明 $m(D_f) = 0$, STS: $H(x) = h(x)$ a.e.\\
To prove this: 见 395.
\end{proof}





\chapter{modes of convergence}
对于 $f_n,f:X \rightarrow \mathbb{C}$, 我们目前有 4 种不同的 convergence.\\
2 \textbf{general ones}:
\begin{itemize}
    \item \textbf{pointwise convergence}: 字面意思. 
    \item \textbf{uniform convergence} (on a subset): 对于任意 error bound $\epsilon$, 存在同一个序号 $N$ 可以 $\epsilon$-bound 住这个集合里所有的 $x$ 的函数值和 limit 函数值的 error. 
\end{itemize}
2 \textbf{in a measure space}:
\begin{itemize}
    \item \textbf{a.e. convergence}: ptwise convergence for a.e. $x$, 即 outside a null $E$.
    \item \textbf{convergence in $L^1$}: $\int |f_n -f| \rightarrow 0$
\end{itemize}

我们 recall trivial relation: \[
\text{uni. conv} \implies \text{ptwise. conv} \implies \text{conv. a.e.}
\]
但是我们不清楚 $L^1$-convergence 和它们之间的关系.\\
我们看以下的 examples: 
\begin{example}
    on $(\mathbb{R}, \mathfrak{L}, m)$, 以下 $(f_n)$:
    \begin{itemize}
        \item $$f_n = \frac{1}{n} \chi_{(0,n)}$$
        $f_n \rightarrow 0$ uniformly 但 $\not\rightarrow 0$ in $L^1$

        \item $$f_n = \chi_{(n,n+1)}$$
        $f_n \rightarrow 0$ ptwisely 但并不 uniformly, 并且 $\not\rightarrow 0$ in $L^1$

        \item $$f_n = n \chi_{[0,\frac{1}{n})}$$
        $f_n \rightarrow 0$ a.e., 但是并不 ptwisely, 当然也并不 uniformly, 并且$\not\rightarrow 0$ in $L^1$
        
        \item "typewriter": 
构造: 我们把区间$[0,1]$划分成$n$个等长子区间, 每个子区间的长度为$\frac{1}{n}$, 令$f_n(x)$在这些子区间上交替取$1$或$0$：    
\[
   f_n(x) = 
   \begin{cases}
   1, & x \in \left[ \frac{k}{n}, \frac{k+1}{n} \right) \text{ for some even } k, \\
   0, & \text{otherwise}.
   \end{cases}
   \]
再取: \[
   g_n(x) = f_n(x) / n
   \]
有  \[
   \| g_n \|_1 = \int_0^1 g_n(x) dx = \frac{1}{2n} \to 0
   \] 因而 $g_n \rightarrow 0$ in $L^1$, 但是 $\forall x\in[0,1]$, $g_n(x)\not\rightarrow 0$ ptwisely. (也不 a.e.)
    \end{itemize}
\end{example}
在这写例子中, 我们发现, $L^1$-convergence 和 uniform, ptwise, a.e. 这三个 modes of covergence 都互不推导. 对于 uniform convergence 和 ptwise convergence, 这是很合理的, 因为可以函数越来越宽和扁使得积分不变但是却 uni conv; 也可以函数积分收敛但是在一个零测集上反复跳跃.\\

并且我们进一步发现, 就算是 a.e. 收敛, 也和 $L^1$ 收敛没有互推关系. 比如 ex (3), 这个函数只在 $0$ 处不收敛至 0, 但是整体的积分却是 const 1. \\

我们现在






\[B_{n,k} := \{  x\in X  :  | f_n(x) -f(x)| \leq \frac{1}{k}   \}\]

\[
\{ x \mid f_n(x) \rightarrow f(x) = \bigcap_{k=1}^\infty \bigcup_{N=1}^\in \bigcap_{n \geq N} B_{n,k}
 \}
\]


By Chebyshev:
\[
g \in L^1 \implies \mu(\{ |g| \geq c\}) \leq \frac{1}{c} \int |g|
\]





\begin{proposition}{"Fast" $L^1$-conv $\implies$ a.e. conv.}
\[
\sum_{j=1}^\infty \int  |f_n-f| < \infty \implies f_n\rightarrow f \;a.e.
\]
\end{proposition}

\begin{proof}
    我们取\[
\{ x \mid f_n(x) \rightarrow f(x) = \bigcap_{k=1}^\infty \bigcup_{N=1}^\in \bigcap_{n \geq N} B_{n,k}\}\] 的 complement
\[E := \bigcup_{k=1}^\infty \bigcap_{N=1}^\in \bigcup_{n \geq N} B_{n,k}^C = \{f_n \rightarrow f\}\]


By Cheb:\[ \mu(B_{n,k}^C)  \leq k \int |f_n-f|\]

因而 \[ \forall k \forall N , \mu(\bigcup_{n\geq N} B_{n,k}^C) \leq k \sum_{n=N}^\infty \int |f_n-f|  \rightarrow 0\]
 as $N\rightarrow \infty$

By CFA, \[ \mu (\bigcap_{N=1}^\infty\bigcup_{n\geq N} B_{n,k}^C)  =0\]
Thus
\[\mu(E) = 0\]
\end{proof}



\begin{corollary}
    if $f_n \rightarrow f$ in $L^1$, then there exists subseq $(f_{n_j})_{j\in \mathbb{N}}$ s.t. 
    $f_{n_j} \rightarrow f$ a.e.
\end{corollary}
\begin{proof}
    Pick $(n_j)_{j\in\mathbb{N}}$ s.t. 
    \[
    \int |f_{n_j} - f| \leq \frac{1}{j^n}
    \]
    Then \[
    \sum_{j=1}^\infty \int |f_{n_j}-f| < \infty
    \]
    由刚才的 prop 得, $f_{n_j}\rightarrow f$ a.e.
\end{proof}




我们再引入第 5 种 convergence: 
\begin{definition}{convergence in measure}
    我们称 $f_n \rightarrow f$ in measure, if $\forall \varepsilon >0$, 都有 \[
    \mu(\{|f_n-f| > \epsilon\}) \rightarrow 0
    \] as $n\rightarrow \infty$
\end{definition}

examples: (1), (3), (4) but not (2).



(此处插入convergence 关系图)




\begin{definition}
    我们称 $f_n\rightarrow f$ almost uniformly (a.u.), 如果 $\forall \varepsilon > 0$, 都存在 $E \subseteq A$ s.t. $\mu(E) < \varepsilon$ 并且    $f_n \rightarrow f$ uniformly on $E^C$
\end{definition}



\begin{theorem}{Egorov's Theorem}
\label{Egorov's Theorem}
如果 $\mu$ 是个 finite measure ($\mu(X) < \infty$), 那么 
\[
f_n \rightarrow f \;\;a.e. \;\; \Longleftrightarrow f_n \rightarrow f \;\; a.u.
\]
\end{theorem}
\begin{proof}
    a.u. $\implies$ a.e.: DIY
    a.e. $\implies$ a.u.: Fix $\varepsilon > 0$, 我们有 \[
    f_n \rightarrow f \;\; a.e. \;\; \Longleftrightarrow \;\; \mu( \bigcup_{k=1}^\infty \bigcap_{N=1}^\in \bigcup_{n \geq N} B_{n,k}^c)  = 0
    \]
    因而 \[
    \forall k, \;\; \mu( \bigcup_{k=1}^\infty \bigcap_{N=1}^\in \bigcup_{n \geq N} B_{n,k}^c) =0 
    \]
    By Ctn from Above: \[
    \forall k,\;\;  \lim_{N\rightarrow \infty} \mu(\bigcup_{n\geq N} B_{n,k}) = 0
    \]
    Then: \[
    \forall k,\;\; \exists N_k \;\;s.t. \;\;  \mu(\bigcup_{n\geq N} B_{n,k}) < \frac{\varepsilon}{2^k}
    \]
    Set\[
    E:= \bigcup_{K=1}^\infty \bigcup_{n\geq N_k} B_{n,k}^c
    \]
    Then we have: \[
    \begin{cases}
        \mu(E) < \sum_{1}^\infty \frac{\varepsilon}{2^k} = \varepsilon \\
        f_n \rightarrow f \;\;\text{unif. on } E^c = \bigcap_{k=1}^\infty \bigcap_{n\geq N_k} B_{n,k}
    \end{cases}
    \]
\end{proof}
\begin{remark}
    在 Prob Theory 中很有用, 因为 prob space 是 finite measure space.
\end{remark}

\begin{example}
    考虑 escape to hat function $f_n := \chi_{(n,n+1)}$ on $(\mathbb{R}, \mathfrak{L},m)$.\\
    $f_n \rightarrow 0$ a.e. 但是并不 a.u., 因为 $\mu(X) = \infty$.
\end{example}




\begin{theorem}{Lusin's Theorem}
\label{Lusin's Theorem}
    If $f: [a,b] \rightarrow \mathbb{C}$ 是 Leb. mble 的, 那么 $\forall \varepsilon > 0$, 都存在 $K \subseteq [a,b]$ s.t. $m(K^c) < \varepsilon$ 并且 $f|_K$ ctn.
\end{theorem}
\begin{proof}
我们知道 $C^0([a,b]) \subseteq L^1(m)$ 是 dense subset.\\
First assume $f$ bounded, then $f\in L^1(m)$, $\int|f| < \infty$.\\
Then: \[\exists (f_n)  \subseteq C^0([a,b])  \;\;s.t. \;\; f_n\rightarrow f \text{ in } L^1 \]
Pass to subseq: $f_n\rightarrow f$ a.e.\\
Then by \textbf{Egorov}: \[
\exists F \subseteq [a,b] \text{ mble } s.t. \;\; \mu(F) < \frac{\varepsilon}{2}
\]
并且 $f_n \rightarrow f$ uniformly on $F^c$.\\
By inner regu: 存在 $K \subseteq [a,b] $ cpt s.t. $K \subseteq F^c$ 并且 $n(F^c \setminus K ) < \frac{\varepsilon}{2}$
$m(K^c) < \varepsilon$ 并且 $f_n$ conv unif., so $f$ ctn.

\end{proof}




\section{summary: convergence mode relations}
\pic[0.8]{ch2-pics.assets/image-20250219190049489.png}





\chapter{product measure}




Goal: Given $(X_i, \mathcal{A}_i, \mu_i)$, construct $X = \prod X_i $, s.t. 
\[
\mu(E_1 \times E_2 )  = \mu_1(E_1) \mu_2(E_2)
\]
So that we can do Fubini (iterated integration) like that in Riemann integral.



\begin{definition}{product $\sigma$-algebra}
Suppose $(X_i, \mathcal{A}_i)$ mble, $1 \leq i\leq n$, the product $\sigma$-algebra $A_1 \otimes \cdots \otimes A_n$ on $X_1 \times \cdots \times X_n$ is the smallest $\sigma$-algebra s.t.$$ \pi_j: X_1 \times \cdots \times X_n \rightarrow X_j$$is measurable.
\end{definition}




\begin{proposition}
$$A_1 \otimes \cdots \otimes A_n = <\{  E_1\times \cdots \times E_n \mid \text{ rectangle }\in \mathcal{A}_i \times \cdots \times \mathcal{A}_n  \}>$$
\end{proposition}
\begin{proof}
    DIY. (Prop 1.14 in book).
\end{proof}




\begin{proposition}
    If $X_1,\cdots, X_n $ are metric spaces. Let $X := X_1 \times \cdots \times X_n$ (with product metric), then: $$\bigotimes_{i=1}^n \mathcal{B}_{X_i} \subseteq \mathcal{B}_X$$
and the equality holds if $X_i$ separable $\forall i$.
\end{proposition}
\begin{proof}
   $$\bigotimes_{i=1}^n \mathcal{B}_{X_i}  \overset{\text{by prop}}{=} < \{ U_1\times \cdots \times U_n  \text{ each open} \} > \subseteq\mathcal{B}_X $$
   Now let $C_i \subseteq X_i$ dense, ctbl. \\
   Set $$\mathcal{E}_i  := \{  B_r(x) \mid x\in C_i \;,\; r\in \mathbb{Q}_{>0}  \} \subseteq \mathcal{B}_{X_i} $$
   Then: every open set in $X_1 \times \cdots \times X_n$ is a ctbl union of products $B_1 \times \cdots \times B_n$, each $B_1 \in \mathcal{E}_i$.
   Then we have: $$B_X = <\{B_1 \times ...\times B_n\}> \subset \bigotimes_1^n B_{X_i}$$
\end{proof}

\begin{example}
    $$\mathcal{B}_{\mathbb{R}^n} = \mathcal{B}_{\mathbb{R}} \otimes \cdots \otimes \mathcal{B}_{\mathbb{R}}$$
\end{example}


\begin{corollary}
    if $(X,\mathcal{A})$ is a mble space, then $$f:X\rightarrow \mathbb{C}  \;\;(\mathcal{A},\mathcal{B}_{\mathbb{C}})\text{-mble } \Longleftrightarrow \re f, \im f \;\;\mathcal{A}\text{-mble}$$
\end{corollary}


   (pp 64.) Let $(X_i \,,\mathcal{A}_i\, , \mu_i)$, $1 \leq i \leq n$ be mble spaces.\\
    And let $X := X_1 \times ... \times X_n$, $\mathcal{A}:= \mathcal{A}_i \otimes \cdots \otimes \mathcal{A}_n$
Goal: 通过 Hahn-Kromolgrov 来构建 product measure on product mble space.
Idea: Let $$\mathcal{A}' := \{   \text{disjoint  unions of rectangles }\}$$
Then $\mathcal{A}' \subset \mathcal{A}$






\begin{proposition}
   $\mathcal{A}'$ is an algebra/
\end{proposition}
\begin{proof}
    Sketch:  
Step 1:
The set $\mathcal{E}:= \{\text{rectangles}\} \subseteq \mathcal{P}(X)$ satisfies:
    \begin{itemize}
        \item $\varnothing \in \mathcal{E}$
        \item $E,F \in \mathcal{E} \implies E \cap F \in \mathcal{E}$
        \item $E \in \mathcal{ E} \implies E^c \text{ is a finite disjoint union of recs}$ (画图可知)
    \end{itemize}

Step 2: $\mathcal{A}' := \{\text{finite disjoint unions of elts of } E'\} $ is an algebra, by prop 1.7


\end{proof}




\begin{proposition}
    Now define $$\mu' : \mathcal{A}' \rightarrow [0,\infty]$$ as follows: $$ \mu'(\bigsqcup_{k=1}^N E_1^{(k)} \times \cdots \times E_N^{(k)}) = \sum_{k=1}^N \prod_{i=1}^n \mu_i (E_i^{(k)}) $$
Claim:
    (1) $\mu'$ is a well-defined premeasure on $\mathcal{A}'$.
    (2) If each $\mu_i$ is $\sigma$-finite, so is $\mu'$.
\end{proposition}
\begin{proof}
    Sketch: (2) DIY.
    (1) STS(check): if $E = E_1 \times \cdots E_n$ is a finite or ctbl uniono f rects $E^{(k)} = E_1^{(k)}\times \cdots \times E_n^{(k)} $, then $$\prod_1^n  \mu_i(E_i) = \sum_k \prod_1^n \mu_i(E_i^{(k)})  $$
    Use Tonelli for sums and integrals: \begin{align}
        \prod_1^n \chi_{E_i} (x_i) &= \chi_E (x_1\,, \cdots \,,x_n) \\
        &= \sum_k \chi_{E^{(k)}} (x_1 \,, \cdots \,, x_n) \\
        &= \sum_k \prod_1^n \chi_{E_i^{(k)}} (x_i)
    \end{align}
Integrate w.r.t.  $x_1$ (check): 
\begin{align}
\mu_1(E_1) \prod_{i=1}^n \chi_{E_i} (x_i)& = \int \sum_k \prod_1^n \chi_{E_i ^{(k)}} (x_i)    \\
&\overset{\text{Tonelli}}{=}  \sum_k  \int (\prod_1^n   \chi_{E_i ^{(k)}} (x_i) )  d \, \mu_1 (x_1) \\
& = \sum_k \mu_1(E_1^{(k)}) \prod_{i=1}^n \chi_{E_i^{(k)}} (x_i)
\end{align}
And repeat for $i=2,\cdots,n$.
\end{proof}


Now use HK:
\begin{corollary}
    $\exists$ measure $\mu := \mu_1 \times \cdots \times \mu_n$ on $\mathcal{A} = \mathcal{A}_1 \otimes \cdots \mathcal{A}_n$ extending $\mu$.\\
    And if each $\mu_i $ are $\sigma$-finite, hen $\mu$ is the unique extension.
\end{corollary}


\begin{corollary}{assotiativity}
$$ \mathcal{A}_1 \otimes \mathcal{A}_2  \otimes \mathcal{A}_3 =  (\mathcal{A}_1 \otimes \mathcal{A}_2)  \otimes \mathcal{A}_3 =   \mathcal{A}_1 \otimes (\mathcal{A}_2  \otimes \mathcal{A}_3 ) $$
If $\mu_1, \mu_2,\mu_3$ are $\sigma$-finite, then: $$\mu_1 \times \mu_2 \times \mu_3 = (\mu_1 \times \mu_2) \times \mu_3  = \mu_1 \times (\mu_2 \times \mu_3 )$$
\end{corollary}

\begin{proof}
    DIY.a
\end{proof}

\begin{definition}{product measures}
    (pp 64.) Let $(X_i \,,\mathcal{A}_i\, , \mu_i)$, $1 \leq i \leq n$ be mble spaces.\\
    And let $X := X_1 \times ... \times X_n$, $\mathcal{A}:= \mathcal{A}_i \otimes \cdots \otimes \mathcal{A}_n$

    
\end{definition}



\chapter{Tonelli's Thm}

We focus on the case $n=2$: $(X,\mathcal{A}, \mu)$, $(Y, \mathcal{B}, \nu)$

\begin{definition}
    Given $E \subset X \times Y$, $x \in X$, $y\in Y$, we define:
\[E_x : = \{  y\in Y \mid (x,y) \in E \}\]
\[
E^y := \{x\in X \mid (x,y) \in Y  \}
\]
\end{definition}


\begin{example}
    $E = A \times B $, $A \in \mathcal{A}, B \in \mathcal{B}$
    $E_x = \begin{cases}
        \varnothing ,\quad x\not\in A \\
        B ,\quad x\in A
    \end{cases}$


GIven $f: X \times Y \to \mathbb{C}$
$f_x(y) =  f(x,y) = f^y(x)$


$f = \chi_E, E \subset X \times Y$
$f_x = \chi_{E_x}$, $f^y = \chi_{E^y}$
\end{example}



\begin{proposition}
    $E \in \mathcal{A} \otimes \mathcal{B} \implies \begin{cases}
        E_x \subset \mathcal{B},\quad \forall x \in X\\
        E^y \in \mathcal{A}\quad, \forall y \in Y
    \end{cases}$

    $f$ is $\mathcal{A} \otimes \mathcal{B}$-measurable $\implies \begin{cases}
        f_x, \quad \mathcal{B}\text{-measurable} \;\;\forall x \\
         f^y, \quad \mathcal{A}\text{-measurable} \;\;\forall y
    \end{cases}$ \\
\end{proposition}


\begin{proof}
    (a) Let $\mathcal{E}:= \{    E \subset X \times Y \mid \text{ (a) holds for } E  \}$
Claim: $\mathcal{E}$ contains rectangles and $\mathcal{E}$ a $\sigma$-algebra.\\
thus $\mathcal{A} \otimes \mathcal{B} \subset \mathcal{E}$

(a) $\implies$ (b): $f_x^{-1} (V) = (f^{-1}(V) )_x$
    Similar for $f_y$
\end{proof}





\begin{definition}{monotone class}
Given a set $X$, a collection $C \subset \mathcal{P}(X)$ is called a monotone class, if it is closed under countable increasing unions and countable decreasing intersections
\end{definition}
For sure, a $\sigma$-algebra is a monotone class


\begin{lemma}{monotone class lemma}
    If $\mathcal{A} \subset \mathcal{P}(X)$ is an algebra, then $<\mathcal{A>}$ is the smallest monotone class $C$ containing $\mathcal{A}$.
\end{lemma}
\begin{proof}
    $C \subset <\mathcal{A}>$ is trivial.\\
    $<\mathcal{A} \subset C$: see p.66
\end{proof}






\begin{theorem}{Tounelli for sets}
Let $(X,\mathcal{A}, \mu)$, $(Y, \mathcal{B}, \nu)$, each $\sigma$-finite.\\
Take $E \in \mathcal{A} \otimes \mathcal{B}$. Then: 
(1) $x \mapsto \nu(E_x)$, $y \mapsto \mu(E_y)$ are measurable

(2) \[
\mu_x \nu(E) = \int \nu(E_x)  \; d\mu(x) = \int \mu(E^y) \; d \nu(y)
\]
    
\end{theorem}
\begin{proof}
    $C = \{ E \subset X \times Y \mid \text{ (1),(2) holds}\}$
    Step 1: $C$ contains rectangles
    Step 2: $C$ contains finite unions of rectangles  (is an algebra)
  By the MC class lemma, Suffices to show $C$ is a monotone class.

  Step 2: Take $E_1 \subset E_2 \subset \cdots $ s.t. $E = \bigcup_{n=1}^\infty E_n$
$f_n(y) := \mu((E_n)^y)$
$f_n \nearrow f(y) := \mu()(E)^y$
then MCT.\\
Step 3: Case $\mu,\nu$ finite measure: $E_1 \subset$
\end{proof}




\begin{theorem}{Tounelli for sets}
 Let $(X,\mathcal{A}, \mu)$, $(Y, \mathcal{B}, \nu)$, each $\sigma$-finite.\\
Take $E \in \mathcal{A} \otimes \mathcal{B}$. Then: 
(a) 
\end{theorem}
















\chapter{Fubini's Theorem and Lebesgue integral in $\mathbb{R}^n$}
recall Tonelli's Theorem: Given $f \in L^+(X \times Y)$, set $g(x) := \int f_x d\nu $, $h(y) := \int f^y d \mu$. 
Then $g \in L^+(X)$, $h \in L^+(Y)$, 以及有: \[
\int f \; d(\mu \times \nu) = \int g \; d \mu = \int h \; d\nu
\]
展开后可写作: \[
\int f \; d(\mu \times \nu)  = \iint  f(x,y) \; d\nu(y) d\mu(x) = \iint f(x,y) \; d\mu(x) d\nu(y)
\]更加简洁可写作: \[
\int f \; d(\mu \times \nu) = \int f \; d\nu d\mu  = \int f \; d\mu d\nu
\]

\begin{corollary}
    if $f \in L^1(X\times Y)$ and $f \geq 0$ then 
    \begin{itemize}
        \item     $g(x) < \infty$ for a.e. $x$
        \item $h(x) < \infty$ for a.e. $y$
    \end{itemize}
\end{corollary}


Now do $\mathbb{C}$-valued version:





\begin{theorem}{Fubini's Theorem}
    If $f \in L^1(\mu \times \nu)$, 
    \begin{itemize}
        \item $f_x \in L^1(\nu)$ for a.e. $x$, $f^y \in L^1(\mu)$ for a.e. y
        \item The a.e. defined functions: \[ g(x) := \int f_x \;d\nu \in L^1(\mu),\quad h(x) := \int f^y \;d\nu \in L^1(\nu) \]
        \item \[ \int f \; d(\mu \times \nu)  = \int g \; d\mu = \int h \; d\nu \]
    \end{itemize}
\end{theorem}
\begin{proof}
\(f = \Re f + i \Im f \), so WLOG can assume $f$ is $\mathbb{R}$-valued.\\
又 $f = f^+ - f^-$, 直接 apply Tonellis's Thm 可得.
\end{proof}



\begin{example}
    $(X, \mathcal{A}, \mu) = (Y , \mathcal{B}, \nu) = (\mathbb{N}, \mathcal{P}(\mathbb{N}), \mu_{counting})$
if $a_{mn} \in \mathbb{C}$ for $(m,n) \in \mathbb{N}^2$ and \[
\infty > \sum_{m,n} |a_{mn}| =: \sup_{F \subset \mathbb{N}^2  \text{finite}} \sum_{(m,n) \in F}  |a_{m,n}|
\]
Thm: $\sum_m a_{mn}$ conv absly to $b_n \in \mathbb{C}$, for all $n$
$\sum_n a_{mn}$ conv absly to $c_m \in \mathbb{C}$, for all $m$
以及 $\sum_n b_n, \sum_m c_m$ conv absly to $\sum_{m,n} a_{mn}$
\end{example}



Now suppose \((X, \mathcal{A}, \mu)\), $ (Y , \mathcal{B}, \nu)$ complete. Then \((X\times Y , \mathcal{A} \otimes \mathcal{B} , \mu\times \nu  )\) \textbf{may not be complete!}

\begin{example}
      考虑 $(X, \mathcal{A}, \mu) = (Y , \mathcal{B}, \nu) = (\mathbb{R}, \mathcal{L}, m)$
       考虑一个 Vitali set. \[
       V \times \{0\} \subset \mathbb{R} \times \{0\} \text{ is a subnull set, not measurable}
       \]
\end{example}



Now consider completion: \[
(X \times Y , \overline{\mathcal{A} \otimes \mathcal{B}},  \overline{\mu \times \nu}   ) 
\]



\begin{theorem}{complete Fubini-Tonelli}
 consider completion of a product measure space: \[
(X \times Y , \overline{\mathcal{A} \otimes \mathcal{B}},  \overline{\mu \times \nu}   ) 
\]
我们将 $\overline{\mathcal{A} \otimes \mathcal{B}}$ 简易写作 $\mathcal{L}$, $\overline{\mu \times \nu}   $ 简易写作 $\lambda$.\\
Suppose $f: X \times Y \to \mathbb{C}$ is $\mathcal{L}$-measurable 并且 either: 

$f \geq 0$ or $f \in L^1(\lambda)$, then: 
\begin{itemize}
    \item 
\end{itemize}

    
\end{theorem}



\section{Lebesgue measure in $\mathbb{R}^n$}

\begin{definition}
    $(\mathbb{R}^n, \mathcal{L}^n, m^n)$ Lebesgue measure is \textbf{completion of } $(\mathbb{R}^n, \mathcal{B}_{\mathbb{R}^n}, m^n)$. 
\end{definition}
where $ \mathcal{B}_{\mathbb{R}^n} =  \mathcal{B}_{\mathbb{R}} \otimes \cdots \otimes \mathcal{B}_{\mathbb{R}}  $
\(\mathcal{L^n }  = \{ \text{Leb meas sets} \}  \supset  \mathcal{B}_{\mathbb{R}^n}\)
Write: \[  \int f \;d m^n   \quad 
\]


\begin{theorem}{Fubini-Tonelli for $m^n$}
    Suppose $f \in L^+(\mathbb{R}^n)$ or $L^1(\mathbb{R}^n)$
\begin{align}
\int f \; dm &= \int \cdots \int f(x_1, \cdots, x_n) 
\; dx_1 \cdots dx_n        \\
& = \int \cdots \int f(x_1, \cdots, x_n) 
\; dx_n \cdots dx_1
\end{align}
\end{theorem}

\begin{example}
    Show: \[
    \int_0^\infty e^{-sx} \frac{\sin^2(x)}{x} \; dx = \frac{1}{4} \log(1+ 4s^{-2})
    \]
for $s > 0$, by integrating $e^{-sx} \sin 2xy = f(x,y)$ over the rectangle $x \in (0,\infty), y \in (0,1)$.\\
Sketch: $f \in L^1$ (since it is ctn on $\mathbb{R}$)
以及 \[
|f| \leq e^{-sx}, \quad \int_{\mathbb{R}} e^{-sx} < \infty
\]
可计算得 \[
\int_0 ^1 \sin 2xy \; dy = \frac{1}{2x} \sin^2 x
\]
而后 compute \[
\int_0 ^1    e^{-sx} \sin 2xy \; dy
\] by integration by part for twice.
\end{example}




\chapter{Lebesgue measure in $\mathbb{R}^n$}
今日: Lebesgue measure in $\mathbb{R}^n$ 的 \begin{itemize}
    \item regularity
    \item behavior under affine transformation
    \item behavior under diffeomorphism
\end{itemize}



\begin{theorem}{regularities of $\mathcal{L}^n$}
If $E \subset \mathcal{L}^n$, 则有: 
\begin{itemize}
    \item \textbf{outer regularity}: \[ m(E) = \inf \{  m(U) \mid U  \text{ open}   \supset E\}  \]
    \item \textbf{inner regularity}: \[ m(E) = \inf \{  m(K) \mid K  \text{ compact}   \subset E\}  \]
    \item if $m(E) < \infty$, 则对于任意 $\epsilon > 0$, 都存在 disjoint rectangles $R_1, \cdots R_N$ with sides that are open intervals (literally rectangles) s.t. \[ m(E  \Delta \bigcup_{j} R_j ) < \epsilon \]
\end{itemize}
\end{theorem}
\begin{proof}
 \textbf{   for (a,b) i.e. regularities: }\\
 Fix $\epsilon > 0 $. By construction, 存在 finite disjoint union of rectangle $T_j$ for each $j$, 使得 \[
 E \subset \bigcup_{j=1}^\infty T_j \quad \text{ and } \quad \sum_{j=1}^\infty m(T_j) \leq m(E) + \epsilon
 \]
By outer regularity of $m^1$, 存在 $U_j \supset T_j$ open rect s.t. $m(U_j) \leq m(T_j) + \epsilon / 2^j$
Then: \[
E \subset U := \bigcup_{j=1}^\infty U_j \quad \text{and} \quad m(U) \leq \sum_{j=1}^\infty m(U_j)
\]
Construct $K$ as in dim $1$ (DIY) $\leq m(E) + 2\epsilon$
\end{proof}
\begin{proof}
 \textbf{   for (b):} \\
Notation as above.\\
\[
m(E) < \infty \implies m(U) < \infty \implies m(U_j)  < \infty \;\; \; \forall j
\]
Sides of $U_j$ are disjoint union of ctbly many open finite intervals.\\
因而存在 open rectangle $V_j \subset U_j$ for each $j$ that are finite disjoint union of finite open intervals s.t. \[
m(U_j  \setminus   V_j) < \epsilon / 2^j
\]
Now pick $R_1, \cdots, R_N$ from honest rectangles insides $V_j$ (DIY).
\end{proof}




\begin{corollary}
For $f \in L^1(m)$, 
    if $f \in L^1 (m)$ and $\epsilon > 0$ then \begin{itemize}
        \item 对于任意 $\epsilon>0$, 都存在 $\phi = \sum_{j=1}^N c_j \chi_{R_j} $ s.t. \[\int |\phi - f|\; dm < \epsilon  \]其中 each $c_j \in \mathbb{C}$, $R_j$ 是 rectangles with sides as finite open intervals.
        \item 存在 $\phi \in C_c^0(\mathbb{R}^n)$ s.t. \[\int |f - \phi| \; dm < \epsilon \]
    \end{itemize}
\end{corollary}





\section{behavior under affine transformation}
Affine transformation 即 linear transformation + translation
对于 $a \in \mathbb{R}^n$, 一个 translation $t: \mathbb{R}^n \to \mathbb{R}^n, x \mapsto x+ a$ 是 ctn 的并且 \[
t_a^{-1} = t_{-a}
\]

\begin{theorem}
(a) for any $a \in \mathbb{R}^n$, 
\[
E \in \mathcal{L}^n \implies  t_a(E) \in \mathcal{L}^n \quad \text{ and }\quad m(t_a(E)) = m(E)
\]

(b) if $f: \mathbb{R}^n \to \mathbb{C}$ is Leb measurable, then so is $f \circ t_a$. \\
More, if $f \in L^+$ or $f \in L^1$, then $f \circ t_a \in L^1$ 并且  \[
\int (f \circ t_a) \; dm = \int f \; dm
\]
\end{theorem}
\begin{proof}
    (Folland 2.42)\\
    (a)
    $t_a $ ctn $\implies$ $t_a(\mathcal{B}_{\mathbb{R}^n}) \subset \mathcal{B}_{\mathbb{R}^n}$, 因而  $t_a(\mathcal{B}_{\mathbb{R}^n})=\mathcal{B}_{\mathbb{R}^n}$
    $E$ rectangle, so $E = E_1 \times \cdots \times E_n $, each in $\mathcal{B}_\mathbb{R}$
    $m(E) = \prod_1^n m(E_i)$, $t_a(E) = \prod t_{a_i} (E_i)$ 
    因而  \[
    m(t_a(E)) = \prod m(t_{a_i} (E_i)) = \prod m(E_i) \subset m(E)
    \]
    BY HK uniqueness, get \[
    m(t_a(E)) = m(E) \quad \forall E \in \mathcal{B}_{\mathbb{R}^n}
    \]
    if $N \subset \mathbb{R}^n$ subnull set, so is $t_a(N)$. 因而 \[
    m(t_a(E)) = m(E) \quad \forall E \in \mathcal{L}^n 
    \]
    (b) Pick $B \in \mathcal{B}_\mathbb{C} \implies f^{-1}(B) \in \mathcal{L}$.
    因而 $f^{-1}(B) = E \cup N$, $E \in \mathcal{B}_{\mathbb{R}^n}$, $N$ null set
    因而 \begin{align}
        (f\circ t_a)^{-1}(B) & = t_a^{-1}( f^{-1}(B)) \\&= t_a^{-1}(E) \cup t_a^{-1}(N) \text{ (one Borel, one null)} \\
        &= t_{-a}(f^{-1}(B)
    \end{align}
(c) Prove $\int f \; dm = \int f \circ t_a \;d m$ in steps: \begin{itemize}
    \item $f = \chi_E$
    \item $f$ is simple 
    \item $f \in L^+$
    \item $F \in L^1$
\end{itemize}    
\end{proof}





\begin{theorem}
For $T: \mathbb{R}^n \to \mathbb{R}^n$ linear. 
(a) \[ E \in \mathcal{L}^n  \implies T(E) \in \mathcal{L}^n  \quad \text{and}\quad    m(T(E)) = |\det T| m(E)  \]
(b) if $T \in GL(n,\mathbb{R})$ (即可逆), 且 $f: \mathbb{R}^n \to \mathbb{C}$ is Lebesgue measurable, then so is $f \circ T$.\\
Moreover if $f \in L^+$ or $f \in L^1$, then $f \circ T \in L^+$, $f \circ T \in L^1$ respectively. And \[
  \int f \; dm = |\det T| \int f \circ T \; dm
\]
\end{theorem}

\begin{proof}
    Stetch: need this lemma: \begin{lemma}{row reduction}
        Can write $T$ as a finite product, each factor of which is of one of the following forms: 
    \end{lemma}
\end{proof}










\end{document}