\documentclass[lang=cn,11pt]{elegantbook}
\usepackage[utf8]{inputenc}
\usepackage[UTF8]{ctex}
\usepackage{amsmath}%
\usepackage{amssymb}%
\usepackage{graphicx}
\usepackage{xcolor}

\title{597 Homeworks}

\begin{document}
\frontmatter
\tableofcontents
\mainmatter



\chapter*{hw 0}

\noindent (Not graded.) Read Sections 0.1-0.3 and 0.5-0.6 in Folland’s book. Note: I expect you to have seen much but not necessarily all of this material in earlier courses. It is not necessary to know everything by heart right now. However, in order to succeed in the class, you need to be able to read mathematical material at this level of abstraction and (lack of) detail.

\section{Approaching 597}
Let $A$ be an infinite (not necessarily countable) set, and $f : A \to \mathbb{R}$ a function. Suppose that for every integer $N \geq 1$ there exist finite subsets $A^+_N \subset A$ and $A^-_N \subset A$ such that:
\begin{itemize}
    \item (i) $\lvert f(\alpha) \rvert \leq N^{-1}$ for all $\alpha \in A \setminus (A^+_N \cup A^-_N)$;
    \item (ii) $\sum_{\alpha \in A^+_N} f(\alpha) \geq N$;
    \item (iii) $\sum_{\alpha \in A^-_N} f(\alpha) \leq -N$.
\end{itemize}
Prove that for any $N \geq 1$, there exists a finite subset $B_N \subset A$ such that
\[
\left\lvert 597 - \sum_{\alpha \in B_N} f(\alpha) \right\rvert \leq \frac{1}{N}.
\]

\begin{proof}
We first take $A_N = A_N^+ \bigcup A_N^- \subset A$  s.t.   $\lvert f(\alpha) \rvert \leq N^{-1}$ for all $\alpha \in A \setminus A_N$, as given by the conditions.\\
Now we define $pos(A_N) := \{ \alpha \in A_N \mid f(\alpha) \geq 0 \}$ and $neg(A_N) := \{ \alpha \in A_N \mid f(\alpha) < 0 \}$.\\
Let $gap := \ds \sum_{\alpha \in A_N} f(\alpha) - 597$. This is a real number since $A_N$ is finite.\\\\
Case 1: if $gap<0$, then we need to fill in more elements whose image under $f$ sum up to be positive to make the sum close to 597 from below. \\ 
We then take a finite set $B_N^+ \subset A$ s.t. $\ds \sum_{\alpha \in B_N^+} f(\alpha) \geq \lceil -gap + \sum_{\alpha \in pos(A_N)} f(\alpha) \rceil$.\\
Since $B_N^+ \bigcap A_N \subset A_N$, we have 
\begin{equation}
  \sum_{\alpha \in B_N^+ \bigcap A_N} f(\alpha) \leq \sum_{\alpha \in pos(A_N)} f(\alpha)  
\end{equation}
and since $B_N^+ = (B_N^+ \setminus A_N) \coprod (B_N^+ \bigcap A_N)$, we have
\begin{equation}
    \sum_{\alpha \in B_N^+} f(\alpha)= \sum_{\alpha \in B_N^+ \setminus A_N} f(\alpha) + \sum_{\alpha \in B_N^+ \bigcap A_N} f(\alpha)
\end{equation}
By (1) and (2), it is clear that 
\begin{equation}
 \sum_{\alpha \in B_N^+ \setminus A_N} f(\alpha) \geq -gap 
\end{equation}
(3) means that the elements in $B_N^+ \setminus A_N$ have big enough image sum to fill the gap.
And by definition, for all $\alpha \in B_N^+ \setminus A_N$, we have $|f(\alpha)|\leq {1\over N}$. This means that each element in this finite $B_N^+ \setminus A_N$ takes up only a small portion of the sum, bounded by $1/N$.
Together with (3), it follows that there is some subset $B_N' \subset B_N^+ \setminus A_N$ s.t. $\sum_{\alpha \in B_N'} f(\alpha) \in [-gap-1/N, -gap+1/N]$. So for the finite set $A_N \bigcup B_N'$, we have 
\begin{equation}
    \sum_{\alpha \in A_N \bigcup B_N'}f(\alpha) = \sum_{\alpha \in A_N}f(\alpha) + \sum_{\alpha \in  B_N'}f(\alpha) \in [597-1/N, 597+1/N]
\end{equation}
\pic[0.3]{assets/hw0(1).png}
Case 2: if $gap>0$, then we need to fill in more elements whose image under $f$ sum up to be negative to make the sum close to 597 from above.
\\ We then take finite $B_N^- \subset A$ s.t. $\ds \sum_{\alpha \in B_N^-} f(\alpha) \leq \lfloor -gap + \sum_{\alpha \in neg(A_N)} f(\alpha) \rceil$.\\
For the same reason as case 1, we get 
\begin{equation}
     \sum_{\alpha \in B_N^- \setminus A_N} f(\alpha) \leq -gap 
\end{equation}
And by definition, for all $\alpha \in B_N^- \setminus A_N$, we have $|f(\alpha)|\leq {1\over N}$. Together with (5), it follows that there is some subset $B_N' \subset B_N^- \setminus A_N$ s.t. $\ds \sum_{\alpha \in B_N'} f(\alpha) \in [-gap-1/N, -gap+1/N]$. So for the finite set $A_N \bigcup B_N'$, we have 
\begin{equation}
    \sum_{\alpha \in A_N \bigcup B_N'}f(\alpha) = \sum_{\alpha \in A_N}f(\alpha) + \sum_{\alpha \in  B_N'}f(\alpha) \in [597-1/N, 597+1/N]
\end{equation}\\
Case 3: $gap = 0$, then we are done.\\
This finishes the proof of the statement.
\end{proof}
\begin{remark}
    意思是说 $f$ 对于任意小的 bound 都存在一个 infinite set 上能够限于这一 bound 内(可逼近 0), 而在一个 finite set 上总和可以任意大. 要证明的是对于任意一个数, 我们都可以指定一个 finite set, 让这个函数在这个 finite set 上的总和无限接近这个数. 这里以 597 为例. 对于这个 bounded 的 infinite set, 我们简称它为 big flat set, 其补集称之为 small wavy set.\\\\
    这题思考甚久. 一开始卡住的原因就是局限于这个 big flat set 的 sum postive 和 sum negative 这两个划分上, 因为这占了条件中很大一部分笔墨. 但是最后却发现实际上这个集合在第一步构造中并没有用, 甚至作用一直都不大, 只用一边即可. 并且, 这两个条件不仅是透明条件, 而且我们甚至应该构建自己的 "all positive" 和 "all negative" set.\\\\
    为什么说这个 sum postive 和 sum negative 划分几乎没用: 因为它基本不给出任何 invariant 的信息. 举例: sum postive set 的 image sum $\geq 100$, sum negative set 的 image sum $\leq -100$, 它们交的部分, 其可能的 image sum 上下都可以 unboundly large, 可以是 99999, 唯一能 imply 的信息是两边 $A_N+ \setminus A_N^-$ 和 $A_N- \setminus A_N^+$ 之间的差距大于等于 200, 但是这也没用, 因为我们对元素个数也没有 control over.因而我们想要准确地逼近一个数, 必须要靠外界的大小全都 singly bounded 的元素.\\\\
    于是关键的解题点在于: small wavy set 的有限性, 所以我们可以把它的值设做 $gap$, 并可以把它分为全正和全负的两个 portion. 这样的目的是: 我们等于给 $\mathcal{P}(A)$ 中每个集合赋予了一个 measure, 等于 image sum under $f$, 而局限在 small wavy set 上, 这个 measure 最小的集合就是 all negative set, 最大的集合就是 all positive set. 从而, 我们先比较 $gap$ 和 597 的大小, 根据其正负, 制定一个 (差值 $\pm$ allPos/Neg set 的 function measure) 的 bound, 并创造第二个 big wavy set $B_N$. 这个 $B_N$ 和 $A_N$ 可能相交, 但是这一次, 我们可以 control over $B_N \setminus A_N$ 的部分, 因为这部分的值必须大于 $gap$ 和 597 的差值, 并且这个部分还属于 $A_N$ 外的 big flat set, 其中每个元素的函数值都是 bounded by a small number 的. 
\end{remark}


\section{Limsup and Liminf}
Let $X$ be a nonempty set, and $A, B$ subsets of $X$. Define a sequence $(E_n)_{n=1}^\infty$ of subsets of $X$ by
\[
E_n = 
\begin{cases} 
A & \text{if } n \text{ is a prime number,} \\
B & \text{otherwise.}
\end{cases}
\]
Characterize the sets $\limsup E_n$ and $\liminf E_n$ (see §0.1 in Folland for notation).
\begin{solution}
By definition, 
    $$
    \limsup (E_n)  = \bigcap_{k = 1}^\infty \bigcup_{n=k}^\infty E_n
    $$
For each $k \in \mathbb{N}$, there are infinitely many $n \geq k$ such that $n$ is prime, and also there are infinitely many $n \geq k$ such that $n$ is not prime. So $ \bigcup_{n=k}^\infty E_n = A \bigcup B$.
Therefore
$$
\limsup (E_n)  = \bigcap_{k = 1}^\infty (A\bigcup B) = A\bigcup B
$$
By definition, 
    $$
    \liminf (E_n)  = \bigcup_{k = 1}^\infty \bigcap_{n=k}^\infty E_n
    $$
For each $k \in \mathbb{N}$, there are infinitely many $n \geq k$ such that $n$ is prime, and also there are infinitely many $n \geq k$ such that $n$ is not prime. So $ \bigcap_{n=k}^\infty E_n = A \bigcap B$.
Therefore
$$
\liminf (E_n)  = \bigcup_{k = 1}^\infty (A\bigcap B) = A\bigcap B
$$

\end{solution}




\section{Polynomial Convergence}
Let $f : \mathbb{Z}_{\geq 0} \times \mathbb{Z}_{\geq 0} \to \mathbb{R}$ be a function with the property that for every polynomial
\[
p(x) = x^d + a_1 x^{d-1} + \cdots + a_d
\]
with integer coefficients, we have that
\[
\lim_{n \to \infty} f(n, p(n)) = \lim_{n \to \infty} f(p(n), n) = 0.
\]
Does it follow that $f(m,n) \to 0$ as $m, n \to \infty$? In other words, given $\epsilon > 0$, does there exist $N \geq 0$ such that $\lvert f(m,n) \rvert < \epsilon$ whenever $\lvert m \rvert, \lvert n \rvert \geq N$? Give a proof or a counterexample.

\begin{solution}
    Consider this function:
    $$
    f(m,n) =
\begin{cases} 
1, \;\; \text{if } m = 2^n \\ 
0, \;\; \text{otherwise} 
\end{cases}
$$
Let \textbf{$p$ be arbitrary polynomial with integer coefficients.} Then there must be at most finite $n$ such that $p(n) = 2^n$. This is guaranteed by the asymptotic behavior of polynomial and exponential function: $\lim_{n\to \infty} \frac{p(n)}{2^n} = 0$. So there exists some $N \in \mathbb{N}$ s.t. $\frac{p(n)}{2^n} < 1/2$ for all $n \geq N$, therefore \textbf{$f(p(n), n)$ is eventually 0}.\\
Also, there must be at most finite $n$ such that $2^{p(n)} = n$, i.e. $p(n) = \log_2 n$. This is guaranteed by the asymptotic behavior of polynomial and logarithmic function: $\lim_{n\to \infty} \frac{\log_2 n}{p(n)} = 0$. So there exists some $N \in \mathbb{N}$ s.t. $\frac{\log_2 n}{p(n)} < 1/2$ for all $n \geq N$, therefore \textbf{$f(n, p(n))$ is eventually 0}.\\
This confirms that $\lim_{n \to \infty} f(n, p(n)) = \lim_{n \to \infty} f(p(n), n) = 0$ for any polynomial $p$ with integer coefficients.\\
Then we consider the sequence $((2^n,n))_{n\in \mathbb{N}}$. For any $n\in\mathbb{N}$, $f((2^n,n))=1$, so the sequential limit is $1$. This completes the counterexample.
\pic[0.3]{assets/hw0(3).jpeg}
\end{solution}

\begin{remark}
    $f$ 是一个二元 input 的函数, 其满足, 将任何一个 polynomial 函数的 graph input 进入, limit behavior 都会趋近于 0.\\ 这个表现乍看很雾. 所以不如试一试: identity polynomial 和 trivial polynomial. 得到 $\lim_{n \rightarrow \infty} f(1,n) = \lim_{n \rightarrow \infty} f(n,1) = 0$, 以及 $\lim_{n \rightarrow \infty} f(n,n) = 0$, 以及可想折中的情况: 这两个 input 的增长速度是 polynoimial relation 的情况下(一个是 $n$, 一个是 $p(n)$)也是趋近于 0 的, 这个表现像是这个函数在两个 input 各自以任意速度增长时 converge to 0.\\\\
    但是直觉告诉我们这个 polynomial 关系的增长速度不能代表增长速度差距更大的情况, 比如 exponential.遂想到解题点: 这个 limit behavior, 针对的是任意 polynomial, 但是是随意选择一个固定的 polynomial 之后, 才在这个固定的 polynomial 上有这个行为.\\\\
    Then we think about: 一个在 exponential graph as input 上一直得到固定值, 在其他 input 上都得到 0 的函数. 从而对于这个 exponential graph input 的 seq, 函数的 limit behavior 是一个固定值; 而对于任意的 polynomial, 函数的 limit behavior 都是 0，因为任意 polynomial 函数, 和一个 exponential 函数至多有有限个重合点, asymptotic 增长速度不同.\\\\
    (PS: 笔者在思考构造时想到过一个很 silly 的问题: 对于任意两个整数 $x,y$，是否都存在一个无常数项的整系数 polynomial 使得 $p(x) = y$? 答:很显然不是. 回忆小学数学: 我们只要选择和 $x$ 没有 common factor 的 $y$ 即可得反.)
\end{remark}




\chapter{on $\sigma$-algebra (39/40)}

\section{Borel vs Open}
Let $X$ be a metric space such that every subset of $X$ is Borel set. Does it follow that every subset of $X$ is open? Give a proof or a counterexample.
\begin{solution}
    It is not true.\\
    Every subset of $X$ is Borel set $\Leftrightarrow \mathcal{P}(X) \subset \mathcal{B}_X$. And We know $\mathcal{B}_X \subset \mathcal{P}(X)$, so it is equivalent to saying that $\mathcal{B}_X = \mathcal{P}(X)$.\\
    So consider this counterexample: $\mathbb{Q}$ with the Euclidean metric.\\
    Claim: every singleton set in $\mathbb{Q}$ is closed, thus in $\mathcal{B}_\mathbb{Q}$.
    This is because this only sequence in a singleton set is the point itself repeating, thus converging to itself, in the singleton set. This proves the claim.\\
    And since $\mathbb{Q}$ is countable, every subset of $\mathbb{Q}$ is a countable union of singleton sets, thus by property of $\sigma$-algebra, every subset of $\mathbb{Q}$ is in $\mathcal{B}_{\mathbb{Q}}$. Thus: $$
    \mathcal{B}_\mathbb{Q} = \mathcal{P}(\mathbb{Q})
    $$
    But clearly, \textbf{not every subset in $\mathbb{Q}$ is open.} Consider any singleton set, $\{1\}$ as an example. Any open ball centered at $1$ is not contained in $\{1\}$, thus contradicting the statement.
    
\end{solution}

\section{Restriction of a $\sigma$-algebra to a Subset}
Let $X$ be a set, and $Y \subset X$ a subset.
\begin{itemize}
    \item[(a)] Given a $\sigma$-algebra $\mathcal{A}$ on $X$, prove that
    \[
    \mathcal{A}|_Y := \{E \cap Y \mid E \in \mathcal{A}\}
    \]
    is a $\sigma$-algebra on $Y$.
    \item[(b)] Given a $\sigma$-algebra $\mathcal{B}$ on $Y$, prove that there exists a $\sigma$-algebra $\mathcal{A}$ on $X$ such that $\mathcal{A}|_Y = \mathcal{B}$.
    \item[(c)] Is the $\sigma$-algebra $\mathcal{A}$ in (b) unique? Give a proof or a counterexample.
\end{itemize}
\begin{remark}
这表示任何一个 measurable space 都可以对其中的一个 subspace 取一个 submeasurable space
\end{remark}

\begin{proof}
    \begin{itemize}
    \item[(a)] 
    \begin{enumerate}
        \item Since $\emptyset \in\mathcal{A}$, $\emptyset \cap Y = \emptyset$, we have $\emptyset \in\mathcal{A}|_{Y}$
        \item Let $F \in \mathcal{A}|_{Y}$, we must have $E \in \mathcal{A}$ s.t. $E\cap Y = F$. Since $E\in \mathcal{A}$, we have $X\setminus E \in \mathcal{A}$, so $X \setminus E \cap Y \in \mathcal{A}|_{Y}$. Since $E \cap Y = F$ and $Y = (E \cap Y) \sqcup ((X \setminus E) \cap Y)$, it implies $(X \setminus E) \cap Y = Y\setminus F$, therefore $Y \setminus F \in \mathcal{A}|_{Y}$.
        \item Let $F_1, F_2,\cdots$ be a sequence of subsets in $\mathcal{A}|_{Y}$. Then for each $i\in \mathbb{N}$, we have $F_i = E_i \cap Y$ for some $E_i \in \mathcal{A}$. Then $\bigcup_{i=1}^\infty F_i = \bigcup_{i=1}^\infty (E_i\cap Y) = (\bigcup_{i=1}^\infty E_i) \cap Y \in \mathcal{A}|_{Y}$ since $\bigcup_{i=1}^\infty E_i \in \mathcal{A}$. 
    \end{enumerate}
    
    \item[(b)] Let $\mathcal{B}$ be a $\sigma$-algebra on $Y$.
    
    
    prove that there exists a $\sigma$-algebra $\mathcal{A}$ on $X$ such that $\mathcal{A}|_Y = \mathcal{B}$.
    Consider let 
    $$
    \mathcal{A} := \{\,E \subset X \mid E \cap Y \in \mathcal{B}\}
    $$
    Then 
    $$
    \mathcal{A} |_{Y} = \{ E \cap Y \mid E,Y\subset X,E \cap Y \in \mathcal{B}  \} = \mathcal{B}
    $$            
    We then prove that this is a $\sigma$-algebra on $X$. \\
    \begin{enumerate}
        \item  $\emptyset \cap Y = \emptyset$ so $\emptyset \in \mathcal{A}$. 
        \item \textbf{Closed under complement}: Let $E \in \mathcal{A}$, we have $E \cap Y \in \mathcal{B}$, so $Y \setminus (E\cap Y ) = Y\setminus E \in \mathcal{B}$.\\
        Then $(X\setminus E) \cap Y  = Y \setminus E 
        \in \mathcal{B}$, so $X\setminus E \in \mathcal{A}$. 
        \item \textbf{Closed under countable union}: Let $E_1,E_2,\cdots$ be a sequence in $\mathcal{A}$, then \(E_n \cap Y \in \mathcal{B}\). for each $n$. 
        Hence
     \[
       \left(\bigcup_{n=1}^\infty E_n\right) \cap Y
       \;=\; \bigcup_{n=1}^\infty (E_n \cap Y)
       \;\in\; \mathcal{B},
     \]
     since \(\mathcal{B}\) is a \(\sigma\)-algebra on \(Y\).  Therefore, \(\bigcup_{n=1}^\infty E_n \in \mathcal{A}\).  
     
    \end{enumerate}

    
    \item[(c)] 
    This is not unique. \\
    \noindent Counterexample:
    \[
    X = \{ 0,1,2\}, Y = \{0\} \subset X
    \]
    Consider
    \[
    A_1 := \mathcal{P}(X), A_2 := \{\emptyset, \{0\}, \{1,2\}, X \}
    \] are valid $\sigma$-algebra on $X$.\\
    \noindent Then we have $A_1 |_Y = A_2 |_Y = \{\emptyset,\{0\}   \}$, while $A_1$ is different from $A_2$.


    
    
\end{itemize}
\end{proof}


\section{Invariance Properties of the Borel $\sigma$-algebra on $\mathbb{R}^n$}
\begin{itemize}
    \item[(a)] Prove that $\mathcal{B}(\mathbb{R}^n)$ is translation invariant, i.e., if $A \subset \mathbb{R}^n$ is a Borel measurable set, then
    \[
    t + A := \{t + x \mid x \in A\}
    \]
    is a Borel measurable set for every $t \in \mathbb{R}^n$. (Hint: For any fixed $t$, show that $A = \{B \subset \mathbb{R}^n : t + B \in \mathcal{B}(\mathbb{R}^n)\}$ is a $\sigma$-algebra.)
    \item[(b)] Prove that $\mathcal{B}(\mathbb{R}^n)$ is scaling invariant, i.e., if $A \subset \mathbb{R}^n$ is a Borel measurable set, then
    \[
    \lambda A = \{\lambda x \mid x \in A\}
    \]
    is a Borel measurable set for every $\lambda \in \mathbb{R}$.
\end{itemize}

(1)
\begin{proof}

Fix \(t \in \mathbb{R}^n\). Define
\[
\mathcal{A} :=\{\, B \subseteq \mathbb{R}^n : t + B \in \mathcal{B}(\mathbb{R}^n) \}.
\]
We want to show that \(\mathcal{A} = \mathcal{B}(\mathbb{R}^n)\). We first show that $\mathcal{A}$ is a $\sigma$-algebra.

1. \(\emptyset     \in  \mathcal{A}\) since \(t + \emptyset = \emptyset \in \mathcal{B}(\mathbb{R}^n)\).

2. $\mathcal{A}$ is closed under complement: Let \(B \in \mathcal{A}\), then \(t + B \in \mathcal{B}(\mathbb{R}^n)\). The complement \((t + B)^c\) is also in \(\mathcal{B}(\mathbb{R}^n)\). Observe
\[
   t + B^c  = t + \mathbb{R}^n \setminus B = (t+\mathbb{R}^n) \setminus (t+B) = \mathbb{R}^n  \setminus (t+B) =  (t+B)^c
   \]
\noindent Since \(t + B\) is Borel, its complement is Borel, hence \(t + B^c\) is Borel, so \(B^c \in \mathcal{A}\).

3. $\mathcal{A}$ is closed under countable unions: Let \(B_k \in \mathcal{A}\) for \(k = 1, 2, \dots\), then \(t + B_k \in \mathcal{B}(\mathbb{R}^n)\). Thus
   \[
   t + \bigcup_{k=1}^{\infty} B_k
   \;=\;
   \bigcup_{k=1}^{\infty} (t + B_k)
   \;\in\;
   \mathcal{B}(\mathbb{R}^n).
   \]
\noindent Hence \(\bigcup_{k=1}^{\infty} B_k \in \mathcal{A}\).
\noindent These three properties show that \(\mathcal{A}\) is a \(\sigma\)-algebra. \\

\noindent Since \(t + U\) is open if \(U\) is open in $\mathbb{R}^n$, \(\mathcal{A}\) contains all open sets. Since \(\mathcal{B}(\mathbb{R}^n)\) is the smallest \(\sigma\)-algebra containing all open sets in \(\mathbb{R}^n\), we have:\(
\mathcal{B}(\mathbb{R}^n) \;\subseteq\; \mathcal{A}
\) 
\noindent Hence suppose \(A \in \mathcal{B}(\mathbb{R}^n) \), then $A \in \mathcal{A}$, so $t+A \in   \mathcal{B}(\mathbb{R}^n)$. This completes the proof of translation invariance.
\end{proof}

(2)
\begin{proof}
Fix \(\lambda \in \mathbb{R}\). 
Case 1: $\lambda = 0$, then $\lambda A = \{ 0\}$ if $A \not = \emptyset$, and $\lambda A = \emptyset$ otherwise. Both $\{0\}$(closed set) and $\emptyset$ is Borel set.

Case 2: $\lambda \not = 0$. We define
\[
\mathcal{A} :=\{\, B \subseteq \mathbb{R}^n :  \lambda B \in \mathcal{B}(\mathbb{R}^n) \}.
\]

We want to show that \(\mathcal{A} = \mathcal{B}(\mathbb{R}^n)\). We first show that $\mathcal{A}$ is a $\sigma$-algebra.

1. \(\emptyset     \in  \mathcal{A}\) since \(\lambda\emptyset = \emptyset\).

2. $\mathcal{A}$ is closed under complement: Let \(B \in \mathcal{A}\), then \(\lambda B \in \mathcal{B}(\mathbb{R}^n)\), then \((\lambda B)^c\) is also in \(\mathcal{B}(\mathbb{R}^n)\). Observe $(\lambda B)^c = \lambda B^c$, so $\lambda B^c \in \mathcal{B}(\mathbb{R}^n)$, therefore $B^c \in \mathcal{A}$.
3. $\mathcal{A}$ is closed under countable unions: Let \(B_k \in \mathcal{A}\) for \(k = 1, 2, \dots\), then \(\lambda B_k \in \mathcal{B}(\mathbb{R}^n)\). Thus
   \[
    \lambda \bigcup_{k=1}^{\infty} B_k
   \;=\;
   \bigcup_{k=1}^{\infty} (\lambda B_k)
   \;\in\;
   \mathcal{B}(\mathbb{R}^n).
   \]
\noindent Hence \(\bigcup_{k=1}^{\infty} B_k \in \mathcal{A}\).
\noindent These three properties show that \(\mathcal{A}\) is a \(\sigma\)-algebra. \\

\noindent Since $\lambda \not = 0$, \(\lambda U\) is open iff \(U\) is open in $\mathbb{R}^n$, thus \(\mathcal{A}\) contains all open sets, so
\(
\mathcal{B}(\mathbb{R}^n) \;\subseteq\; \mathcal{A}
\), 

Hence if \(A\in \mathcal{B}(\mathbb{R}^n)\),  we have \(A  \in  \mathcal{A}\), therefore $\lambda A \in \mathcal{B}(\mathbb{R}^n)$. This completes the proof of translation invariance.
\end{proof}






\section{Hex and Such}
Let $A \subset [0,1]$ be the set of real numbers in $[0,1]$ having a hexadecimal expansion with the digit 5 appearing infinitely many times, and the ‘digit’ E appearing at most finitely many times. Prove that $A$ is a Borel set. (Hint: see p. 2 of Folland’s book.)
\begin{proof}
Define：
   \[
   B := \{ x \in [0,1] \mid \text{the digit '5' appears infinitely many times in the hex expansion of }x \}.
   \]\[
   C := \{ x \in [0,1] \mid \text{the digit 'E' appears at most finitely many times in the hex expansion of }x \}.
   \]

\noindent Then clearly
\[
A = B \cap C.
\]
\noindent Hence \textbf{it suffices to show that \(B\) and \(C\) are Borel sets}, since intersection of two Borel sets is a Borel set.
\noindent And thus it \textbf{suffices to show that $B^c$ and $C$ are Borel sets}. Note 
$$B^c = \{ x \in [0,1] \mid \text{the digit '5' appears at most finitely many times in the hex expansion of }x \}$$, so the proof for $B^c$ and $C$ are about the same.
\noindent We now show $B^c$ is a Borel set:
\noindent  We define
\[
     C_{d_1 d_2 \cdots d_n} \;:=\; \bigl\{\, x\in[0,1] : \text{the first }n\text{ hexadecimal digits of }x \text{ are }d_1, d_2, \ldots, d_n \bigr\},
   \]
where each \(d_i\) is one of the 16 hexadecimal digits \(\{0, 1, 2, \dots, 9, A, B, C, D, E, F\}\).  
 Then the set contains all real numbers between $\frac{d_1d_2\cdots d_n}{16^n}$ and $\frac{d_1d_2\cdots d_n + 1}{16^n}$, so actually it is an interval:

   \[
     C_{d_1 d_2 \cdots d_n} =   \left[\frac{d_1d_2\cdots d_n}{16^n},\;\frac{d_1d_2\cdots d_n + 1}{16^n}\right)
   \]
 Since it is an interval, it is a Borel set on \([0,1]\).
\noindent And we define:
\[
D_N = \{ x : \text{from digit \(N\) onward, there are no '5's} \}.
\]
Then we have
\[
B^c = \bigcup_{N=1}^{\infty} D_N,
\]
So it suffices to prove that each $D_N$ is Borel set, since a countable union of Borel sets is Borel set.

\noindent   \textbf{Claim : any $D_N$ is a Borel set.}
To prove this, we fix  an $N$ and define for each $n \geq N$
\[
     E_n 
     \;=\; 
     \{\,x \in [0,1]: d_n(x)\neq 5\}.
   \]
 \noindent  Then we have 
$$
E_n = \bigcup_{d_i \in \{1,\cdots,F\}   \forall 1\leq i \leq n, d_n \not = 5}  C_{d_1d_2\cdots d_n}
$$
 Thus \textbf{each $E_n$ is a Borel set} since it is a finite union of Borel set, which shows that $D_N$ is Borel set, since 
 \[
     D_N 
     \;=\;
     \bigcap_{k = N}^{\infty} E_k.
   \]
This finishes the proof that $B^c$ is a Borel set, and by a similar argument, $C$ is a Borel set, and thus $A = B \cap C$ is a Borel set. 
   
\end{proof}

\section{Admissible Annuli generating $\mathcal{B}(\mathbb{R}^n)$} 
Define an admissible annulus in $\mathbb{R}^2$ to be a set of the form
\[
\{(x, y) \in \mathbb{R}^2 \mid r^2 < (x - a)^2 + (y - b)^2 < R^2\},
\]
where $a, b \in \mathbb{Q}$, $r, R \in \mathbb{Q}_{>0}$, and $r < R$.

\begin{itemize}
    \item[(a)] Prove that there are only countably many admissible annuli.
    \item[(b)] Prove that every open subset of $\mathbb{R}^2$ is a countable union of (not necessarily disjoint) admissible annuli.
    \item[(c)] Prove that the Borel $\sigma$-algebra on $\mathbb{R}^2$ is generated by the collection of admissible annuli.
\end{itemize}

(1) \begin{proof} Let 
\[ A:=   \{     \text{all admissible annulis in $\mathbb{R}^2$}   \}\]
And we define 
\begin{align}
     f:\mathbb{Q}^4   & \to A \\
    (a,b,r,R)  & \mapsto \{(x, y) \in \mathbb{R}^2 \mid r^2 < (x - a)^2 + (y - b)^2 < R^2\}
\end{align}
Since a Annuli defined by this $(a,b,r,R)$ is unique, this is a well-defined function; and since every admissible annulis can be defined by an element of $\mathbb{Q}^4$, this map is surjective. Therefore $\card(A) \leq \card(\mathbb{Q}^4)$, so $A$ is countable.
\end{proof}
(2) 
\begin{proof}
\noindent \textbf{Claim 1: every open set in $\mathbb{R}^2$ is a countable union of open balls, each centered at some $q\in \mathbb{Q}^2$.}\\
\noindent Proof for Claim 1:\\
\noindent Let $U$ be an open set in $\mathbb{R}^2$.
\noindent Define
\[\mathbb{Q}_U  :=    U \cap \mathbb{Q}^2\]
\noindent By definition, every point in $U$ have an open ball centered at it that is completely contained in $U$, so we pick such ball $B_{r_x}(x)$ for each $x \in U$.
\noindent Since \(\mathbb{Q}^2\) is dense in \(\mathbb{R}^2\), for each \(x \in U\) and each corresponding \(r_x\), we can find a rational point \(q_x \in \mathbb{Q}^2\) such that \(|q_x - x| < \frac{r_x}{3}\). (Or more generally, as small as we wish.)

\noindent Let \(r_{q_x} > 0\) be chosen so that 
   \(
     r_{q_x} = \frac{r_x}{3},
   \)
Then observe that $x \in   B(q_x, r_{q_x}) $
     \[
     B(q_x, r_{q_x}) \subsetneq B(x, r_x) \subset U
   \]
\noindent   which follows from the triangle inequality.
   \pic[0.2]{assets/hw1(1).png}

For each $q \in \mathbb{Q}_U$, we define:
\[ r_{q,sup} := \sup\{  r_{q_x}  \mid q  \text{ is chosen by } x         \}     \]
Now we have:
\[  U \subset \bigcup_{q \in U_q}  B_{r_{q,sup}} (q)  \]
\noindent  This is because for each each $x \in U$, $x \in B_{r_{q_x}}(q_x) \subset B_{r_{q_x,sup}}(q_x)$

And we also have the other direction:
\[ \bigcup_{q \in U_q}  B_{r_{q,sup}} (q)   \subseteq U\]
since every $B_{r_q}(q)$ is guaranteed to be the subset of some ball around some $x \in U$. 
All togethe we have
\[
 U = \bigcup_{q \in U_q}  B_{r_{q,sup}} (q)
\]
This finishes the proof of claim 1.

\textbf{Claim 2: every open ball centered at some $q\in \mathbb{Q}^2$ is a countable union of admissible annulises with the same center, together with another admissible annulis whose center is also rational.}
Proof for Claim 2: 
\noindent Let $q = (a,b) \in \mathbb{Q}^2$.\\
We have
\[    
   B\bigl(q, R)  \setminus \{q\}
   \;=\; 
   \bigcup_{n=1}^{\infty} \Bigl\{(x,y) : (R-\tfrac{1}{n})^2 < (x-a)^2 + (y-b)^2 < R^2\Bigr\}
\]
\textcolor{red}{-1, 这里写的略有问题, 因为 $R$ 不一定是 rational 的, 不过我们可以用 density of $\mathbb{Q}$ in $\mathbb{R}$ 来写.}
It remains to cover the center. Let $q' := (a',b') \in \mathbb{Q}^2$ such that $R/6 < |q' - q| < R/3$, $r' := R/6$ and $R' := R/2$ . Then the annuli $A(a',b',r',R')$ defined by the four parameters is contained in the $ B\bigl(q, R)$ and it covers $\{q\}$. 
Therefore
\[    
   B\bigl(q, R)
   \;=\; 
 (  \bigcup_{n=1}^{\infty} \Bigl\{(x,y) : (R-\tfrac{1}{n})^2 < (x-a)^2 + (y-b)^2 < R^2\Bigr\}) \cup A(a',b',r',R')
\]
\pic[0.2]{assets/hw1(2).png}
This finishes the proof of Claim 2.\\
Combining Claim 1 and Claim 2, we can conclude that \textbf{every open subset of $\mathbb{R}^2$ is a countable union of admissible annuli.}\end{proof}

\noindent (3) 
\begin{proof}

As defined,
\[
\mathcal{B}(\mathbb{R}^2) = <\mathcal{T}_{metric}> = <\{\text{all open sets in }\mathbb{R}^2\}>
\]
 Let 
\[ A:=   \{     \text{all admissible annulis in $\mathbb{R}^2$}   \}\]
Every admissible annuli is open in $\mathbb{R}^2$, so 
\[
A \subset \{\text{all open sets in }\mathbb{R}^2\}
\]
and since $\mathcal{B}(\mathbb{R}^2)$ is a $\sigma$-algebra, we have 
\[
<A> \subset <\{\text{all open sets in }\mathbb{R}^2\}> =\mathcal{B}(\mathbb{R}^2)
\]by the proposition proved in class.
\noindent And by (2), any open set is a countable union of admissible annulis, therefore every open set is in $<A>$ since any countable union of sets in a $\sigma$-algebra is still in the set. So
\[   
 \{\text{all open sets in } \mathbb{R}^2\} \subset <A>
\]
This finishes the proof that 
\[
<A> = <\{\text{all open sets in }\mathbb{R}^2\}> =\mathcal{B}(\mathbb{R}^2)
\]
\end{proof}





\section*{Nur für Verrückte}
(It’s really not necessary to attempt these problems. Do not hand them in!)

\begin{itemize}
    \item[(1)] Let $X$ be a set, and define two operations on $\mathcal{P}(X)$:
    \begin{itemize}
        \item The “product” of two subsets $E, F \subset X$ is the intersection $E \cap F$.
        \item The “sum” of two sets $E, F \subset X$ is the symmetric difference $E \Delta F$.
    \end{itemize}
    \begin{itemize}
        \item[(a)] Prove that these operations endow $\mathcal{P}(X)$ with the structure of a commutative ring. What are the additive and multiplicative units? Prove that this ring is idempotent.
        \item[(b)] Let us say that a nonempty subset $A \subset \mathcal{P}(X)$ is a ring if it is closed under differences and finite unions. In other words, if $E, F \in A$, then $E \setminus F \in A$ and $E \cup F \in A$. Prove that a subset $A \subset \mathcal{P}(X)$ is an algebra iff it is a ring containing $X$.
        \item[(c)] Prove that a nonempty subset $A \subset \mathcal{P}(X)$ is a ring iff it is a subring of $\mathcal{P}(X)$. Also prove that it is an algebra iff it is a subring containing the multiplicative identity.
    \end{itemize}
    \item[(2)] Let $(X, \mathcal{A})$ and $(Y, \mathcal{B})$ be measurable spaces. Say that a map $f : X \to Y$ is measurable (with respect to the $\sigma$-algebras $\mathcal{A}$ and $\mathcal{B}$) if $f^{-1}(E) \in \mathcal{A}$ for every $E \in \mathcal{B}$.
    \begin{itemize}
        \item[(a)] Prove that measurable spaces with measurable maps as morphisms form a category.
        \item[(b)] Try convincing an analyst that (a) is useful.
    \end{itemize}
\end{itemize}





\chapter{on Carathéodory's and Hahn-Holmogrov Thm(40/40)}

\begin{center}
\textit{None of the following questions will be graded. Do them, but do not hand them in}.
\end{center}

\section{The Borel--Cantelli Lemma}
Let \((X, \mathcal{A}, \mu)\) be a measure space. Let \(A_i \in \mathcal{A}\) for \(i \in \mathbb{N}\), and suppose that
\[
\sum_{i=1}^\infty \mu(A_i) < \infty.
\]
(a) Prove that \(\mu(\limsup_i A_i) = 0\), where
\[
\limsup_i A_i = \{x \in X \mid x \in A_i \text{ for infinitely many } i\}.
\]
(By the way, why is \(\limsup_i A_i\) measurable?)

(b) Conversely, is it true that if \(A_i \in \mathcal{A}\) for \(i \in \mathbb{N}\), and \(\mu(\limsup_i A_i) = 0\), then \(\sum_i \mu(A_i) < \infty\)? Provide a proof or a counterexample.
(Wrong)
\begin{remark}
\begin{theorem}{Borel--Cantelli Lemma}
    一个 measure 和有限的 set seq, 其 $\lim \sup$ (出现 infinitely many times 的元素) 是零测的.
\end{theorem}
其实这是 trivial 的, 因为如果出现 infinitely many times 的元素不是零测的, say $\mu(\lim\sup_i A_i) := k>0$, 那么有 infinitely many 个 $A_i$ 的测度大于等于 $k$, 那么 \(\sum_{i=1}^\infty \mu(A_i) > k \times \infty\) 就一定不是有限的了.\\
其 application: 一个 prob space 中, a ctbl seq of 事件发生的概率的和如果收敛, 那么它们包含的任何事件发生无穷多次的概率为 0，意味着事件至多发生有限次 (almost surely).
\end{remark}


\section{The Completion of a Measure Space}
Let \((X, \mathcal{A}, \mu)\) be a measure space, and set
\[
\overline{\mathcal{A}} := \{E \cup F \mid E \in \mathcal{A} \text{ and } F \text{ is a } \mu\text{-subnull set}\}.
\]

(a) Prove that \(\overline{\mathcal{A}}\) is a \(\sigma\)-algebra.
(b) Define \(\overline{\mu}(A) := \mu(E)\) if \(A = E \cup F \in \overline{\mathcal{A}}\). Prove that \(\overline{\mu}\) is a well-defined measure on \(\overline{\mathcal{A}}\).
(c) Prove that \(\overline{\mu}\) extends \(\mu\) (i.e., \(\overline{\mu}(A) = \mu(A)\) if \(A \in \mathcal{A}\)).
(d) Prove that\textbf{ \(\overline{\mu}\) is the unique extension of \(\mu\) to \((X, \overline{\mathcal{A}})\)}. In other words, prove that if \(\mu'\) is another measure on \((X, \overline{\mathcal{A}})\) that extends \(\mu\), then \(\mu' = \overline{\mu}\).
(e) Prove that \textbf{\(\overline{\mu}\) is complete}.
(f) Suppose \((X, \mathcal{A}', \mu')\) is another complete measure space that extends \((X, \mathcal{A}, \mu)\) (i.e., \(\mathcal{A} \subset \mathcal{A}'\) and \(\mu'|_{\mathcal{A}} = \mu\)). Show that \textbf{\(\overline{\mathcal{A}} \subset \mathcal{A}'\) and \(\mu'|_{\overline{\mathcal{A}}} = \overline{\mu}\).} 
\textbf{Hint:} Start by reading Theorem 1.9 in Folland.
\begin{proof}
    略.(嘻嘻)
\end{proof}


\section{The Hahn--Kolmogorov Extension as a Completion}
Let \((X, \mathcal{A}_0, \mu_0)\) be a \(\sigma\)-finite measure pre-measure space, and \((X, \mathcal{A}, \mu)\) its Hahn–Kolmogorov extension. Prove that \((X, \mathcal{A}, \mu)\) is the completion of its restriction to the \(\sigma\)-algebra \(\langle \mathcal{A}_0 \rangle\) generated by \(\mathcal{A}_0\).
\begin{proof}
    Proved in lec notes.
\end{proof}



\newpage
\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in}.
\end{center}


\section{\(\mu(\emptyset) = 0\) 的定义并非 redundant}
Let \((X, \mathcal{A})\) be a measurable space. Is the condition \(\mu(\emptyset) = 0\) in the definition of a measure on \((X, \mathcal{A})\) redundant? In other words, if \(\mu : \mathcal{A} \to [0, \infty]\) is a function such that
\[
\mu\left(\bigcup_{i=1}^\infty A_i\right) = \sum_{i=1}^\infty \mu(A_i),
\]
for any disjoint subsets \(A_i \in \mathcal{A}\), \(i \in \mathbb{N}\), does it follow that \(\mu(\emptyset) = 0\)? If not, what can you say?
\begin{proof}
    It does not follow.\\
    Counterexample: Consider $\mu(E) = \infty \;\; \forall E \in \mathcal{A}$.\\
    This measure satisfies the countably disjoint additivity condition, since for every disjoint sequence of sets in $\mathcal{A}$, $\mu\left(\bigcup_{i=1}^\infty A_i\right) = \sum_{i=1}^\infty \mu(A_i) = \infty$ has infinite measure. 
\end{proof}


\section{measurable set seq 的 limit 也 measurable (且如果 seq tail $\sigma$-finite $\implies$ limit commute )}
Let \((X, \mathcal{A}, \mu)\) be a measure space, and let \(A_i \in \mathcal{A}, i \in \mathbb{N}\). Assume that the sets \(A_i\) converge to the set \(A \subset X\) in the sense that:
- If \(x \in A\), then \(x \in A_i\) for all but finitely many \(i\);
- If \(x \notin A\), then \(x \notin A_i\) for all but finitely many \(i\).

\noindent \textbf{(a) Prove that \(A\) is measurable, that is, \(A \in \mathcal{A}\).}
\begin{proof}
    Deduing from the conditions:
    If \(x \in A\), then \(x \in A_i\) for all but finitely many \(i\); $\implies $ $A \subset \liminf A_i$
    If \(x \notin A\), then \(x \notin A_i\) for all but finitely many \(i\). $\implies $ if \(x \in A_i\) for all but finitely many \(i\) then $x\in A$ $\implies$  $\limsup A_i \subset A$
    Thus 
    \begin{equation}
    \limsup A_i \subset A \subset \liminf A_i    
    \end{equation}
    
\noindent   \textbf{Claim1: For any sequence of sets $(A_i)_{i \in \mathbb{N}}$, we have 
$$\liminf A_i \subset \limsup A_i$$} 
Proof of Claim 1: Follows trivially from the definition, since \(x \notin A_i\) for all but finitely many \(i\) $\implies$ \(x \notin A_i\) for infinitely many \(i\).\\\\
Combining claim (1) with (2.1) we have
\begin{equation}
\limsup A_i  =  A  = \liminf A_i    
\end{equation}
\noindent \textbf{Claim 2: For any sequence of sets $(A_i)_{i\in \mathbb{N}}$ in a $\sigma$-algebra, $\liminf_i Ai$ and $\limsup_i A_i$ is also in the $\sigma$-algebra.}\\
Proof of Claim 2: This follows from the def and fact that union and intersection of a countable sequence sets in a $\sigma$-algebra is also in this $\sigma$-algebra. We have
\pic[0.8]{assets/hw2(1).jpeg}    
This finishes the proof of Claim 2.\\
\noindent Combining claim 2 with (2.2), $A \in \mathcal{A}$, this finishes the proof.\\
\end{proof}

\noindent \textbf{(b)  Prove that if there exists \(n \geq 1\) such that \(\mu\left(\bigcup_{i=n}^\infty A_i\right) < \infty\), then \(\mu(A) = \lim_i \mu(A_i)\).}
\begin{proof}
\pic[0.7]{assets/hw2(2).png}
\pic[0.7]{assets/hw2(3).png}
    
\end{proof}


\noindent \textbf{(c) Give an example showing that the condition in (b) is necessary}.
\begin{solution}
\noindent  Let $\mu$ be the Lebesgue measure defined on $\mathcal{B}(\mathbb{R})$. We set for each $i\in \mathbb{N}$ that
\[
   A_i =(i,i+1)
\]
\noindent Since this is an interval, it is Lebesgue measurable. Note that no element of any $A_i$ show up infinitely many times in the sequence. So 
$$
\liminf A_i = \limsup A_i = \varnothing
$$
\noindent So $A = \varnothing$, we have $\lim_i \mu(A_i) = 0$.
\noindent But we have $\lim_i \mu(A_i)  = 1$ since it is true for every $i$.\\
\noindent In this case, $\mu(\bigcup_{i=1}^\infty A_i) = \infty$, which causes (b) to fail.
\end{solution}


\noindent \textbf{Hint:} In analysis, it is often fruitful to use \(\limsup\) and \(\liminf\) to study limits.\\

\section{measure space of two elements}
\noindent Let \(X\) be a set with two elements, for example, \(X = \{O, Q\}\).\\
\noindent \textbf{(a) Find all \(\sigma\)-algebras on \(X\).}
\begin{solution}
    \begin{enumerate}
    \item trivial \(\sigma\)-algebra:\[
     \mathcal{A}_1 :=\{\varnothing,\; X\}
   \]
   \item power set:
   \[
     \mathcal{A}_2 := \mathcal{P}(X)
     \;=\;\{\varnothing,\;\{O\},\;\{Q\},\;X\}
   \]
\end{enumerate}
These are the only $\sigma$-algebras on $X$.\\\\
\end{solution}

\noindent \textbf{(b) Let \(\mathcal{A}\) be a \(\sigma\)-algebra on \(X\), and \(\mu\) a measure on \((X, \mathcal{A})\). Is \(\mu\) necessarily complete? Provide a proof or a counterexample.}
\begin{solution}
    It is not necessarily complete.\\
    Cosider the trivial \(\sigma\)-algebra:\(\mathcal{A}_1 :=\{\varnothing,\; X\}\), and set $\mu$ as that $\mu(\varnothing) = \mu(X) = 0$. This makes $X$ a null set, so $\{O\}, \{Q\}$ are subnull sets, but they are not measurable by $\mu$.\\\\
\end{solution}
\noindent \textbf{(c) Find all outer measures \(\mu^*\) on \(X\). For each outer measure on \(X\), find the \(\sigma\)-algebra of \(\mu^*\)-measurable sets (see Carathéodory’s theorem).}
\begin{solution}
    Suppose \(\mu^*\) is an outer measure on \(X\). Since $\mathcal{P}(X)$  only has four elements: \(\varnothing\), \(\{O\}\), \(\{Q\}\), \(X\); and the outer measure of $\varnothing$ is 0, so we first parametrize \(\mu^*\) by:
\[
a :=\mu^*(\{O\}),\quad
b :=\mu^*(\{Q\}),\quad
c := \mu^*(X).
\]
\end{solution}
\noindent Then $\mu^*$ is well-defined iff it satisfies:
\begin{enumerate}
    \item $a,b \leq c$
    \item \(c = \mu^*(\{O\}\cup\{Q\}) \;\le\; \mu^*(\{O\}) + \mu^*(\{Q\}) \;=\; a + b.\)
\end{enumerate}
\noindent Any $(a,b,c) \in [0,\infty]^3$ satisfying
\[
\max(a,b) \;\le\; c \;\le\; a+b,
\]
can make $\mu^*$ a well-defined outer measure on \(X\).\\
\noindent Therefore
\[
S :=\{\text{all } \sigma \text{-algebra on } X\} = \{ \mu^* : \mathcal{P}(X) \to [0,\infty]\mid \max(\mu^*(\{O\}), \mu^*(\{Q\})) \leq \mu^*(X) \leq \mu^*(\{O\})+ \mu^*(\{Q\})\} 
\]
\\
Now we specify the \(\sigma\)-algebra of \(\mu^*\)-measurable sets for each $\mu^* \in S$.\\
By Carathéodory's criterion, a set \(E\subset X\) is \(\mu^*\)-measurable iff for all \(A\subset X\),
\[
\mu^*(A)
\;=\;
\mu^*(A\cap E)\;+\;\mu^*(A\cap E^c).
\]
Note that \(\varnothing\), \( X\) are always measurable since for any \(A \subset X\), \(A\cap \varnothing=\varnothing,\;A\cap ( \varnothing)^c = A\); and \(A\cap X=A,\;A\cap (X)^c=\varnothing\).  So it suffices to check for $\{O\}, \{Q\}$. We first check for $\{O\}$. $\{O\}$ is \(\mu^*\)-measurable iff \(
  \mu^*(A) \;=\;
  \mu^*(A\cap \{O\}) \;+\;\mu^*(A\cap \{O\}^c)
  \) for any choice of $A$.
There are only four possibilities for \(A\): \(\varnothing\), \(\{O\}\), \(\{Q\}\), \(X\).
\begin{enumerate}
    \item   If \(A = \varnothing\), both sides are 0, always stands.
    \item If \(A = \{O\}\), then \(\mu^*(\{O\}) + \mu^*(\varnothing)=a+0=a\), always stands.
    \item If \(A = \{Q\}\), then \(\mu^*(\varnothing)+\mu^*(\{Q\})=0+b=b\), always stands.
    \item If \(A = X\), then \(\mu^*(X)=c =\mu^*(\{O\})+\mu^*(\{Q\})=a+b\).
\end{enumerate}
\noindent Therefore $\{O\}$ is \(\mu^*\)-measurable iff $c =a+b$.  For the same reasoning, \(\{Q\}\) is \(\mu^*\)-measurable iff \(c = a+b\).\\
Thus we can conclude that:
\begin{enumerate}
    \item If \(c = a+b\), $\{   \mu^* \text{-measurable sets}   \} =  \mathcal{P}(X)$.
    \item otherwise, $\{   \mu^* \text{-measurable sets}   \} =  \{\varnothing, X\}$.
\end{enumerate}
\noindent \textbf{(d) Find an example of a collection \(\mathcal{E}\) of subsets of \(X\) with \(\emptyset, X \in \mathcal{E}\) and a function \(\rho : \mathcal{E} \to [0, \infty]\) with \(\rho(\emptyset) = 0\) such that \(\mathcal{E} \not\subset \mathcal{A}\), where \(\mathcal{A}\) is the Carathéodory \(\sigma\)-algebra for the outer measure \(\mu^*\) induced by \((\mathcal{E}, \rho)\).}
\begin{solution}
\noindent Consider \(\mathcal{E}=\{\varnothing,X,\{O\}\}\), with $\rho$ such that \(\rho(\emptyset)=0\), \(\rho(X)=1\), \(\rho(\{O\})=1\). \\ \noindent The outer measure \(\mu^*\) induced by $\mu^*$ is: \(\mu^*(X)=1\), \(\mu^*(\{O\})=1\), \(\mu^*(\{Q\})=1\). (the inf of length sum of sets covering $\{Q\}$ is 1, by taking $\{X\}$ as the covering.)\\
\noindent Since \(c \not = a+b\), by (4), the Carathéodory \(\sigma\)-algebra by $\mu^*$ by $\cE$ is \(\{\varnothing,X\}\), so \(\mathcal{E}\not\subset \mathcal{A}\).\\\\
\end{solution}
\noindent \textbf{Remark:} The Hahn–Kolmogorov theorem states that if \(\mathcal{E} = \mathcal{A}_0\) is an algebra and \(\rho = \mu_0\) is a pre-measure, then \(\mathcal{A}_0 \subset \mathcal{A}\). This exercise provides a counterexample when \(\mathcal{E}\) and \(\rho\) are general.
、



\section{Hahn–Kolmogorov Collapse (when $\mu_0$ not $\sigma$-finite)}
Let \(X \subset \mathbb{R}\) be the set of dyadic rational numbers, that is, the set of numbers of the form \(\frac{r}{2^n}\), where \(r\) and \(n\) are integers. Let \(\mathcal{A}_0 \subset \mathcal{P}(X)\) be the collection of finite unions of intervals of the form \((a, b] \cap X\), where \(-\infty \leq a < b \leq \infty\).

\noindent \textbf{(a) Prove that \(\mathcal{A}_0\) is an algebra.}
\begin{proof}
\begin{enumerate}
    \item \(\varnothing \in \mathcal{A}_0\), since it is the empty union of intervals of the given form.
    \item \textbf{Closed under complements}:  Let \(A\in \mathcal{A}_0\). Then \(A\) is a finite union of intervals of the form \((a_i,b_i]\cap X\).  So  \begin{align}
     A^c \cap X  &= X\setminus A \\
     &=  X\setminus \bigcup_{i=1}^n \bigl((a_i,b_i]\cap X\bigr) \bigr) \\
     &=
 X\cap \bigl(\bigcap_{i=1}^n \bigl((a_i,b_i]\cap X\bigr)^c \bigr) \\
    &  =  X\cap \bigl(\bigcap_{i=1}^n \bigl((-\infty, a_i] \cup (b_i, \infty]\bigr) \bigr)
\end{align} 
Note that finite intersection of intervals of the form \((-\infty,a_i]\), \((b_i,\infty]\) is still of this form. Hence \(A^c\cap X\in \mathcal{A}_0\).
    \item \textbf{Closed under finite unions}: Suppose \(A_1\) and \(A_2\) are finite unions of intervals \(\bigl((a_i,b_i]\cap X\bigr)\), then \(A_1\cup A_2\) is still a finite union of intervals of that form. (They either merge into one such interval, so are disjoint.) Hence \(A_1\cup A_2\in \mathcal{A}_0\).  The same reasoning extends to any finite union.
\end{enumerate}
\noindent \textbf{This finishes the proof that \(\mathcal{A}_0\) is an algebra on \(X\).}\\\\
\end{proof}

\noindent \textbf{(b) Prove that the \(\sigma\)-algebra on \(X\) generated by \(\mathcal{A}_0\) equals \(\mathcal{P}(X)\).}
\begin{proof}
Since $<\mathcal{A}_0> \subset \mathcal{P}(X)$, it suffices to show that $\mathcal{P}(X) \subset <\mathcal{A}_0>$.
\noindent Note that $X$ is countable, so any set in $\mathcal{P}(X)$ is a countable union of singleton sets. Thus it suffices to show that any singleton set $\{x\}$ where $x\in X$ is in $<\mathcal{A}_0>$, since if so, then any countable union of singleton sets from $\mathcal{P}(X)$ is also in $<\mathcal{A}_0>$, with implies that $\mathcal{P}(X) \subset <\mathcal{A}_0>$\\
\noindent Let $x \in X$. Then we have: 
   \[
     \{x\} \;=\; \bigcap_{n=1}^\infty \bigl( (x - \frac{1}{2^{n}},\,x]\cap X \bigr),
   \]
 since $x$ is in the RHS set, and for any $y <x$, we can find a $n \in \mathcal{B}$ such that $x - \frac{1}{2^n} > y$.\\
 \noindent This finishes the proof that  \(<\mathcal{A}_0> = \mathcal{P}(X)\).
\end{proof}


\noindent \textbf{(c) Define \(\mu_0 : \mathcal{A}_0 \to [0, \infty]\) by \(\mu_0(\emptyset) = 0\) and \(\mu_0(A) = \infty\) for \(A \neq \emptyset\). Prove that \(\mu_0\) is a pre-measure on \(\mathcal{A}_0\)}
\begin{proof}
It suffices to show the countable disjoint additivity.\\
Let $(A_i)_{i\in\mathcal{N} }$ be a sequence of disjoint sets in $\mathcal{A}_0$.\\
Case 1: all $A_i = \varnothing$, then $\sqcup_{i\in \mathcal{N} } A_i = \varnothing$, so $\mu_0(\sqcup_{i\in \mathcal{N} } A_i) = \sum_{i\in\mathcal{N} }\mu_0(A_i) = 0$.\\
Case 2: $A_k \not = \varnothing$ for some $k$, then $\mu_0 (A_k) = \infty$ and $\sqcup_{i\in \mathcal{N} } A_i \not= \varnothing$. Thus $\sum_{i\in\mathcal{N} }\mu_0(A_i) \geq \mu_0(A_k)= \infty = \mu_0(\sqcup_{i\in \mathcal{N} } A_i )$.\\
The two cases cover all circumstances, finishing the proof.\\
\end{proof}


\noindent \textbf{(d) Prove that there exist infinitely many different measures \(\mu\) on \(\mathcal{P}(X)\) whose restriction to \(\mathcal{A}_0\) equals \(\mu_0\).}
\begin{proof}
    Given $n \in \mathbb{N}$, We define the "n-timed counting measure" on a $\sigma$-algebra $S$ as:
$$
    \mu_{count_n}(E) := \begin{cases}
        n\times  \#(E) \;\;, \text{ if }  E \text{ is finite }  \\
        \infty \;\; ,\text{ if }  E \text{ is infinite }
    \end{cases}
 $$

 \noindent \textbf{Claim 1: For any set $X$ and any $\sigma$-algebra $S$ on $X$, the "n-timed counting measure" is a well-defined measure on $S$, for all $n \in \mathbb{N}$.}\\
Proof of claim 1: $\mu_{count_n}(\varnothing) = 0$ since $\card(\varnothing)  =0$, and countable disjoint additivity trivially follows from the rule of counting.\\
\noindent \textbf{Claim 2: for any $n \in \mathbb{N}$, $\mu_{count_n}(E) $ on \(\mathcal{P}(X)\) restricted to \(\mathcal{A}_0\) equals \(\mu_0\).}
Proof of claim 2: Let $E \in \mathcal{A}_0 \setminus \varnothing$, then $E$ contains at least one interval of the form \((a, b] \cap X\), where \(-\infty \leq a < b \leq \infty\). Sicne $a < b$, there are infinitely many elements in \((a, b] \cap X\), so $\mu_{count_n}(E) = \infty$.\\
\noindent This finishes the proof of the original statement.\\
\end{proof}

\noindent \textbf{(e) Explain why (d) does not contradict the uniqueness part of the Hahn–Kolmogorov theorem (see Theorem 1.14 in Folland).}\\
\begin{solution}
    \noindent This is because Hahn–Kolmogorov theorem requires $\mu_0$ to be $\sigma$-finite to extend uniquely on $<\mathcal{A}_0>$. But $\mu_0$ here is not $\sigma$-finite.\\
\end{solution}






\section*{Nur für Verrückte (Only for nuts)}
(It’s really not necessary to attempt these problems. Do not, under any circumstances, hand them in!)

1. Let \((X, \mathcal{A}, \mu)\) and \((Y, \mathcal{B}, \nu)\) be measure spaces. Define a morphism from \((X, \mathcal{A}, \mu)\) to \((Y, \mathcal{B}, \nu)\) to be a map \(f : X \to Y\) that is measurable, that is, \(f^{-1}(B) \in \mathcal{A}\) for all \(B \in \mathcal{B}\), and moreover measure preserving, in the sense that \(\mu(f^{-1}(B)) = \nu(B)\) for all \(B \in \mathcal{B}\).

(a) Prove that measure spaces with measure-preserving maps as morphisms form a category. Denote this category by \(C_3\).

(b) Denote by \(C_1\) the category of sets, and by \(C_2\) the category of measurable spaces (see HW1). Consider the evident forgetful functors \(C_3 \to C_2\) and \(C_2 \to C_1\). Are these functors faithful? Are they full? Are they essentially surjective?












\chapter{on Lebesgue-Stieljes measures(30/40)}

\begin{center}
\textit{None of the following questions will be graded. Do them, but do not hand them in}.
\end{center}


\section{Fun facts about increasing functions}
    Let $F\colon\mathbb{R}\to\mathbb{R}$ be an increasing function, that is, $F(x)\le F(y)$ whenever $x\le y$. 
    \begin{itemize}
    \item[(a)]
      Prove that the following limits exist (and make sure you understand the definitions):
      \begin{itemize}
      \item[(i)]
        $F(a-):=\lim_{x\to a-}F(x)\in\mathbb{R}$ and $F(a+):=\lim_{x\to a+}F(x)\in\mathbb{R}$ for $a\in\mathbb{R}$;
      \item[(ii)]
        $F(\infty):=\lim_{x\to\infty}F(x)\in(-\infty,\infty]$;
      \item[(iii)]
        $F(-\infty):=\lim_{x\to-\infty}F(x)\in[-\infty,\infty)$.
      \end{itemize}
    \item[(b)]
      Fix any $a\in\mathbb{R}$.
      \begin{itemize}
      \item[(i)]
        Prove that $F(a-)\le F(a)\le F(a+)$;
      \item[(ii)]
        Prove that $F$ is continuous at $a$ iff $F(a-)=F(a+)$.
      \end{itemize}
      We say that a function is \emph{left continuous} if $F(a-)=F(a)$ for every $a\in\mathbb{R}$. It is \emph{right-continuous} if instead $F(a+)=F(a)$ for every $a\in\mathbb{R}$.
    \item[(c)]
      If $X$ is a metric space (or, more generally, a topological space), then a function $f\colon X\to\mathbb{R}$ is \emph{upper semicontinuous} if the set $\{x\in X\mid f(x)<a\}$ is open for every $a\in\mathbb{R}$. It is \emph{lower semicontinuous} if instead the set $\{x\in X\mid f(x)>a\}$ is open for every $a\in\mathbb{R}$.
      Prove that our function $F\colon\mathbb{R}\to\mathbb{R}$ is right-continuous (resp. left continuous) iff it is upper semicontinuous (resp.\ lower semicontinuous). Give an example showing that this is no longer true if $F$ is not assumed increasing.
  \item[(d)]
    Prove that the following are equivalent:
    \begin{itemize}
    \item[(i)]
      $F$ is surjective;
    \item[(ii)]
      $F$ is continuous, $F(\infty)=\infty$, and $F(-\infty)=-\infty$.
    \end{itemize}
  \item[(e)]
    Let $A\subset\mathbb{R}$ be the set of points where $F$ fails to be continuous. Prove that $A$ is a countable  (i.e. empty, finite, or countably infinite) set. \textit{Hint}: prove that for any integers $m,n\ge 1$, the set of points $x\in[-m,m]$ where $F(x+)-F(x-)\ge 1/n$ is finite.
  \end{itemize}

\section{Locally finite measures}
  If $X$ is a metric space (or, more generally, a topological space), then a Borel measure $\mu$ on $X$ is said to be \emph{locally finite} if $\mu(K)<\infty$ for every compact set $K\subset X$. Now let $\mu$ be a Borel measure on $\mathbb{R}$, that is $\mu\colon\mathcal{B}(\mathbb{R})\to[0,\infty]$ satisfies $\mu(\emptyset)=0$ and is countably additive.
  \begin{itemize}
  \item[(a)]
    Prove that the following are equivalent:
    \begin{itemize}
    \item[(i)]
      $\mu$ is locally finite;
    \item[(ii)]
      $\mu([-N,N])<\infty$ for every $N\ge0$;
    \item[(iii)]
      $\mu(I)<\infty$ for every bounded interval $I$.
    \end{itemize}
  \item[(b)]
    Prove that if $\mu$ is locally finite, then $\mu$ is $\sigma$-finite. Is the converse true? Give a proof or a counterexample.
  \end{itemize}
  
\section{Basic formulas for LS measures}
  Let $F\colon\mathbb{R}\to\mathbb{R}$ be a distribution function, and $\mu=\mu_F$ the associated Lebesgue--Stieltjes measure. From its definition using h-intervals, it follows that $\mu((a,b])=F(b)-F(a)$ for $-\infty<a<b<\infty$. Using this property together with basic general properties of ($\sigma$-finite) measures, we proved in class that $\mu((a,b))=F(b-)-F(a)$ for $\infty<a\le b<\infty$. Using a similar strategy, prove the following:
  \begin{itemize}
  \item[(a)]
    $\mu([a,b])=F(b)-F(a-)$ for $-\infty<a\le b<\infty$;
  \item[(b)]
    $\mu([a,b))=F(b-)-F(a-)$ for $-\infty<a\le b<\infty$;
  \item[(c)]
    $\mu(\{a\}))=F(a)-F(a-)$ for $-\infty<a<\infty$;
  \item[(d)]
    $\mu((-\infty,b])=F(b)-F(-\infty)$ for $-\infty<b<\infty$;
  \item[(e)]
    $\mu((-\infty,b))=F(b-)-F(-\infty)$ for $-\infty<b<\infty$;
  \item[(e)]
    $\mu((a,\infty))=F(\infty)-F(a)$ for $-\infty<a<\infty$;
  \item[(f)]
    $\mu([a,\infty))=F(\infty)-F(a-)$ for $-\infty<a<\infty$;
  \item[(g)]
    $\mu([-\infty,\infty))=F(\infty)-F(-\infty)$.
  \end{itemize}

\section{Vitali sets}
  For $x, y\in [-1,1]$, write $x\sim y$ iff $x-y\in \mathbb{Q}$. 
  \begin{itemize}
  \item[(a)]
    Show that $\sim$ is an equivalence relation, i.e. show that (i) $x\sim x$, (ii) $x\sim y$ implies $y\sim x$, (iii) if $x\sim y$ and $y\sim z$, then $x\sim z$.
  \item[(b)]
    The set $[-1,1]$ is partitioned into equivalence classes. Let $V\subset[-1,1]$ be a set containing exactly one element from each equivalence class. (Here, we use the Axiom of choice.) We call $V$ a \emph{Vitali set}. 
    Let $\{r_1, r_2,\dots\} =[-2,2]\cap \mathbb{Q}$. Define $V_i= r_i+V=\{r_i+x\mid x\in V\}$.
    Prove that the sets $V_1, V_2, \dots$ are mutually disjoint, and that 
    \[
      [-1, 1]\subset \bigcup_{i=1}^\infty V_i \subset [-3,3].
    \]
  \end{itemize}

\section{Vitali sets, season 2}
  Let $V\subset[-1,1]$ be a Vitali set (see above).
  \begin{itemize}
  \item[(a)]
    Using the translation invariance of Lebesgue measure, prove $V$ is not Lebesgue
    measurable.
  \item[(b)]
    Prove that if $E$ is a Lebesgue measurable set and satisfies $E\subset V$, then $m(E)=0$. 
  \item[(c)]
    Using the technique in~(a), prove the following statement: if $A\subset\mathbb{R}$ is any Lebesgue measurable set with $m(A)>0$, then $A$ contains a set which is not Lebesgue measurable. 
  \end{itemize}

\section{The middle-thirds Cantor set}
  Let $C$ be the middle-thirds Cantor set, defined as
  \[
    C:=\bigcap_{n=1}^\infty C_n,
  \]
 where
\[
  C_n:=\bigcup_{a_1, \dots, a_n\in \{0,2\}} \big[\sum_{i=1}^n \frac{a_i}{3^i}, \sum_{i=1}^{n} \frac{a_i}{3^i} +\frac{1}{3^n} \big]
\]
\begin{itemize}
\item[(a)]
  Set $C_0=[0,1]$. Show that $C_n\subset C_{n-1}$ for all $n\ge1$.
  Also prove that $C_n$ is the union of $2^n$ \emph{disjoint} closed intervals, that the set  $U_n:=C_{n-1}\setminus C_n$ is the union of the middle thirds open intervals of the disjoint closed intervals of $C_{n-1}$, and that
\[
  U_n=\bigcup_{a_1, \cdots, a_{n-1}\in \{0,2\}} \big( \sum_{i=1}^{n-1} \frac{a_i}{3^i} + \frac{1}{3^n}, \sum_{i=1}^{n-1} \frac{a_i}{3^i} +\frac{2}{3^n} \big).
\]
(We interpret this as the interval $(1/3,2/3)$ when $n=1$.)
  Thus, $C$ is the set obtained by removing successive middle thirds of the remaining disjoint closed intervals starting with $[0,1]$. Sketch the first few sets $C_n$ and $U_n$.
\item[(b)]
  Show that $C$ is a compact set, and that $m(C)=0$, where $m$ denotes Lebesgue measure. Also show that $C$ does not contain any non-empty open interval $(a,b)$. 
\item[(c)]
  Show that $C$ equals the set of numbers $x\in [0,1]$ which have a base-3 expansion of the form
  $x=0.a_1a_2a_3\cdots$ where $a_i$ is either $0$ or $2$, i.e.\
  \[
    C=\{ \sum_{i=1}^\infty \frac{a_i}{3^i} \mid \text{ $a_i\in \{0,2\}$ for all $i\in \mathbb{N}$} \}.
  \]
  (Note: A point may have two base-3 expansions such as $1/3=0.1000\ldots=0.0222\ldots$; this number is in $C$ since one of the expansions is of the desired form.) 
\item[(d)]
  Show that $\frac14, \frac9{13}\in C$ but $\frac{5}{36}\notin C$.
\end{itemize}

\section{The Devil's Staircase: an increasing function build on Cantor set}

  Let $C$ be the middle-thirds Cantor set, and define $F\colon C\to [0,1]$ by
  \begin{equation}\label{eq:Cantorfunctiondefn}
    F(x)= \sum_{i=1}^\infty \frac{a_i/2}{2^i}
  \end{equation}
  for $x=\sum_{i=1}^\infty \frac{a_i}{3^i}$, $a_i\in \{0, 2\}$. 
  \begin{itemize}
  \item[(a)]
    Prove that $F$ is an increasing function, and that $F(C)=[0,1]$.
  \item[(b)]
    Suppose that $x,y\in C$ and $x<y$. Prove that $F(x)=F(y)$ iff $x$ and $y$ are the endpoints of a removed open interval, that is, one of the $2^{n-1}$ disjoint open intervals whose union equals $U_n=C_{n-1}\setminus C_n$ for some $n\ge1$.
  \item[(c)]
    Prove that $F\colon C\to[0,1]$ extends uniquely to a continuous function which is constant on all the intervals in $U_n$, $n\ge 1$. Sketch the graph of $F$.
    \textit{Hint}: to prove continuity, it suffices to show that $F([0,1])=[0,1]$ (Why?)
  \item[(d)]
    Prove that $F'(x)=0$ for a.e.\ $x$. In other words, there exists a set $E\subset[0,1]$ such that $m(E)=0$, and such that $\lim_{h\to 0}(F(x+h)-F(x))/h=0$ for $x\in[0,1]\setminus E$.
  \end{itemize}
  (Remark 1: because of~(c) and~(d), the graph of $F$ is called the \emph{Devil's Staircase}; it is horizontal almost everywhere, and has no vertical jumps, but nevertheless climbs upwards.)

  (Remark 2: the fact that $F(C)=[0,1]$ implies that $C$ has the same cardinality as $[0,1]$, in particular the Cantor set is uncountable.) 


\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in}.
\end{center}


\section{fun facts about distribution functions}
  \begin{itemize}
  \item[(a)]  Let $A\subset\mathbb{R}$ be a countable set. Exhibit a distribution function $F$ that is discontinuous at every point in $A$, but continuous everywhere else. Justify your answer. \textit{Hint}: play around with the Heaviside function.
  \item[(b)]Let $F\colon\mathbb{R}\to\mathbb{R}$ be an increasing function. Prove that there exists a unique distribution function $G$ such that $G(x)=F(x)$ for all points $x$ where $F$ is continuous.
    \textit{Hint}: there is a simple formula for $G$ in terms of $F$.
  \end{itemize}

\begin{solution} \textbf{of (a):}\\
We list \( A = \{a_n\}_{n=1}^{\infty} \) as a sequence to label its elements. Define:
\[
F(x) = \sum_{n=1}^{\infty} \frac{1}{2^n} H(x - a_n)
\]
where \( H(x) \) is the Heaviside function: \(
H(x) =
\begin{cases}
0, & x < 0, \\
1, & x \geq 0.
\end{cases}
\).\\
\textbf{Claim 1.1 $F$ is non-decreasing}.\\
Proof: Suppose $y > x \in \mathbb{R}$, then $H(y-a_n) \geq H(x-a_n)$ for each $n \in \mathbb{N}$, so we have $F(y) \geq F(x)$.\\\\
\textbf{Claim 1.2 $F$ is right continuous but not left continuous (thus discontinuous) at every $a_n$.}\\
Proof: Let $\epsilon > 0$.\\
We take $N \in \mathbb{N}$ s.t. $\sum_{k\geq N, n\in \mathbb{N}} \frac{1}{2^k} < \epsilon$.\\
Then we take $\delta>0$ such that $a_1, a_2,\cdots, a_N \not \in (a_n, a_n+\delta)$.(This can be done since there are only finite points here)\\
Thus $\forall y \in (a_n, a_n+\delta)$, we have $|F(y) - F(a_n)| < \epsilon$, since $F(y) < F(a_n) + \sum_{k\geq N, n\in \mathbb{N}} \frac{1}{2^k}$.
Since $\epsilon$ is arbitrary, this finishes the proof that $F$ is right continuous at $a_n$.\\
Also, $\forall y < a_n$, we have $F(y) < F(a_n) - \frac{1}{2^n}$, which means that $|F(y) -F(a_n)|>\frac{1}{2^n}$ for any $y$ on the left, so $F$ is not left continuous at $a_n$.\\\\
\textbf{Claim 1.3: $F$ is continuous at every $x \in \mathbb{R} \setminus A$.}\\
Proof: This is similar to the proof in Claim 1.2. \\
Fix $x \in \mathbb{R} \setminus A$. Let  $\epsilon > 0$.\\
We take $N \in \mathbb{N}$ s.t. $\sum_{k\geq N, n\in \mathbb{N}} \frac{1}{2^k} < \epsilon$.\\
Then we take $\delta>0$ such that $a_1, a_2,\cdots, a_N \not \in (a_n-\delta, a_n+\delta)$. This can be done since there are only finite points here.\\
Thus $\forall y \in (a_n-\delta, a_n+\delta)$, we have $|F(y) - F(a_n)| <\sum_{k\geq N, n\in \mathbb{N}} \frac{1}{2^k} <  \epsilon$.\\\
Since $\epsilon$ is arbitrary, this finishes the proof that $F$ is continuous at $x$.\\\\

By claim 1.1, 1.2, 1.3, we have proved that $F$ is a distribution function that is discontinuous at every point of $A$ but continuous elsewhere.\\\\
\end{solution}

\begin{proof} \textbf{of (b):}\\
Given an increasing function \( F: \mathbb{R} \to \mathbb{R} \), we define $G:\mathbb{R} \to \mathbb{R}$ by:
\[
G(x) = \lim_{y \to x^+} F(y).
\]
We will show that this is the unique distribution function $G$ such that $G(x)=F(x)$ for all points $x$ where $F$ is continuous.\\
\textbf{Incresing:} Since \( F \) is increasing, for any \( x < y \) we have \( F(x) \le F(y) \). Thus, for any \( x < y \) we have:
\[
G(x) = \lim_{z \to x^+} F(z) \le \lim_{z \to y^+} F(z) = G(y).
\]
Thus, \( G \) is increasing.\\
\textbf{Right-continuity:} Since $F$ is an increasing function, it can only have jump discontinuities, and the right limit exists for all $X$. By construction, $G$ is right-ctn.\\
Above finishes the proof that $G$ is a distribution function.\\
\textbf{Agree with $F$ at ctn point:} $G(x) = F(x)$ where $F$ is continuous at $x$, since $G(x) = \lim_{y\to x^+} F(y) = F(x) $ there.\\

It remains to show that it is unique.\\
Suppose $R$ is another such function. It suffices to show: $R $ agrees with $G$ on discontinuous points of $F$.\\
Since $R,G$ are right continuous, their right limit must exist at each point. Therefore, let $x$ be an arbitrary point where $F$ is discontinuous at $x$, \textbf{it suffices to show that there is a sequence $\{x_n\}$ approaching $x$, such that $\lim_n G(x_n)  = \lim_n R(x_n)$.}\\
Since $F$ is increasing, the points where $F$ is disctn is at most countable. Therefore\textbf{ the points where $F$ is ctn, denote it as $C$, is dense in $\mathbb{R}$.} Thus we can pick a sequence $\{x_n\}$ in $C$ approaching $x$, then $G(x_n) = R(x_n) = F(x_n)$ for each $n$, impling that $\lim_n G(x_n)  = \lim_n R(x_n)$. This finishes the proof of uniqueness.

\end{proof}



\begin{comment}
Claim 1: 任何 $F: \mathbb{R} \to \mathbb{R}$ 如果是 increasing 的, 它的不连续点一定可数. 从而连续点一定稠密. 
假设 R(x) 是一个在连续点上和 F(x) 相同的 distribution function. Take arbitrary $y$ where F is not ctn on $Y$.
\end{comment}




\section{Finding intervals}
  Let $E\subset\mathbb{R}$ be a Lebesgue measurable subset with $m(E)>0$. Prove that for every $\alpha\in(0,1)$ there exists an (nonempty) bounded open interval $I$ such that $m(E\cap I)\ge\alpha m(I)$.
  \textit{Hint}: first reduce to the case when $E$ is bounded, then use outer regularity.
\begin{proof}
Let $\alpha \in (0,1)$ be arbitrary and fix it.\\
We first consider the case that $E$ is bounded. By outer regularity of Lebesgue measure, there exists an open set \( G \) such that

\[
E \subset G \quad \text{and} \quad m(G) - m(E) \leq  (1/\alpha-1) \; m(E)
\]
since $\alpha \in (0,1)$.
Then we have:
$$
m(G) \leq  1 / \alpha \; m(E)
$$
Note that in $\mathbb{R}$, an open set is just a countable disjoint union of open intervals. We write:
$$
G = \bigsqcup_{i\in \mathbb{N}} I_i
$$
Since $E \subset G$, we have:
$$
E = \bigsqcup_{i\in \mathbb{N}}  (I_i \cap E)
$$
Thus 
$$
m(E) = \sum_{i\in \mathbb{N}}  m(I_i \cap E) \geq \alpha \sum_{i\in \mathbb{N}} m(I_i)
$$
So \textbf{there must exist some $i$ such that $m(I_i \cap E) \geq \alpha \, m(I_i)$, otherwise contradicting with the ineq above.}\\
This finishes the proof of the bounded case.\\
The we consider the case when $E$ is unbounded. 
We can write
\[
E = \bigsqcup_{n\in \bZ} (E \cap (n, n+1]) 
\]
where each $E_n :=E \cap (n, n+1]$ is bounded.\\
We apply the case where $E$ is bounded, confirming that there is some interval $I$ such that $m(E_1\cap I)\ge\alpha m(I)$. By monotonicity of measure, we have $m(E \cap I) \geq m(E_1 \cap I) \geq \alpha m(I)$.
\end{proof}




\section{So many differences}
  Let $E\subset\mathbb{R}$ be a Lebesgue measurable subset with $m(E)>0$.
  \begin{itemize}
  \item[(a)]
    Prove that the set
    \[
      E-E:=\{x-y\mid x,y\in E\}\subset\mathbb{R}
    \]
    contains a nonempty open interval centered at the
    origin. \textit{Hint}: use the previous exercise with $\alpha$
    large enough, together with the translation invariance of Lebesgue
    measure.
  \item[(b)]
    Prove that there exists $\epsilon>0$ such that $E\times E\subset\mathbb{R}^2$ intersects every line $y=x+t$ with $|t|<\epsilon$.
  \item[(c)]
    Let $C\subset\mathbb{R}$ be the middle-third Cantor set (so $m(C)=0$). Does $C-C$ contain a nonempty open interval centered at the origin?
  \end{itemize}  
\begin{proof}
\textbf{of (a): }\pic[0.65]{hw3.assets/image-20250131212105730.png}
\pic[0.7]{hw3.assets/image-20250131212120558.png}
\end{proof}

\begin{proof}
    \textbf{of (b):}\\
    Consider taking $\epsilon$ as the one in (a) where the interval contained in $E-E$ is $(-\epsilon, \epsilon)$, then the box $(-\epsilon, \epsilon) \times (-\epsilon, \epsilon)$ is contained in $E\times E$. It trivially follows that $E\times E\subset\mathbb{R}^2$ intersects every line $y=x+t$ with $|t|<\epsilon$, since the intercept of this line with $y$-axis is below $\epsilon$ and above $-\epsilon$.
    \pic[0.25]{hw3.assets/image-20250131212337897.png}
\end{proof}

\begin{solution}
        \textbf{of (c):} $C-C$ contain a nonempty open interval centered at the origin, and we will prove that one such interval is $(-1,1)$.
\begin{proof}
Recall the balanced ternary representation of $[-1/2, 1/2]$: $\forall x\in [-1/2, 1/2]$, there is a seq of $(a_n)_{n\in\mathbb{N}} $ in $\{-1,0,1\}$ s,t,
\[
x=\sum_{n=1}^\infty \frac{a_n}{3^n},\qquad a_n\in\{-1,0,1\},
\]
Thus every $x\in [-1,1]$ can be halved, ternary expanded and then doubled to recover:
\begin{align}
    x=2\sum_{n=1}^\infty \frac{a_n}{3^n} &= \sum_{n=1}^\infty \frac{2a_n}{3^n},\qquad a_n\in\{-1,0,1\} \\
    &= \sum_{n=1}^\infty \frac{b_n}{3^n},\qquad b_n\in\{-2,0,2\} 
\end{align}

And by the problem "The middle-thirds Cantor set", we learned that \[
    C=\{ \sum_{i=1}^\infty \frac{a_i}{3^i} \mid \text{ $a_i\in \{0,2\}$ for all $i\in \mathbb{N}$} \}.
  \]
Therefore we can write every number $x \in [-1, 1]$ into a difference of two $x,y \in C$, i.e. an element of $C-C$:
\begin{align}
    x &= \sum_{n=1}^\infty \frac{b_n}{3^n},\qquad b_n\in\{-2,0,2\} \\
    &= \sum_{n=1}^\infty \frac{p_n-q_n}{3^n},\qquad p_n,q_n\in\{-2,0,2\}\\
    &= \sum_{n=1}^\infty \frac{p_n}{3^n} - \sum_{n=1}^\infty \frac{q_n}{3^n},\qquad p_n,q_n\in\{-2,0,2\}
\end{align}
since each series converges independently. Here we let $p_n = 2, q_n = 0$ if $b_n = 2$; $p_n = 0, q_n = 2$ if $b_n = -2$, $p_n = 0, q_n = 0$ if $b_n = 0$.\\
Thus $x \in C-C$, so $[-1,1] \subset C-C$.
\end{proof}

\end{solution}


\section{a holey set}
  Let $(x_n)_1^\infty$ be a countable dense sequence in $(0,1)$. For each $t>0$, consider the set
  \[
    A_t:=[0,1]\setminus\bigcup_{n=1}^\infty(x_n-2^{-n}t,x_n+2^{-n}t).
  \]
  \begin{itemize}
  \item[(a)]
  Prove that $A_t$ is a compact (possibly empty) subset of $\mathbb{R}$. Also prove that $A_t$ has empty interior, that is, $A_t$ contains no nonempty open set.
\item[(b)]
  Prove that $t\mapsto m(A_t)$ is continuous.
\item[(c)]
  Prove that there exists $t>0$ such that $m(A_t)=597/2025$.
\end{itemize}
\begin{proof}
   \textbf{ of a:}
   \pic[0.7]{hw3.assets/image-20250131221847429.png}
\end{proof}
\begin{proof}
   \textbf{ of b:}
Define for each $n\in \mathbb{N}$
$$
I_n(t) = (x_n - 2^{-n}t, x_n + 2^{-n}t)
$$
Then $$A_t = [0,1] \setminus \bigcup_{n=1}^\infty I_n(t)$$So
$$
m(A_t) = m([0,1]) - m(\bigcup_{n=1}^\infty I_n(t)) = 1 - m(\bigcup_{n=1}^\infty I_n(t))
$$

\textbf{Thus it suffices to show $t \mapsto m(\bigcup_{n=1}^\infty I_n(t))$ is continuous.}

Let $\epsilon >0$.
Let $t >0$.\\
We consider $p \in (t, t+\epsilon/2)$:

By set inclusion relation and measure's property, we have:
\begin{align}
    m(\bigcup_{n=1}^\infty I_n(p)) -    m(\bigcup_{n=1}^\infty I_n(t)) &=  m(\bigcup_{n=1}^\infty I_n(p) \setminus \bigcup_{n=1}^\infty I_n(t))
\end{align}
Since 
$$
(\bigcup_{n=1}^\infty I_n(p)) \setminus (\bigcup_{n=1}^\infty I_n(t)) \subset \bigcup_{n=1}^\infty (I_n(p) \setminus I_n(t))
$$
We have:
\begin{align}
      m(\bigcup_{n=1}^\infty I_n(p)) -    m(\bigcup_{n=1}^\infty I_n(t))  &\leq m(\bigcup_{n=1}^\infty (I_n(p) \setminus I_n(t)))\\
      & \leq \sum_{n=1}^\infty (m(I_n(p)) - m(I_n(t)))\\
      &= \sum_{n=1}^\infty 2 \cdot 2^{-n}(p-t) \\
      & = 2(p-t) \\
      & \leq \epsilon
\end{align}

Similarly for $p \in (t-\epsilon/2,t)$, we get the same bound. This finishes the proof pf (b).
\end{proof}
\begin{proof}
 \textbf{   of c:\\}
 We use the same notation of $I_n(t)$ as in (b). We have:
 $$
 m(\bigcup_{n=1}^\infty I_n(t) )  \leq  \sum_{n=1}^\infty m(I_n(t)) = \sum_{n=1}^\infty m(I_n(t)) =  \sum_{n=1}^\infty2\cdot 2^{-n} t = 2t.
 $$
 So by choosing $t:= 1/6$, we have $m(A_t) = 1 -  m(\bigcup_{n=1}^\infty I_n(t) ) \geq 2/3$.
 And by choosing $t:= 4$, $I_1(t)$ covers an interval of length $4$, so $A_t = \varnothing$, $m(A_t) = 0$.
 By intermediate value theorem, there exists some $t \in(1/6, 4)$ such that $m(A_t)=597/2025$.
\end{proof}


\section{a Cantor measure}
  (A Cantor measure.)
  Let $E\subset \mathbb{R}$ be a nonempty compact set with the following property: for every $x\in E$ and every $\epsilon>0$, the set $(x-\epsilon,x)\cup(x,x+\epsilon)$ has nonempty intersection with both $E$ and $E^c$. Prove that there exists a Borel measure $\mu$ on $\mathbb{R}$ with the following properties:
  \begin{itemize}
  \item[(i)]
    if $I\subset \mathbb{R}$ is a nonempty open interval, then $\mu(I)>0$ iff $I\cap E\ne\emptyset$.
  \item[(ii)]
    $\mu(\{x\})=0$ for all $x\in\mathbb{R}$; 
  \item[(iii)]
    $\mu(\mathbb{R})=0.597597597\dots$.
  \end{itemize}
  \textit{Hint}: set $\mu=\mu_F$, where $F$ is a distribution function whose graph is similar to the Devil's staircase above.
 
\begin{proof}
   Write $T:=0.597597597\dots$\\
    Since $E$ is compact, $E^c$ is open.  Also, since $E$ is compact, it takes min and max element.\\
    Thus we consider $A:= E^c \cap (\min E, \max E)$, this is an open set. We know any open set in $\mathbb{R}$ is a countable disjoint union of open intervals, so $A:=E^c \cap (\min E, \max E)  = \bigsqcup_{n=1}^\infty I_n$ for some disjoint intervals $I_1 = (a_1,b_1), I_2=(a_2,b_2), \cdots$ .\\\\
Now we construct a function $G: A \rightarrow [0,T)$ by sending $G(x) = \sum_{b_i \leq a_N} \frac{T}{2^n}$, for $x \in I_N$.\\
This is an \textbf{increasing step function} since, each $I_n$ is disjoint and on a fixed interval $I_N$, the number of $b_i$ that its $a_N$ surpasses is constant. And suppose $y>x$ is on $I_M$, we have must $G(y) \geq G(x)$ because he number of $b_i$ that $a_M$ surpasses is at least at many as that $a_N$ surpasses. \\
And for each $x \in A$, we have \textbf{$G(x) < T$}, by geometric series\\
Then we construct $F$ out of $G$, define:
$$
F:= \begin{cases}
    0, \quad \quad x \leq \min E\\
    \inf {\{G(y) \mid y \geq x, y\in A} \}, \quad \quad x \in (\min E, \max E)\\
    T, \quad \quad x \geq \max E\\
    
\end{cases}
$$
\textbf{$F$ is increasing:} It is constant on $(-\infty, \min E) \cup (\max E, \infty)$ and is the infimum of $G(y)$ with $y\geq x$ on $(\min E, \max E)$. Since $G$ is increasing, $F$ is also increasing.\\
\textbf{$F$ is right continuous:} It suffices to prove the right-continuity of $F$ on $x \in E^c \cap (\min E, \max E)$. \\
Fix $x_0 \in E^c \cap (\min E, \max E)$.\\
Let $\epsilon > 0$. \\
Let $k \in \mathbb{N}$ such that $\epsilon > \frac{T}{2^k+1}$.\\
We define for each $y$, $S_y := \{b_i \mid x_0 \leq  b_i  \leq y\}$ as the set of all $b_i$ (right endpoint of $I_k$) that is witin $x_0$ and $y$. Note that $I_z \subset I_y$ for all $y > z$.\\
Consider $y_1 := \min (\{b_1, \cdots, b_k\} \setminus S_x)$.\\
Then for all $y \in (x_0,y_1)$, we have:
$$
F(y)  \leq F(x_0)  + \sum_{i=k}^\infty \frac{T}{2^i} \leq F(x_0) + \epsilon
$$
By defining $\delta : = y_1 - x_0$, we have shown the right continuity of $F$.\\
(By dual reason, we can prove that $F$ is left continuous. So $F$ is actually continuous.)
Above, we have shown that $F$ is a distribution function.\\\\
Now let $\mu_F$ be the Lebesgue-Stieljes measure associated with $F$. We will prove for the three properties above:\\
\begin{itemize}
    \item[(i)] Let $\{x\}$ be a singleton set in $\mathbb{R}$, for each $n\in \mathbb{N}$, we can construct an h-intervals seq of covering of $\{x\}$ by $(x-1/n,x]$ as the first covering set and $\varnothing$ as all other covering sets.\\
Then by the definition of $\mu_F$, we have:
$$
\mu_F(\{x\}) = \inf_{n\in\mathbb{N}} (F(x) - F(x-1/n))
$$
By continuity, it shows that $\mu_F(\{x\}) = 0$.
\item[(ii)] $$ \mu_F(\mathbb{R}) = \lim_{x \to \infty} F(x)  -  \lim_{x \to -\infty}  F(x)  = T-0 = T = 0.597597597\cdots$$

\item[(iii)] Let $I = (a,b)$ be a nonempty open interval.\\
Suppose $\mu(I)>0$, then $F(b) - F(a) > 0$, so by definition of $G$, some must be at least two different intervals $I_{n_1}$, $I_{n_2}$ in $A$ such that for some $x,y \in (a,b)$, $x\in I_{n_1}$ and $y \in I_{n_2}$, thus $\exists$ some $e \in E$ such that $e \in (x,y)$. Thus $I\cap E\ne\emptyset$.\\
Suppose $I\cap E\ne\emptyset$. Let $e \in E \cap I$. Since $\forall \epsilon >0$, $(x-\epsilon,x) \cup (x,x+\epsilon)$ has nonempty intersection with both $E$ and $E^c$, $e$ has some open neighborhood $B_\epsilon(e) \subset I$, intersecting two different $I_N$, $I_M \subset A$. Take $n \in I_N$, $m \in I_m$. Then $F(m) - F(n) = G(m) - G(n) > 0$, so $\mu_F(E) \geq F(m) -F(n) > 0$ by monotinicity of measure.\\
This finishes the proof.


\end{itemize}

\end{proof}



`   

















\chapter{on measurable functions(36/40)}
\begin{center}
\textit{None of the following questions will be graded. Do them, but do not hand them in}.
\end{center}


\section{One with Vitali.}
  Let $(X,\mathcal{A})$ be a measurable space, and $E\subset X$ a subset. Prove that $E\in\mathcal{A}$ iff the function $\chi_E$ is measurable. Use this to construct a function  $f\colon\mathbb{R}\to\mathbb{R}$ that is not Lebesgue measurable.
  
\section{Truncations in $L^+$: 通过 $\int f_n$ 或者 $\int_{X_n} f$ 的极限 (bounded function / subset) 得到 $\int_X f$}
Let $(X,\mathcal{A},\mu)$ be a measure space and $f\colon X\to [0, \infty]$ a measurable function.
\begin{itemize}
\item[(a)] (Horizontal truncation) Suppose that $X=\bigcup_{n=1}^\infty X_n$ for some $X_1\subset X_2\subset \cdots$ 
with $X_n\in \mathcal{A}$. Prove that 
\[
  \int_X f \,d\mu = \lim_{n\to \infty} \int_{X_n} f\,d\mu
\]
\item[(b)] (Vertical truncation)
  Prove that
\[
  \int f\,d\mu = \lim_{n\to \infty} \int \min\{ f,  n\}\,d\mu.
\]
\item[(c)]
  Explain the terminology ``horizontal truncation'' and ``vertical truncation''.
\end{itemize}

\section{Disregarding null sets.}
  Let $(X,\mathcal{A},\mu)$ be a \emph{complete} measure space.
  \begin{itemize}
  \item[(a)]
    Let $f\colon X\to \overline{\mathbb{R}}$ and $g\colon X\to \overline{\mathbb{R}}$ be functions such that $f=g$ $\mu$-a.e.
    \begin{itemize}
    \item[(i)]
      Prove that $f$ is measurable (i.e.\ $\mathcal{A}$-measurable) iff $g$ is measurable.
    \item[(ii)]
      Prove the same statement when $f$ and $g$ are $\mathbb{C}$-valued, rather than
      $\overline{\mathbb{R}}$-valued.
    \item[(iii)]
      Give examples showing that the condition that $\mu$ be complete is necessary.
    \end{itemize}
  \item[(b)]
    Let $f_n : X \to  \overline{\mathbb{R}}$, $n\in\mathbb{N}$, and $f\colon X\to \overline{\mathbb{R}}$ be functions such that $\lim_{n\to\infty}f_n(x)=f(x)$ for a.e. $x\in X$. 
    \begin{itemize}
    \item[(i)]
      Prove that if $f_n$ is measurable for all $n$, then so is $f$.
    \item[(ii)]
      Prove the same statement when $f_n$ and $f$ are $\mathbb{C}$-valued, rather than
      $\overline{\mathbb{R}}$-valued.
    \item[(iii)]
      Give examples showing that the condition that $\mu$ be complete is necessary.
    \end{itemize}
  \end{itemize}
  \textit{Hint}: this is Proposition 2.11 of [Folland].
  
\section{Measurable functions and completions.}
  Let $(X,\mathcal{A},\mu)$ be a measure space and let $(X, \bar{\mathcal{A}}, \bar{\mu})$ be its completion. 
Suppose that $f\colon X\to\overline{\mathbb{R}}$ is $\bar{\mathcal{A}}$-measurable. Prove that there is an $\mathcal{A}$-measurable function $g\colon X\to\overline{\mathbb{R}}$ such that $g=f$ $\bar{\mu}$-a.e.,  and hence $\int g  \;d\mu=\int f \;d\bar{\mu}$. 
\textit{Hint}: this is Proposition 2.12 of [Folland].

\section{Measurability on subsets.}
  Let $(X,\mathcal{A})$ be a measurable space, and $Y\subset X$ a nonempty subset.
  We say that a function $g\colon Y\to\overline{\mathbb{R}}$ is \emph{$\mathcal{A}$-measurable on $Y$} if $g$ is $\mathcal{A}|_Y$-measurable, where the $\sigma$-algebra $\mathcal{A}|_Y$ on $Y$ is defined as in HW1.
  \begin{itemize}
  \item[(a)]
    Prove that if $f\colon X\to\overline{\mathbb{R}}$ is measurable and $Y\subset X$, then $g=f|_Y$ is $\mathcal{A}$-measurable on $Y$. 
  \item[(b)]
    Prove that if $g$ is $\mathcal{A}$-measurable on $Y$ and $Y\in \mathcal{A}$, then $g$ can be extended to an $\mathcal{A}$-measurable function $f$ on $X$. Is the extension unique?
  \item[(c)]
    Let $f\colon X\to\overline{\mathbb{R}}$ be any function, and set $Y=f^{-1}(\mathbb{R})$. Prove that $f$ is measurable iff $f^{-1}(\{\infty\})\in \mathcal{A}$, $f^{-1}(\{-\infty\})\in \mathcal{A}$, and 
    $f|_Y\colon Y\to\mathbb{R}$ is $\mathcal{A}$-measurable on $Y$.
  \end{itemize}

\section{Suprema of uncountable families.}
  Construct (using the Axiom of Choice, if needed) an \emph{uncountable} family $(f_\alpha)_\alpha$ of real-valued Borel measurable functions on $\mathbb{R}$ such that the function $\sup_\alpha f_\alpha$ is not Lebesgue measurable, let alone Borel measurable.

\section{Increasing functions again.}
  Let $f\colon\mathbb{R}\to\mathbb{R}$ be an increasing function. Prove that $f$ is Borel measurable. Use this to give an example of a function $f\colon\mathbb{R}\to\mathbb{R}$ that cannot be written as a difference between increasing functions.

\section{Lebesgue but not Borel.}
  Let $F\colon[0,1]\to[0,1]$ be the function from HW3, whose graph is the Devil's Staircase. Define $G(x)=F(x)+x$. 
  \begin{itemize}
  \item[(a)]
    Prove that $G:[0,1]\to [0,2]$ is an increasing homeomorphism. In other words, $G$ is increasing, bijective, and both $G$ and $G^{-1}$ are continuous. 
  \item[(b)]
    Let $C$ be the middle-thirds Cantor set, and set $K:=G(C)$. Prove that $m(K)=1$. 
  \item[(c)]
    Since $m(K)>0$, we know from HW3 that there is a set $A\subset K$ that is not 
    Lebesgue measurable. Prove that $B=G^{-1}(A)$ is Lebesgue measurable but not 
    Borel measurable. 
  \end{itemize}

\section{Measurability and absolute values.}
  Let $(X,\mathcal{A})$ be a measure space. 
  Suppose that $f\colon X\to\mathbb{C}$ is a measurable function. Prove that the function $|f|\colon X\to\mathbb{R}$ is also measurable. Is the converse true? 



  
\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in. You may use the results from the exercises above}.
\end{center}



\section{Measurability of limit loci.}
  Let $(X, \mathcal{A})$ be a measurable space. For each $n\in \mathbb{N}$, let $f_n\colon X\to \mathbb{R}$ be a measurable function. Consider the set
  \[
    E:=\{x\in X\mid\lim_{n\to\infty} f_n(x)\ \text{converges to a real number}\}.
  \]
  Prove that $E$ is a measurable set in two ways:
  \begin{itemize}
  \item[(i)]
    by expressing $E$ in terms of the functions $g(x)=\displaystyle\limsup_{n\to \infty} f_n(x)$ and
    $h(x)= \displaystyle \liminf_{n\to \infty} f_n(x)$;
  \item[(ii)]
    by expressing $E$ in terms of the sets
    \[
      E_{i,j,k}=\{x\mid |f_j(x)-f_k(x)|<\tfrac1{i}\},
    \]
    where $i,j,k\in\mathbb{N}$.
    \textit{Hint}: a sequence $(a_n)_n$ of real numbers converges iff it is a Cauchy
    sequence, i.e. for every  $ \epsilon >0$
    there is $n$ such that for every $j,k\ge n$, $|a_j-a_k|< \epsilon$.
  \end{itemize}
  \textit{Hint}: note that $\pm\infty$ are not real numbers, and please avoid considering $\infty-\infty$; you may want to prove a lemma to the effect that if $g,h\colon X\to    \overline{\mathbb{R}}$ are measurable functions, then the set
  \[
    \{x\in X\mid g(x)=h(x)\in \overline{\mathbb{R}}    \}
  \]
  is measurable; to do this, you may want to consider functions like $\max\{g,\kappa\}$, $\min\{h,\kappa\}$ and $\min\{g,-\kappa\}$, $\min\{h,-\kappa\}$ for large real constants $\kappa>0$.

\begin{proof}
   \textbf{ of method (i):}\\
   Define:
\[
g(x):=\limsup_{n\to\infty} f_n(x) \quad\text{and}\quad h(x):=\liminf_{n\to\infty} f_n(x)
\]
Since each $f_n$ is measurable function, by proposition in lecture (sequential preservation of measurability), \textbf{$g,h$ are measurable.}

And as we know, for any real sequence \((a_n)\),
\[
\lim_{n\to\infty} a_n \text{ exists (as a real number)} \quad\Longleftrightarrow\quad \limsup_{n\to\infty} a_n = \liminf_{n\to\infty} a_n \in \mathbb{R}
\]

Thus, for each \(x\in X\) we have:
\[
x\in E \quad\Longleftrightarrow\quad \limsup_{n\to\infty} f_n(x)=\liminf_{n\to\infty} f_n(x)\in \mathbb{R}
\]

Thus, we can write $E$ as:
\[
E = \{x\in X \mid g(x)=h(x)\in \mathbb{R}   \}
\]

Note: here we want to have a difference function of the two functions, but it is undefined on $\infty - \infty$ type of points. So actually it is not valid to take the difference for functions mapping to $\overline{\mathbb{R}}$. This is why we use the following method instead:

For each \(n \in \mathbb{N}\), we define:
\[
g_n(x):=\min\{\max\{g(x), -n\}, n\} \quad \text{and} \quad h_n(x):=\min\{\max\{h(x), -n\},n\}
\]
Notice that, \textbf{each $g_n, h_n$ is measurable}, since $g,h$ are measurable and constant function is measurable and we have proved in lecture that taking the max, min of two measurable functions is measurable.\\\\
\noindent \textbf{Claim 1.1: \[
g(x)=h(x)\in\mathbb{R}\quad\Longleftrightarrow\quad \exists N_0>0,\ \forall n\ge N_0,\quad g_n(x)=h_n(x)
\]}
\noindent \textbf{proof of claim 1.1:}
Suppose $g(x)=h(x)\in\mathbb{R}$. Let \(M:=\max\{|g(x)|, |h(x)|\} < \infty\), then for any \(n> M\), we have
   \(
   g_n(x)=g(x),  h_n(x)=h(x)\), so \(g_n(x)=h_n(x)\). 

Suppose \(\exists N_0>0,\ \forall n\ge N_0,\quad g_n(x)=h_n(x)\), Then it is clear that  \[
 g(x) =  g_{N_0}(x) = h_{N_0}(x)=h(x) < \infty
   \]
\pic[0.35]{hw4.assets/33121738963658\_.pic.jpg}

\noindent \textbf{proof of remaining:}
Therefore we have:
\begin{equation}
    E = \bigcup_{N=1}^\infty \bigcap_{n\ge N} \{x\in X \mid g_{n}(x)=h_{n}(x)\}
\end{equation}
Foe each $n \in \mathbb{N}$, we define
\[
E_n := \{x\in X \mid  g_{n}(x)=h_{n}(x)\}
\]
Since each $g_n, h_n$ is measurable and real-valued (finite), $g_n - h_n$ is measurable and $|g_n - h_n|$ is measurable, so we have for each $m\in \mathbb{N}$,
\[
\{x\in X: |g_{\kappa_n}(x)-h_{\kappa_n}(x)|<1/m\}  = |g_n - h_n|^{-1} ([0,1/m)) \in \mathcal{A}
\]
Thus \[E_n = \bigcap_{m\in \mathbb{N}}|g_n - h_n|^{-1} ([0,1/m)) \in \mathcal{A}\] is a measurable set.
Thus $E$ is a countable union of countable intersections of mea
surable sets, then measurable. 
\end{proof}



\begin{proof}
    \textbf{of method (ii):}\\
Recall: \textbf{a seq of real numbers converges iff it is a Cauchy.}
Now we fix an arbitrary \(i\in\mathbb{N}\) and let \(\epsilon = 1/i\). Define:
\[
E_{i,j,k} = \{x\in X: |f_j(x)-f_k(x)| < 1/i\}
\]
Since each \(f_j\) is measurable, the function \(x\mapsto |f_j(x)-f_k(x)|\) is measurable (since each term in the sequence maps to $\mathbb{R}$ but not $\overline{\mathbb{R}}$), and hence \textbf{each \(E_{i,j,k} = |f_j(x)-f_k(x)|^{-1} ([0,1/i))\) is measurable.}\\\\
\noindent For each \(i\), consider the set of \(x\in X\) for which the sequence \((f_n(x))\) satisfies the Cauchy condition with respect to \(\epsilon=1/i\). That is,
\[
E_i = \Big\{x\in X:  \exists N\in\mathbb{N} \text{ s.t. } \forall j,k\ge N,\; |f_j(x)-f_k(x)|<\frac1{i}\Big\}
\]
We can write \(E_i\) as
\[
E_i = \bigcup_{N=1}^\infty \bigcap_{j,k\ge N} E_{i,j,k}
\]
Since countable unions and intersections of measurable sets are measurable, \textbf{\(E_i\) is measurable.}\\\\
\noindent Now, since \((f_n(x))\) converges in $\mathbb{R}$ i\textbf{ff it is Cauchy, i.e. it is in $E_i$ for each $i\in\mathbb{N}$}, we have:
\[
E = \bigcap_{i=1}^\infty E_i 
= \bigcap_{i=1}^\infty \Big(\bigcup_{N=1}^\infty \bigcap_{j,k\ge N} E_{i,j,k}\Big)
\]
This is a countable intersection of measurable sets, and therefore \(E\) is measurable.
\end{proof}


  
  
  \section{Measurability of continuity loci.}
    Let $(X,d)$ be a metric space, and $f\colon X\to\mathbb{C}$ any function. Prove that the set of points $x\in X$ such that $f$ is continuous at $x$ is a $G_\delta$-set, and in particular a Borel set.
    \textit{Hint}: consider sets of the form
    \[
      \{x\in X\mid |f(y)-f(z)|\le\tfrac1n\ \text{whenever $\max\{d(y,x),d(z,x)\}\le\delta$}\}
    \]
    and show off your skills with quantifiers.

\begin{proof}
Recall: \(f\colon X\to\mathbb{C}\) \textbf{from a metric space} is continuous at \(x\in X\) iff for every \(\varepsilon > 0\) there exists a \(\delta > 0\) such that\( |f(y)-f(x)| < \varepsilon \text{ whenever } d(y,x) < \delta \).
We can easily check that, \textbf{this condition is equivalent to}: for every \(\varepsilon > 0\) there exists a \(\delta > 0\) such that \(|f(y)-f(z)| < \varepsilon \quad \forall y,z \in B_\delta(x)\), by the relation of diameter and radius of the open ball).\\\\
Thus we have: 
\[
x \in C \Longleftrightarrow \forall n\in\mathbb{N},\ \exists m\in\mathbb{N} \text{ s.t.} y,z \text{ with } d(y,x) < \tfrac{1}{m} \text{ and } d(z,x) < \tfrac{1}{m},\; |f(y)-f(z)| < \tfrac{1}{n}
\]
In other words, \textbf{\(x\) is a continuity point iff it belongs to:}
\[
C = \bigcap_{n=1}^\infty \bigcup_{m=1}^\infty U_{n,m}.
\] where \[
U_{n,m} = \Big\{x\in X \mid  y,z\in B_\frac{1}{m} (x)\implies |f(y)-f(z)| < \tfrac{1}{n}\Big\}
\]
\textbf{Claim: \(U_{n,m}\) is open.}\\
\textbf{Proof of Claim:}\\
Let \(x\in U_{n,m}\). WTS: $\exists$ an \(\varepsilon > 0\) such that \(B_\varepsilon(x) \subset U_{n,m}\).\\
Consider: \(\varepsilon = \tfrac{1}{2m}\). \\
Let \(y \in B_\varepsilon(x)\). Take any two points \(z,w \in X\) satisfying
\[
d(z,y) < \tfrac{1}{2m} \quad \text{and} \quad d(w,y) < \tfrac{1}{2m}
\]
Then by the triangle inequality, we have:
\[
d(z,x) \le d(z,y) + d(y,x) < \tfrac{1}{2m} + \tfrac{1}{2m} = \tfrac{1}{m}
\]
Similarly, \(d(w,x) < \tfrac{1}{m}\).  Since \(x \in U_{n,m}\), it follows that
\[
|f(z) - f(w)| < \tfrac{1}{n}
\]
Thus, the condition defining \(U_{n,m}\) holds for \(y\), meaning \(y \in U_{n,m}\).  This proves that \(B_\varepsilon(x) \subset U_{n,m}\), thus $U_{n,m}$ is open since $x$ is arbitrary.\\\\
Therefore:
\[
C = \bigcap_{n=1}^\infty \bigcup_{m=1}^\infty U_{n,m}
\] is $G_\delta$ since each $ \bigcup_{m=1}^\infty U_{n,m}$ is a union of open sets, thus open; and $C$ is thus a countable intersection of open sets, namely a \(G_\delta\)-set. (thus Borel).

\end{proof}
\begin{comment}
\begin{remark}
  对于任意一个 metric space, 它的所有连续点构成的集合都是 countable 个 open sets 的交集.  
\end{remark}
\end{comment}   
    
\section{Measurability of differentiability loci.}
Let $f\colon\mathbb{R}\to\mathbb{R}$ be any function. Let us say (as usual) that $f$ is \textbf{\emph{differentiable}} at $x$ if there exists $\lambda\in \mathbb{R}$ such that $\lim_{y\to x}\frac{f(y)-f(x)}{y-x}=\lambda$. 
  
We also declare $f$ to be\textbf{ \emph{strongly differentiable} }at $x$ if there exists $\lambda\in \mathbb{R}$ with the following property: for each $\epsilon>0$ there exists $\delta>0$ such that if $|y-x|\le\delta$ and $|z-x|\le\delta$, then $|f(y)-f(z)-\lambda(y-z)|\le\epsilon |y-z|$.


  \begin{itemize}
  \item[(a)]Does $f$ being differentiable at $x$ imply that $f$ is strongly differentiable at $x$? Give a proof or a counterexample.
  \item[(b)]Prove that the set of points $x\in \mathbb{R}$ at which $f$ is strongly differentiable is a Borel set. \textit{Hint}: consider sets of the form    \[
      E_{\lambda,m,n}:=\{x\in \mathbb{R} \mid |f(y)-f(z)-\lambda(y-z)|\le\tfrac1n|y-z|\
      \text{whenever $\max\{|y-x|,|z-x|\le\tfrac1m$}\}.
      \]
  \item[(c)]\textit{Extra credit}: is the set of points $x\in \mathbb{R}$ at which $f$ is differentiable a Borel set?
  \end{itemize}
  
\begin{solution}
    \textbf{of (a):} No. Consider the following counterexample: \\
\[
f(x)=
\begin{cases}
x^2\sin\Bigl(\frac{1}{x}\Bigr), & x\neq 0\\
0, & x=0
\end{cases}
\]
We know that
\[
\frac{f(x)-f(0)}{x-0} = \frac{x^2\sin(1/x)}{x} = x\sin(1/x)
\]
Note \(|x\sin(1/x)|\le |x|\), so when \( x\to 0 \) we have:
\[
\lim_{x\to 0} x\sin(1/x) = 0
\]
Thus $f$ is differentiable at $0$ and \( f'(0)=0 \).

\begin{lemma}
 $f:\mathbb{R} \rightarrow \mathbb{ R}$ is strongly differentiable at $x$ $\implies$ it is differentiable at $x$, and $\lambda$ is uniquely equal to the derivative at $x$.
\end{lemma}
\begin{proof}
    \textbf{of lemma 4.1:}\\
   Suppose $f:\mathbb{R} \rightarrow \mathbb{ R}$ is strongly differentiable at $x$, so for any \(\epsilon>0\), there exists \(\delta>0\) s.t. for all $y,z\in B_\delta (x)$, we have: \[
\Bigl|f(y)-f(z)-\lambda(y-z)\Bigr|\le \epsilon\,|y-z|.
\]
Suppose $y\not = z$, then dividing by \(|y-z|\) on both sides, we have
\[
\Bigl|\frac{f(y)-f(x)}{y-x}-\lambda\Bigr|\le \epsilon
\]
Since $\epsilon$ is arbitrary, this proves that 
\[
f'(x) = \lim_{y\to x}\frac{f(y)-f(x)}{y-x}=\lambda  
\]
\end{proof}

Now we go back to the counterexample. Suppose for contradiction that $f$ is strongly differentiable at $0$, then $\lambda = 0$, so for all \(\epsilon>0\), there exist \(\delta>0\) s.t. for all $y,z \in B_\delta(0)$, we have
\[
|f(y)-f(z)| \le \epsilon\,|y-z|
\]
Consider \(\epsilon=\tfrac{1}{4}\). Let $\delta > 0$. Take $n\in\mathbb{N}$ s.t.
\[
\frac{1}{(2n+\tfrac{3}{2})\pi} < \delta
\]and then take
\[
y_n:= \frac{1}{\left(2n+\tfrac{1}{2}\right)\pi},\quad
z_n:= \frac{1}{\left(2n+\tfrac{3}{2}\right)\pi}
\]Note that each $|y_n|,|z_n| < \delta$. And we have \[
   \sin\Bigl[\Bigl(2n+\tfrac{1}{2}\Bigr)\pi\Bigr]=(-1)^n,\quad
   \sin\Bigl[\Bigl(2n+\tfrac{3}{2}\Bigr)\pi\Bigr]= -(-1)^n
   \]Thus \[
   f(y_n)-f(z_n)= (-1)^n\bigl[y_n^2+z_n^2\bigr]
   \]while 
\[
y_n-z_n = \frac{1}{\left(2n+\tfrac{1}{2}\right)\pi} - \frac{1}{\left(2n+\tfrac{3}{2}\right)\pi}
=\frac{1}{\pi\left(2n+\tfrac{1}{2}\right)\left(2n+\tfrac{3}{2}\right)}
\]
Taking limit of this behavior (increasing $n$), we get the sequential limit of \(\frac{|f(y_n)-f(z_n)|}{|y_n-z_n|} \) indexing over $n$ is $\frac{\frac{1}{2\pi^2 n^2}}{\frac{1}{4\pi n^2}} = \frac{2}{\pi}$.
By taking large enough $n$, we can alwasy get \(\frac{|f(y_n)-f(z_n)|}{|y_n-z_n|} \) to be arbitrarily close to \( \frac{2}{\pi}> \frac{1}{4}\).
This shows that $f$ is not strongly differentiable at $0$.
\end{solution}


\begin{proof}
   \textbf{ of (b):}\\
Let $f\colon\mathbb{R}\to\mathbb{R}$ be any a function.Denote \[ E: = \{x\in \mathbb{R}\mid f \text{ is strongly differentiable at } x\}\]
WTS: $E$ is a Borel set.

Set for each $\lambda \in \mathbb{R}, m,n\in\mathbb{N}$: \[ E_{\lambda,m,n}:=\{x\in \mathbb{R} \mid |f(y)-f(z)-\lambda(y-z)|\le\tfrac1n|y-z|\   \;\; \forall y,z \in B_{\frac{1}{m}}(x)\}\]
where $ B_{\frac{1}{m}}(x)$ denote the open ball centered at $x$ with radius $\frac{1}{m}$.

Then by the definition of strongly differentiable, we have: \[
   E=\bigcup_{\lambda\in\mathbb{R}}\bigcap_{n\in\mathbb{N}}\bigcup_{m\in\mathbb{N}} E_{\lambda,m,n}\,
   \]
\noindent \textbf{Claim 3.1: Each $ E_{\lambda,m,n}$ is open.}\\
\textbf{Proof of Claim 3.1:} Let \(x\in E_{\lambda,m,n}\). Then
\[\forall y,z\in B_{1/m}(x),\quad \bigl|f(y)-f(z)-\lambda(y-z)\bigr|\le \frac1n\,|y -z|\]
In particular, the inequality holds for all \(y,z\in B_{1/(2m)}(x)\). Now consider $B_{1/(2m)}(x)$, let $x' \in B_{1/(2m)}(x)$, then for every \(y\in B_{1/(2m)}(x')\), we have \[
|y-x|\le |y-x'|+|x'-x|<\frac{1}{2m}+\frac{1}{2m}=\frac{1}{m} \]
so \(B_{1/(2m)}(x')\subset B_{1/m}(x)\). Hence the inequality holds for all \(y,z\in B_{1/(2m)}(x')\). This confirms that every \(x\in E_{\lambda,m,n}\) has a neighborhood contained in \(E_{\lambda,m,n}\), proving that \(E_{\lambda,m,n}\) is open.\\\\


Now that each $ E_{\lambda,m,n}$ is open, we have $\bigcup_{m\in\mathbb{N}} E_{\lambda,m,n}$ is each for each $\lambda , n$; thus each for each $\lambda$, \(\ G_\lambda := \bigcap_{n\in\mathbb{N}}\bigcup_{m\in\mathbb{N}} E_{\lambda,m,n}\) is a $G_\delta$ set.

\[E = \bigcup_{\lambda\in\mathbb{R}} G_\lambda \]
is a union of $G_\delta$ sets.

(I do not now how to deal with it then, it might be that we somehow reduce it to countable union of $G_\delta$ sets, getting something like $E = \bigcup_{\lambda\in\mathbb{Q}} G_\lambda $ using the density of $\mathbb{Q}$ in $\mathbb{R}$, thus confirming that it is Borel.)
\textcolor{red}{-2. 这里的正解是: 要利用 density of $\mathbb{Q}$ in $\mathbb{R}$ 的话, 只需要考虑交换 set operation 的顺序就好了. 我们会发现其实: \[
  E=\bigcap_{n\in\mathbb{N}} \bigcup_{\lambda\in\mathbb{Q}} \bigcup_{m\in\mathbb{N}} E_{\lambda,m,n}\,
\]就这么简单。。
}
\end{proof}
\begin{proof}
    of extra credit: \textcolor{red}{yes. 这个解法非常麻烦. 需要再多考虑两层. 
令 $E_{\lambda, k,l,m,n}$ 表示 the set of points $x$ s.t. \[
|f(y) - f(z) - \lambda (y-z) | \leq \frac{1}{n} |y-z|
\]
whenever \[
\frac{1}{2^{l+1}} (1 +\frac{1}{2^k}) \leq |y-x| \leq  \frac{1}{2^{l-1}} (1 -\frac{1}{2^k})  \quad \text{and} \quad |z-x| \leq \frac{1}{2^m} (1 -\frac{1}{2^k}) 
\]
Claim: \[
 f  \text{ is differentiable at x} \text{ iff }     x \in E:= \bigcap_{n\in\mathbb{N}} \bigcup_{\lambda \in\mathbb{Q}} \bigcup_{l \in \mathbb{N}} \bigcap_{r \geq l} \bigcup_{m\geq 1} \bigcup_{k \in \mathbb{N}}    E_{\lambda, k,r,m,n}
\]
}
\end{proof}

  
\section{decreasing MCT: 成立当且仅当 integral 的 limit 是 finite 的}
  Let $(f_n)_1^\infty$ be a \emph{decreasing} sequence of non-negative measurable functions on a measure space. 
  \begin{itemize}
  \item[(a)]  Prove that if $\lim_n\int f_n<\infty$, then $\lim_n\int f_n=\int\lim_nf_n$. 
  \item[(b)]Give an example of a decreasing sequence $(f_n)_n$ of nonnegative measurable functions such that $\lim_n\int f_n\ne\int\lim_nf_n$. 
  \end{itemize}
  \textit{Hint}: use MCT correctly. 

\begin{proof}
\textbf{of (a):}\\
Since \((f_n)\) is a decreasing sequence, i.e. for every \(x\in X\) we have
\[
f_1(x) \ge f_2(x) \ge f_3(x) \ge \cdots 
\]
We can define the function
\[
g_n(x) = f_1(x) - f_n(x)
\] for each $n \in \mathbb{N}$. Then for the seq $(g_n(x))$ we have:
\begin{itemize}
    \item non-negatice: \(g_n(x) \ge 0 \;\; \forall x\) because \(f_1(x) \ge f_n(x)\).
    \item  increasing in $n$:\[
  g_n(x) = f_1(x) - f_n(x) \le f_1(x) - f_m(x) = g_m(x) \;\;\forall  m\geq n, \forall x
  \] since \((f_n)\) is decreasing.\\\\
\end{itemize}

Define $f(x) := \lim_n f_n(x) \in \overline{\mathbb{R}}$ for each $x \in X$.

Since \(f_n(x)\) decreases to \(f(x):=\lim_{n\to\infty} f_n(x)\), we have \[
  \lim_{n\to\infty} g_n(x) = f_1(x) - \lim_{n\to\infty} f_n(x) = f_1(x) - f(x)
  \]
Now we \textbf{apply MCT to the increasing sequence \((g_n)\)}. We have:
\[
\lim_{n\to\infty} \int g_n\,d\mu = \int \Bigl(\lim_{n\to\infty} g_n\Bigr)\,d\mu = \int (f_1 - f)\,d\mu
\]
And since \(\lim_{n\to\infty}\int f_n\,d\mu < \infty\), we have\[
\lim_{n\to\infty} \int g_n\,d\mu = \int f_1 \, d\mu - \int f \;d\mu
\] Also, because of \(\lim_{n\to\infty}\int f_n\,d\mu < \infty\), \textbf{$\int f_n $ is eventually finite}. Say, it is finite after $n\geq N \in \mathbb{N}$. We only need to consider $n\geq N$ when considering the limit behavior.\\
Then for each \(n \geq N\),
\[
\int g_n\,d\mu = \int \bigl(f_1 - f_n\bigr)\,d\mu = \int f_1\,d\mu - \int f_n\,d\mu
\]
\textcolor{red}{-2. 这里注意, 我们既然知道 $f_1$ 的 integral 未必 finite, 就不能这么定义 $g_n$. 正解是取 $N$ s.t. $\int f_N$ finite, 然后定义 $g_n := f_N - f_n$.}
Taking the limit as \(n\to\infty\), have
\[
\lim_{n\to\infty} \int g_n\,d\mu = \lim_{n\to\infty} \left(\int f_1\,d\mu - \int f_n\,d\mu\right) = \int f_1\,d\mu - \lim_{n\to\infty} \int f_n\,d\mu
\]
by linearity of numerical sequence.\\
Thus, combining with the result from MCT we have:
\[
\int f_1\,d\mu - \lim_{n\to\infty} \int f_n\,d\mu =  \int f_1 \,d\mu- \int f \;d\mu
\]
Rearrange to get:
\[
\lim_{n\to\infty} \int f_n\,d\mu = \int f\,d\mu,
\]
which is exactly what we wanted to prove.
\end{proof}

\begin{solution}
    \textbf{of (b):}\\
 Consider defining $(f_n: \mathbb{R} \rightarrow \mathbb{ R})_{n\in\mathbb{N}}$ with
\[
f_n(x) = \chi_{[n,\infty)}(x)
\]
Note that: \begin{itemize}
    \item  \textbf{$f_n$ is a decreasing seq}: For each \(n\) and every \(x\in\mathbb{R}\),\[
   f_{n+1}(x) = \chi_{[n+1,\infty)}(x) \le \chi_{[n,\infty)}(x) = f_n(x)
   \]
since \([n+1,\infty) \subset [n,\infty)\).
\item \textbf{$(f_n)$ the pointwise limit}:\[
   \lim_{n\to\infty} f_n(x) = 0 \quad \forall x\in\mathbb{R}
   \]since for each $x$ there exists an \(N\) (any integer greater than \(x\)) such that for all \(n \ge N\), \(x < n\) and hence \(f_n(x)=0\).
   \item For each $n$, \[
     \int_{\mathbb{R}} f_n\,d\lambda = \int_n^\infty 1\,dx = \infty
     \]
   But on the other hand
     \[
     \int_{\mathbb{R}} \Bigl(\lim_{n\to\infty} f_n\Bigr)\,d\lambda = \int_{\mathbb{R}} 0\,d\lambda = 0
     \]

\end{itemize}
Then we have the decreasing seq of function with
\[
\lim_{n\to\infty} \int f_n\,d\lambda = \infty \quad \text{while} \quad \int \Bigl(\lim_{n\to\infty} f_n\Bigr)\,d\lambda = 0
\]
This shows that in the absence of the finiteness assumption, the limit and integration need not commute.
\end{solution}





\section{Vitali meet Cantor.} 
  Construct a function $f\colon[0,1]\to[0,1]$ such that:
  \begin{itemize}
  \item[(a)] $f$ fails to be Lebesgue measurable;
  \item[(b)]there exists a compact subset $K\subset(0,1)$ of positive Lebesgue measure such that $f$ is differentiable at every point $x\in K$.
  \end{itemize}
  \textit{Hint}: use the function $g(x)=\inf\{|x-y|\mid y\in K\}$; then square this with the title of the problem.


\begin{solution}
Let $V$ be a Vitali set on $[0,1]$, $C$ be the fat Cantor set on $[0,1]$ by recursively taking away the middle open subinterval of length $\frac{1}{4^{n}}$ on the $n$th recursion. 
    We consider the function: \[ f(x) = \chi_V \cdot d(x,C)^2\]
where \[d(x,C) := \{\inf\{|x-y|\mid y\in C\}\]
By Hw3, we know $V$ is not Lebesgue measurable, and $C$ is compact with positive Lebesgue measure $\frac{1}{2}$.

And since $f^{-1} (\{1\}) = V$, mapping a not measurable set to a measurable set, \textbf{$\chi_V$ is not measurable function. }

And since the distance function $d(x,C)$ is a continuous function of $[0,1]$, it is measurable, by the result proved in class that a continuous funciton on a topological space is measurable.

\begin{lemma}
The product of a measurable $f:\mathbb{R}\rightarrow \mathbb{R}_{>0}$ and a not measurable $g: \mathbb{R}\rightarrow \mathbb{R}$ is not measurable.
\end{lemma}

\noindent \textbf{Proof of Lemma 4.2: } 
$f$ measurable $\implies$ $1/f$ measurable. Suppose for contradiction that $fg$ is measurable, then  $g = \frac{1}{f}(f g) $ is the product of two measurable functions, thus measurable, contradicting the fact that $g$ is not measurable. Thus $fg$ is not measurable.\\\\

\noindent \textbf{Claim 5.1: $f$ is not measurable.}
\noindent \textbf{Proof of claim 5.1:}
Thus on the open set $A = [0,1] \setminus C$, $d(x,C)^2$ is positive, so $\chi_V |_A d(x,C)^2|_A $  is not measurable since it is a product of measurable and not measurable function by lemma 4.2. Thus\textbf{ $f$ is not measurable,} otherwise its restriction on $A$ should also be measurable.\\\\

\noindent \textbf{Claim 5.2: $f$ is differentiable on $C$.}
\textbf{Proof of claim 5.2:} 
Fix \(x\in C\), then $f(x) = 0$. We want to show:\(f'(x)=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h} = \lim_{h\to 0}\frac{f(x+h)}{h}\) exists
Let $h > 0$.
Case 1: \(x+h\notin V\), then \(\chi_V(x+h)=0\), so we have \(f(x+h)=\chi_V(x+h)\,d(x+h,C)^2=0
  \), then 
  \(\frac{f(x+h)}{h}=0\). 
Case 2: \(x+h\in V\), we have: \[
  d(x+h,C)=\inf_{y\in C}|(x+h)-y|\le |(x+h)-x|=|h|
  \] So  \[
  \left|\frac{f(x+h)}{h}\right|=\frac{d(x+h,C)^2}{|h|}\le\frac{|h|^2}{|h|}=|h|
  \]
Therefore for all cases we have:
\[
\left|\frac{f(x+h)-f(x)}{h}\right|=\left|\frac{f(x+h)}{h}\right|\le |h|
\]
This confirms that 
\[
f'(x)=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h}=0
\]

This finishes the proof of required properties of $f$.
\end{solution}



\subsection{harder Vitali meet Cantor (extra credit)}
We change the requirement of (a) to be: "the restriction of $f$ to any open interval $I\subset[0,1]$ fails to be Lebesgue measurable". Then how can we make the construction?
\begin{solution}
    I don't know.\\
    \textcolor{red}{官方答案: 我在前一问给出的  \[ f(x) = \chi_V \cdot d(x,C)^2\] 这个函数, 同样也是满足这一问的答案. (对于 $C$, 不仅可以选择 fat Cantor set, 实际上任何 choice of compact nowhere dense set 都可以.) }
\end{solution}






\chapter{on integration(50/50)}
\begin{center}
\textit{None of the following questions will be graded. Do them, but do not hand them in}.
\end{center}

\section{Dirac measure: $\int f \; d\delta_{x_0}= f(x_0) $}
  Let $(X,\mathcal{A})$ be a measurable space, and $x_0\in X$ a point. 
  Let $\delta_{x_0}$ be the Dirac measure at $x_0$, i.e. for $E\in \mathcal{A}$, $\delta_{x_0}(E)=1$ if $x_0\in E$ and $\delta_{x_0}(E)=0$ if $x_0\notin E$. 
Show that every measurable function $f\colon X\to \mathbb{R}$ is integrable and 
\[
	\int f \; d\delta_{x_0}= f(x_0) 
\]
\textit{Remark}: what is often called a Dirac delta function is actually this Dirac measure. 

\section{measure space 的 extension 保留 measurable function 的可测性和积分}  
  Let $(X,\mathcal{A},\mu)$ and $(X,\mathcal{B},\nu)$ be measure spaces on the same set $X$. Suppose that $(X,\mathcal{B},\nu)$ is an extension of $(X,\mathcal{A},\mu)$. 
  \begin{itemize}
  \item[(a)] Show that if a function $f$ on $X$ is $\mathcal{A}$-measurable, then it is $\mathcal{B}$-measurable.
  \item[(b)] Show that if a function $f$ on $X$ is $\mathcal{A}$-measurable and $f\in L^1(\mathcal{A}, \mu)$, then $f\in L^1(\mathcal{B},\nu)$ and $\int f \; d\mu= \int f\; d \nu$. 
  \end{itemize}


\section{almost everywhere defined measurable function}
  Carefully think through the notion of an ``almost everywhere defined'' measurable (or integrable) function.
  How can we deduce the ``almost everywhere'' versions of the main convergence theorems (MCT, FL, DCT) from their ``everywhere'' counterparts?
  Propositions 2.11 and 2.12 in~[Folland] are useful here (these appeared on HW4).
  
\section{new measure from old: $\nu(A):=\int_A f\; d\mu \implies\int g \; d \nu= \int gf \; d\mu$}
  Let $(X, \mathcal{A},\mu)$ be a measure space. Let $f\colon X\to[0,\infty]$ be an $ \mathcal{A}$-measurable function.
Define $\nu\colon  \mathcal{A}\to[0,\infty]$ by  $\nu(A)=\int_A f\; d\mu= \int f\chi_A\; d\mu$ for $A\in \mathcal{A}$.  
\begin{itemize}
\item[(a)]Prove that $\nu$ is a measure on $(X, \mathcal{A})$. 
\item[(b)]Prove that $\int g \; d \nu= \int gf \; d\mu$ for every $ \mathcal{A}$-measurable function $g\colon X\to [0, \infty]$. 
\textit{Hint}: Start with the case when $g=\chi_E$; then treat the case when $g$ is a simple function; finally consider the case when $g$ is a general nonnegative function.
\item[(c)]Now  consider the case $(X, \mathcal{A},\mu)=(\mathbb{R},\mathcal{B}(\mathbb{R}), m)$, where $m$ is Lebesgue measure. 
Each nonnegative function $f\colon \mathbb{R} \to[0,\infty]$ induces a Borel measure $\nu_f(A)= \int_A f \; d m$ by (a).
\begin{itemize}
\item[(i)]Which functions $f$ induce a locally finite Borel measure? In that case, what is the distribution function for $\nu_f$?
\item[(ii)] Do all locally finite Borel measures arise from some $f$?
\item[(iii)] Can you interpret (b) as a change of variables formula? 
\end{itemize}
\end{itemize}



\section{Truncations in $L^1$: 通过 $\int f_n$ 或者 $\int_{X_n} f$ 的极限 (bounded function / subset) 得到 $\int_X f$}
Let $(X,\mathcal{A},\mu)$ be a measure space and $f\colon X\to\mathbb{C}$ an integrable function.
\begin{itemize}
\item[(a)] (Horizontal truncation) Suppose that $X=\bigcup_{n=1}^\infty X_n$ for some $X_1\subset X_2\subset \cdots$ 
with $X_n\in \mathcal{A}$. Prove that 
\[
  \int_X f \,d\mu = \lim_{n\to \infty} \int_{X_n} f\,d\mu
\]
\item[(b)] (Vertical truncation) Prove that
\[
  \int f\,d\mu = \lim_{n\to \infty} \int f\chi_{\{|f|\le n\}}\; d\mu
\]
\end{itemize}
\textit{Remark}: a similar question for nonnegative measurable functions appeared in HW4.

\section{$L^1$-convergence from dominated convergence}
Let $(X,\mathcal{A},\mu)$ be a measure space, and $f_n, f$, measurable functions on $X$, $n\in \mathbb{N}$. 
Suppose that $f_n\to f$ a.e.\ and there is an integrable nonnegative function $g$ such that $|f_n(x)|\le g(x)$ a.e.\ for all $n$. Prove that 
$f_n\to f$ in $L^1$, i.e.\
\[
  \lim_{n\to \infty} \int |f_n-f| =0.
\]
\textit{Hint}: use DCT.

\section{Lebesgue integrals and affine transformations}
  Let $f$ be a Lebesgue integrable function on $\mathbb{R}$. 
  Prove that 
  \[
    \int f(rx+s)\; d m(x)=\frac1{|r|}\int f(x)\; d m(x)
  \]
  for all real numbers $r,s$ with $r\ne0$.
  
  \textit{Hint}: approximate using simple functions $f$.


\section{even moments of Gaussian distribution}
    Using Multivariable Calculus (and the fact that Riemann integrals coincide with Lebesgue integrals) one can show that
    \[
      \frac1{\sqrt{2\pi}} \int_{-\infty}^\infty e^{-t\frac{x^2}{2}} \;d x = \frac1{\sqrt{t}}
    \]
    for every $t>0$.
%    Here, the integral is the improper Riemann integral $\lim_{a\to -\infty, b\to \infty} \int_a^b e^{-t\frac{x^2}{2} } \dd x$.
    Prove, by (justified!) differentiating with respect to $t$, that
    \[
      \frac1{\sqrt{2\pi}} \int_{-\infty}^\infty x^{2n} e^{-\frac{x^2}{2}} = (2n-1)!!
      := \frac{(2n)!}{2^n n!}
    \]
    for $n\in \mathbb{N}$.

    \textit{Remark}: here the integrals are as defined in this course.
    \textit{Remark}: in probability theory, these are the even moments of the standard normal distribution.

\section{Generalized DCT}
  Let $(X, \mathcal{A}, \mu)$ be a measure space, and $f_n, g_n, f, g\in L^1$, $n\in \mathbb{N}$. Suppose that 
  \begin{itemize}
  \item[(a)]$\lim_{n\to\infty} f_n(x)=f(x)$ and $ \lim_{n\to\infty} g_n(x)=g(x)$ for a.e. $x$;
  \item[(b)] $|f_n(x)|\le g_n(x)$ a.e. for every $n\in \mathbb{N}$;
  \item[(c)]$g_n\colon X\to [0, \infty]$ and $\lim_{n\to \infty} \int g_n \; d \mu = \int g\; d\mu$.
  \end{itemize}
  Prove that
  \[
    \lim_{n\to \infty} \int f_n \; d\mu = \int f \; d\mu.
  \]
\textit{Hint}: Follow the proof of the DCT, based on FL.



\section{Criterion for $L^1$-convergence}
  Let $(X, \mathcal{A}, \mu)$ be a measure space. 
  Let $f_n, f$ be integrable functions on $X$, $n\in \mathbb{N}$. 
  Suppose that $\lim_{n\to\infty} f_n(x)=f(x)$ a.e. Prove that \[
    \lim_{n\to\infty} \int |f_n-f| \; d\mu =0\quad\text{iff}
    \quad \lim_{n\to \infty} \int |f_n| \; d\mu = \int |f|\; d\mu\]
  \textit{Hint}: use the generalized DCT.






  
\vspace*{10mm}
\newpage
\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in}.
\end{center}

\section{Formal equivalence between MCT and FL}
  Let $(X,\mathcal{A},\mu)$ be a measure space and $L^+=L^+(X,\mathcal{A})$ the space of measurable functions $f\colon X\to[0,\infty]$. \\
  Let $I\colon L^+\to[0,\infty]$ be a function that is increasing in the sense that $f\le g$ implies $I(f)\le I(g)$. Prove that the following properties are equivalent:
  \begin{itemize}
  \item[(a)]$I$ is continuous along increasing sequences: if $f_n\in L^+$, and $f_n\le f_{n+1}$ for $n\in\mathbb{N}$, then $\lim I(f_n)=I(\lim f_n)$.
  \item[(b)] if $f_n\in L^+$, $n\in\mathbb{N}$, then $\liminf_nI(f_n)\ge I(\liminf_nf_n)$.
  \item[(c)] $I$ is lower semicontinuous: if $f_n,f\in L^+$, and $\lim_nf_n=f$, then 
    $I(f)\le\liminf_nI(f_n)$.
  \end{itemize}
  Here $\lim_nf_n=f$ means that $\lim_nf_n(x)=f(x)$ for all $x\in X$, and similarly for $\liminf f_n$.
\textit{Remark}: the equivalence between~(a) and~(b) shows that \textbf{the Monotone Convergence Theorem and Fatou's Lemma are equivalent.}

\begin{proof}
    \textbf{of (\(\textbf{a} \implies \textbf{b}\)):}\\
    Suppose \(I\) is continuous along increasing sequences. WTS: \[
  \liminf_{n} I(f_n) \;\ge\; I\!\bigl(\liminf_{n} f_n \bigr)
\]for any sequence \((f_n)\) in \(L^+\).\\
Define for each $k\in\mathbb{N}$ \[
    g_k \;:=\; \inf_{n \ge k}\, f_n
  \] Then for all $k \in \mathbb{N}$, $g_k$ is a measurable function. Also notice that by definition, $\{g_k\}$ is an increasing sequence, and  \[
    \lim_{k \to \infty} g_k(x) \;=\; \liminf_{n \to \infty} f_n(x)
  \]
for each \(x \in X\).\\
Applying \((\textbf{a})\) to \(g_k\): since \(g_k \uparrow \lim_{k} g_k\), we get \begin{equation}
      \lim_{k \to \infty} I(g_k)
    \;=\;
    I\Bigl(\lim_{k\to\infty} g_k\Bigr)
    \;=\;
    I\bigl(\liminf_{n \to \infty}  f_n\bigr)
 \end{equation}
By def of $g_k$, we have:  \[
    g_k \;\le\; f_n \quad \text{for all } n \ge k
  \]
Since  \(g_k \le f_n\) implies \(I(g_k) \le I(f_n)\), we also have: \[
    I(g_k) \;\le\; \inf_{n \ge k} \,I(f_n)
  \]
Taking the limit as \(k \to \infty\), we get 
\begin{equation}
\lim_{k\to\infty} I(g_k)
    \;\le\;
    \lim_{k\to\infty} \inf_{n \ge k}\, I(f_n)
    \;=\;
    \liminf_{n \to \infty} I(f_n)    
\end{equation}
Combining (5.1) and (5.2), we obtain: \[
    I(\liminf_{n} f_n)
    \;=\;
    \lim_{k} I(g_k)
    \;\le\;
    \liminf_{n} I(f_n).
  \] which is exactly what we want.\\\\\end{proof}
\begin{proof}
(\(\textbf{b} \implies \textbf{c}\)):  We now assume \((\textbf{b})\) and prove that \(I\) is lower semicontinuous, i.e. WTS: \[
  f_n \to f \quad \text{pointwisely} \quad \Longrightarrow \quad
  I(f) \;\le\; \liminf_{n} I(f_n).
\]
Given \(f_n \to f\) pointwise, we have
\[
  f(x)
  \;=\;
  \lim_{n} f_n(x)
  \;=\;
  \liminf_{n} f_n(x) \quad \forall x
\]
Hence for the sequence \(\{f_n\}\), the pointwise limit of \(f_n\) is exactly \(\liminf_{n} f_n\). \((\textbf{b})\) gives:
\[   \lim_{n} f_n(x) =   \liminf_{n} I(f_n) \;\ge\; I(\liminf_{n} f_n)=  I(f)\]
This is precisely the definition of lower semicontinuity, proving \((\textbf{b}) \implies (\textbf{c})\).\\\\
\end{proof}
\begin{proof}
of (\(\textbf{c} \implies \textbf{a}\)): \\
Assume $I$ is lower semi-continuous, i.e.  If \(f_n \to f\) pointwise, then \[
    I(f) \;\le\; \liminf_{n} I(f_n)
  \] Let \((f_n)\) be a sequence in \(L^+\) such that \(f_n \uparrow f\), i.e. \[
  f_1 \le f_2 \le \cdots
  \quad\text{and}\quad
  \lim_{n\to\infty} f_n(x) \;=\; f(x) \quad\text{ptwisely for all }x
\]
WTS (a): \(\lim_{n} I(f_n) = I(f)\). \\

Since $f_n$ is an increasing seq, \(f_n \le f\) for each $n$, and since \(I\) is monotone, we have \[
     I(f_n) \;\le\; I(f)
     \quad \forall n
   \]
Hence \[\limsup_{n} I(f_n) \;\le\;I(f) \]
And by \(\mathbf{(c)}\), since \(f_n \to f\) pointwisely, we have \[I(f) \le \liminf_{n} I(f_n)\]
Combining (1) and (2), we get
\[
  \liminf_{n} I(f_n)
  \ge I(f) \ge
  \limsup_{n} I(f_n)
\]
This we also has $ \liminf_{n} I(f_n) \leq 
  \limsup_{n} I(f_n)$, this shows that \(\lim_{n} I(f_n)\) exists and equals \(I(f)\).  This is exactly the statement of (a). Thus \(\mathbf{(c)} \implies \mathbf{(a)}\).\\\\
\end{proof}
Here we finished the proof that the three properties are equivalent. In particular, the equivalence of (a), (b) shows the equivalence of Fatou's Lemma and MCT.



\section{Convergence on subsets}
  Let $(X, \mathcal{A}, \mu)$ be a measure space. Let $f_n\colon X\to [0, \infty]$ be a measurable function for each $n\in \mathbb{N}$. 
Suppose that there is a function $f\colon X\to [0, \infty]$ such that 
\[
  \text{$\lim_{n\to \infty} f_n(x) = f(x)$ for every $x\in X$ and 
    $ \lim_{n\to \infty} \int f_n  = \int f$}
\]
\begin{itemize}
\item[(a)] Assume that $ \int f<\infty$. Show that $ \lim_{n\to \infty} \int_E f_n =\int_E f$ for every $E\in \mathcal{A}$. 
\textit{Hint}: Use Fatou twice. %for $f_n1_E$ and one more time for $f_n1_{E^c}$.) 
It may be useful to note that even though $\liminf (\alpha_n+\beta_n)\ge \liminf \alpha_n + \liminf \beta_n$ in general, if $\lim \alpha_n$ exists, then $\liminf (\alpha_n+\beta_n)=  \lim \alpha_n + \liminf \beta_n$ for sequences of extended real numbers $\alpha_n, \beta_n$.
\item[(b)]Find an example of $f_n\colon \mathbb{R}\to [0, \infty]$ on the measure space $(\mathbb{R}, \mathcal{B}(\mathbb{R}), m)$ showing that (a) does not necessarily hold if $ \int f=\infty$.
\end{itemize}

\begin{proof}
    \textbf{of (a):} \\
    By Fatou’s Lemma, since \(f_n \to f\) pointwise and all \(f_n\) are nonnegative,
\[
\liminf_{n\to\infty} \int_E f_n    =    \liminf_{n\to\infty} \int f_n \chi_E  \geq \int f\chi_E  =
\int_E f
\]
For the same reason, \[
     \liminf_{n\to\infty} \int_{E^c} f_n \,\ge\, \int_{E^c} f
   \]
Since \[
\int f \; d\mu = \int _X f \; d\mu  = \int _E f \; d\mu + \int _{E^c} f\; d\mu
\], we have: \begin{align}
    \int  f \; d\mu - \int _E f \; d\mu &= \int _{E^c} f \; d\mu \\
     &\leq \liminf_n \int_{E^c} f_n \; d\mu \\
     &= \liminf_n (\int f_n \; d\mu - \int_E f_n \;d \mu)\\
     & = \lim_{n \rightarrow \infty} \int f_n \; d\mu +  \liminf_n (-\int_E f_n \;d \mu) \\
     & = \lim_{n \rightarrow \infty} \int f_n \; d\mu - \limsup_n \int_E f_n \;d \mu \\
     & = \int f \; d\mu - \limsup_{n} \int_E f_n \;d \mu
\end{align}
Rearranging the terms, gives: \[
\int _E f  \geq \limsup_n \int_E f_n \;d \mu
\]
Combining with the statement given by Fatou's Lemma: \[
\liminf_{n\to\infty} \int_E f_n      \geq  
\int_E f
\]
We then have: 
\[
    \liminf_{n\to\infty} \int_E f_n =\int_E f \geq  \limsup_n \int_E f_n
   \]
Since also by definition of limsup and liminf we have: \[
\liminf_{n\to\infty} \int_E f_n \leq \limsup_{n\to\infty} \int_E f_n
\]
We have:  \[
\liminf_{n\to\infty} \int_E f_n  =  \limsup_{n\to\infty} \int_E f_n =  \lim_{n\to\infty} \int_E f_n = \int_E f
\]
This completes the proof.
\end{proof}
\begin{solution}
    \textbf{of (b):}
Define for each $n \in \mathbb{N}$ \[
f_n(x) := \chi_{[n,n+1]}  + \chi_{(-\infty, 0]}
\]
Then we have: \[
\int f_n(x) = 1 + \infty = \infty 
\]
for each $n$. So \[
\lim_{n\to\infty} \int f_n(x) = \infty
\]
And the pointwise limit of $f_n$ is \[
f(x) : = \lim_{n\to \infty} f_n(x) =   \chi_{(-\infty, 0]} \]
So the integral of $f$ is also: \[
\int \lim_{n\to \infty} f_n(x) = \int f(x) = \infty
\]
But consider the subset $E = [0,\infty)$, we have: \[
\int_E f_n  = \int \chi_{[n,n+1]}  = 1 \quad \text{for all } n
\]
So \[
\lim_{n\rightarrow \infty} \int_E f_n  = 1
\]while \[
\int_E f = 0 \not = \lim_{n\rightarrow \infty} \int_E f_n
\]
This completes the counterexample.
\end{solution}





\section{Some integrals}
    Use the DCT to evaluate the following limits:
  \begin{itemize}
  \item[(a)]\[\
      \lim_{n\to \infty} \int_0^\infty \frac{n\sin\left(\frac{x}{n}\right)}{x(1+x^2)} \; d x
    \]
  \item[(b)] \[
      \lim_{n\to\infty} \int_0^n x^m \left( 1- \frac{x}{n} \right)^n \; d x,
    \]
    where $m$ is a non-negative integer. (The integrals are Lebesgue integrals.)
  \end{itemize}

\begin{solution}
    \textbf{of (a):}\\
    Define \[
    f_n := \begin{cases}
  \frac{n\sin\left(\frac{x}{n}\right)}{x(1+x^2)}  ,\quad        x > 0\\
  0, \quad x\leq 0
    \end{cases}
    \]
Recall that for all $x  \in \mathbb{R}$, we have: \[
|\sin(x)| \leq |x|
\]
So for all $n$, and for all $x>0$, we have: \[
|f_n (x)| = \Bigg| \frac{n\sin\left(\frac{x}{n}\right)}{x(1+x^2)} \Bigg|  =   \frac{n 
 \sin\left(\frac{x}{n}\right)   }{x(1+x^2)}\leq   
\frac{n \frac{x}{n} }{x(1+x^2)}   = \frac{1}{1+ x^2}
\]
So by taking: \[
g(x) := \begin{cases}
  \frac{1}{1+x^2}  ,\quad        x > 0\\
  0, \quad x\leq 0
    \end{cases}
\]
We have: \[
g(x) \geq |f_n(x)| \quad \forall x\in \mathbb{R}, \forall n
\]
Since $g$ is continuous a.e. (except on $x=0$), it is a measurable function. And it is Riemann integrable. We can do Riemann integration of $g$: \[
\int_{0}^{\infty}
\frac{1}{1 + x^2} \, dx
\;=\;
\left[\arctan(x)\right]_{0}^{\infty}
\;=\;
\frac{\pi}{2} < \infty
\]
Also, for each $x > 0$, since \[
\lim_{n\to \infty} \frac{\sin(\frac{x}{n})}{\frac{x}{n}} = 1
\]
We have for each $x > 0$: \[
\lim_{n \to \infty} f_n(x) = \frac{1}{1+ x^2 } \lim_{n\to \infty} \frac{\sin(\frac{x}{n})}{\frac{x}{n}}   =  \frac{1}{1+ x^2 }
\]
Thus the pointwise limit of $f_n$ is:  \[
f(x):=\lim_{n \to \infty} f_n(x) = \begin{cases}
  \frac{1}{1+x^2}  ,\quad        x > 0\\
  0, \quad x\leq 0
    \end{cases}
\]
(Notice it coincides with the $g$ that we chose as bound.) We also have: 
\[ \int_{0}^{\infty} f(x) \; dx = \frac{\pi}{2}
\]
Then by DCT, 
\[
\lim_{n\to \infty} \int_0^\infty \frac{n\sin\left(\frac{x}{n}\right)}{x(1+x^2)} \; d x =\lim_{n \to \infty} \int_{0}^{\infty} f_n(x) \; dx =\int_{0}^{\infty} \lim_{n\to \infty} f_n(x) \; dx = \int_{0}^{\infty} f(x) \; dx =   \frac{\pi}{2}
\]
This finishes the calculation.
\end{solution}


\begin{solution}
    \textbf{of (b):}\\
Define for each $n \in \mathbb{N}$ \[
f_n(x) = x^m \left(1 - \frac{x}{n}\right)^n 
\quad \text{for} \quad 0 \le x \le n
\]
and $f_n(x) = 0$ for $x > n$.\\
Then the integral we wish to evaluate can be written as \[
 \lim_{n\to \infty} \int_0^n x^m \left(1 - \frac{x}{n}\right)^n \, dx  = \lim_{n\to \infty} 
\int_0^\infty f_n(x) \, dx
\]
We first evaluate the ptwise limit function $f:= \lim_{n\to \infty} f_n(x)$.\\
For \(x = 0\): \[
   f_n(0) \;=\; 0^m \left(1 - \frac{0}{n}\right)^n = 0^m \cdot 1 =0^m e^{-x} \quad \forall n
   \]
For \(0 < x < \infty\): \[
   f_n(x) \;=\; x^m \left(1 - \frac{x}{n}\right)^n
   \]
for all large enough $n$. \\
Recall the standard limit \(\lim_{n \to \infty} \left(1 - \tfrac{x}{n}\right)^n = e^{-x}\), hence \[
  f(x) := \lim_{n \to \infty} f_n(x) = \lim_{n \to \infty}   x^m \left(1 - \frac{x}{n}\right)^n = 
   x^m e^{-x}
   \]
Thus \[
f(x) = \begin{cases}
    0, \quad x< 0 \\
       x^m e^{-x}, \quad x \geq 0
\end{cases}
\]
Now we determine the dominating function $g$.\\
Consider the same function as $f$:
\[
g(x) :=  \begin{cases}
    0,\quad x< 0\\
    x^m  e^{-x}, \quad x\geq 0
\end{cases}
\]
We now prove this same function $g$ works.\\
Let $n \in \mathbb{N}$.\\
It is sure that for $x > n$, $g(x) \geq |f_n(x)|$ since $f_n(x) = 0$.\\
So consider $x\in[0,n]$.\\
Recall the inequality: \[ \ln(1-t)\le -t \quad \forall t\in[0,1]\]
Thus we have: 
\[
\left(1 - \frac{x}{n}\right)^n \leq
e^{-\frac{x}{n}n} =
e^{-x}
\]
Therefore,
\[
0 
\;\le\;
x^m \left(1 - \frac{x}{n}\right)^n 
\;\le\;
x^m e^{-x}
\quad
\text{for all } 0 \le x \le n
\]
Thus in all cases,
\[|f_n(x)|=f_n(x) \leq 
x^m e^{-x} =
g(x)
\]
Recall:
\[
\int_0^\infty x^m e^{-x}\,dx = \Gamma(m+1) = m!
\]
is \textbf{finite} for all nonnegative integers \(m\). Thus \(g\) is \textbf{integrable}. Then \textbf{$g$ is indeed a dominating function for $(f_n)$.} \\
Applying the DCT, we exchange the limit and the integral:
\[
\lim_{n \to \infty} \int_0^\infty f_n(x)\, dx =
\int_0^\infty \lim_{n\to\infty} f_n(x)\, dx =
\int_0^\infty x^m e^{-x}\, dx
\] thus
\[
\lim_{n \to \infty} \int_0^n x^m \left(1 - \frac{x}{n}\right)^n \, dx =
\int_0^\infty x^m e^{-x}\, dx = \Gamma(m+1) = m!
\] This finishes the evalutation of this integral.
\end{solution}




  \section{Continuity of translations}
  Let $f\in L^1(\mathbb{R}, \mathcal{L}, m)$. For $x\in\mathbb{R}$, set $f_s(x)= f(x-s)$. 
  Prove that $s\mapsto f_s$ is a continuous map from $\mathbb{R}$ to $L^1$. In other words, prove that if $t\in\mathbb{R}$, then 
  \[
    \lim_{s\to t} \int |f_s-f_t| \; d m =0 
  \]
  \textit{Hint}: approximate $f$. 
\begin{proof}
We write: \[
||f-g||_1 := \int |f-g| \;dm
\] for $f,g\in L^1(\mathbb{R}, \mathcal{L}, m)$.
Let $\epsilon > 0$.\\
Recall that \( C_c(\mathbb{R}) \) is dense in \( L^1(\mathbb{R}) \). So there exists a function \( g \in C_c(\mathbb{R}) \) such that
\[
\| f - g \|_1 < \frac{\epsilon}{3}
\] Since \( g \) is continuous and compactly supported, it is \textbf{uniformly continuous}. Denote $ K :=\supp (g) $. 
There exists \(\delta > 0\) such that for all \( x \in \mathbb{R} \),
\[
|s - t| < \delta \implies |g(x - s) - g(x - t)| < \frac{\epsilon}{3 \cdot m(K)}
\]
Integrating the difference over this support gives:
\[
\| g_s - g_t \|_1 \leq \frac{\epsilon}{3 \cdot m(K)} \cdot m(K) = \frac{\epsilon}{3}
\]
Recall that $L^1(\mathbb{R}, \mathcal{L}, m)$ is a normed vector space with $||\cdot||_1$ as the norm. So by the triangle inequality of a norm, we have:
\[
\| f_s - f_t \|_1 \leq \| f_s - g_s \|_1 + \| g_s - g_t \|_1 + \| g_t - f_t \|_1\]
By the translation invariance of Lebesgue measure, we have: 
\[
\| f_s - g_s \|_1 = \| f - g \|_1 < \frac{\epsilon}{3} \quad \text{and} \quad \| g_t - f_t \|_1 = \| g - f \|_1 < \frac{\epsilon}{3}
\]By choosing \(\delta\) such that \(\| g_s - g_t \|_1 < \frac{\epsilon}{3}\), we get
\[
\| f_s - f_t \|_1 < \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3} = \epsilon
\]
Since $\epsilon$ is arbitrary, this proves that for any \( t \in \mathbb{R} \), \[
\lim_{s \to t} \int |f_s - f_t| \, dm =  ||f_s - f_t||_1  = 0
\]finishing the proof of continuity of the map \( s \mapsto f_s \).
\end{proof}






\section{An interesting integrable function}
  For $\alpha\in(0,1)$, define $g_\alpha\colon \mathbb{R}\to \mathbb{R}$ by $g_\alpha(x)=(1-\alpha)x^{-\alpha}$ for $0<x<1$ and $g_\alpha(x)=0$ otherwise. Let $(x_n)_n$ be an enumeration of the rational numbers, and define $f\colon \mathbb{R}\to[0,\infty]$ by
  \[
    f(x)=\sum_{n=1}^\infty2^{-n}g_{1-n^{-n}}(x-x_n)
  \]
  Prove that $f$ has the following properties:
  \begin{itemize}
  \item[(a)]$f$ is Borel (and hence Lebesgue) measurable;
  \item[(b)] $f$ is Lebesgue integrable, that is $\int_\mathbb{R} f\; d m<\infty$;
  \item[(c)]  there exist uncountably many $x\in\mathbb{R}$ such that $f(x)<\infty$;
  \item[(d)]  $f$ is discontinuous at every point $x\in\mathbb{R}$ where $f(x)<\infty$;
  \item[(e)]  $f$ is unbounded on any nonempty open interval $I=(a,b)$, that is $\sup_If=\infty$;
  \item[(f)]   the statements in~(d) and~(e) remain true even if we redefine $f$ on a set of (Lebesgue) measure zero.
  \item[(g)]$\int_I f^p\; d m=\infty$ for all $p>1$ and all intervals $I=(a,b)$.
  \end{itemize}


\begin{proof}
    \textbf{ of (a):}\\
  We define \[ \alpha_n : = 1 - n^{-n}
  \] and \[
    h_n(x) :=  2^{-n}g_{\alpha_n}(x - x_n)
    \] and \[
    f_k(x) := \sum_{n=1}^k 2^{-n}g_{\alpha_n}(x-x_n) = \sum_{n=1}^k  h_n(x)
    \] to simplify the expression.\\
Then we have: \[
f(x) = \lim_{k \rightarrow \infty} f_k(x)
\]
 Notice that, since each $g_{\alpha_n}$ is nonnegative, $f_k(x)$ is a \textbf{increasing} sequence of functions, so for any $x \in \mathbb{R}$, $ \lim_{k\to \infty} f_k(x)$ exists in $\overline{\mathbb{R}}$. This shows the well-definedness of $f  = \lim_{k\to \infty} f_k$. \\
Now we \textbf{claim: each $h_n(x)$ is Borel measurable.}\\
By translate invariance and scaling invariance of Borel measurability, to prove the claim, it \textbf{suffices to prove that each $g_{\alpha}$ is Borel measurable for any $\alpha \in (0,1)$}.\\
\pic[0.3]{hw5.assets/image-20250214195825512.png}
If $a < 0$, we have:  \[
g_\alpha^{-1}((a,\infty)) =  \mathbb{R}
\]
if $ 0 \leq a \leq  1-\alpha$, then we have \[
g_\alpha^{-1}((a,\infty)) = (0,1)
\]
if $ a > 1-\alpha$, then we have \[
g_\alpha^{-1}((a,\infty)) = (0,(\frac{1-\alpha}{a})^{1/\alpha})
\]
This proves that $g_\alpha$ is Borel measurable for any $\alpha \in (0,1)$.\\
Thus each $f_k$ being a \textbf{finite sum of Borel measurable functions}, is Borel measurable.\\
Then $f $ as \textbf{the limit of Borel measurable function sequence} $(f_k)$, is Borel measurable.\\\\
\end{proof}
\begin{proof}
    \textbf{of (b):}\\
    We define: \[
    h_n(x) :=  2^{-n}g_{\alpha_n}(x - x_n)
    \] in order to simplify the expression.\\
By translation invariance of Lebesgue measure, we have for any $\alpha_n$, : \[
     \int_{\mathbb{R}} g_{\alpha_n}(x - x_n)\,dm =
     \int_{\mathbb{R}} g_{\alpha_n}(x)\,d m_t
     = (1-\alpha) \cdot \frac{1 - 0}{1-\alpha} = 1
   \]
So by homogeneity of integral,  \[
\int_{\mathbb{R}} h_n(x) \; d m =  \int_{\mathbb{R}} 2^{-n}g_{\alpha_n}(x - x_n)\,dm = 2^{-n}  \int_{\mathbb{R}} g_{\alpha_n}(x - x_n)\,d m  = \frac{1}{2^n}
\]
Thus we have: \[
\sum_{n=1}^\infty \int_{\mathbb{R}} |h_n(x)| = \sum_{n=1}^\infty \int_{\mathbb{R}} h_n(x) =  \frac{1/2}{1-1/2} = 1 < \infty
\] by sum of geometric series.
Since this sum of integral of the sequence is finite, we can apply \textbf{theorem 2.25 on Folland, to exachange the order of limit and integral}, and have: \[
 \int_{\mathbb{R}}  \sum_{n=1}^\infty h_n(x)   = \sum_{n=1}^\infty \int_{\mathbb{R}} h_n(x)  =1
\]
Hence,
\[
  \int_{\mathbb{R}} f \,d m
 =  \int_{\mathbb{R}}  \sum_{n=1}^\infty h_n(x)   dm = \sum_{n=1}^\infty  \int_{\mathbb{R}}  h_n(x)   dm  = 1
\]
So \(\int_{\mathbb{R}} f < \infty\).  This proves \(f\in L^1(\mathbb{R})\).\\\\
\end{proof}



\begin{proof}
\textbf{of (c):}
\begin{lemma}
    For $f \in L^+(\mu)$,   if $f(x) =+\infty$ on a set $S$ where $\mu(S) >0$, then $\int f = \infty$
\end{lemma}
Proof for Lemma: trivially follows from definition. We can pick make a sequence of simple functions $(\phi_n)$, setting $\phi_n |_S = n$ (doable since $f|_S = \{\infty\}$) then we have: \[
\int \phi_n \; d\mu \geq  \int  n  \chi_S = n
\]
So the limit of integral of this simple function sequence is $\infty$. \\\\
Then (c) follows from the lemma: suppose for contradiction that there exist only countably many $x\in\mathbb{R}$ such that $f(x)<\infty$, we denote this this by $C$, then on $\mathbb{R} \setminus C$ which has positive measure (since $C$ has measure 0), $f(x) = \infty$. So by lemma, $\int f = \infty$, contradicting with the fact that $\int f = 1$ proven in (b). So there exist uncountably many $x\in\mathbb{R}$ such that $f(x)<\infty$.\\\\
\end{proof}


\begin{proof}
\textbf{of (e):}
Fix an interval \( I \). By the density of rational numbers in any interval, there exists some rational $x_N \in I$. Note that though $g_{\alpha_N} (x_N) = 0$, $g_{\alpha_N} (x)$ can be arbitrarily large near $x_N$.\\
Fix $M > 0$.\\
It suffices to pick some $x$ s.t.
\[
2^{-N}g_{\alpha_N } (x-x_N) = \frac{1-\alpha_N}{2^N}   (x-x_N)^{-\alpha_N} > M
\]
So by taking any\[
x \in (x_N, x_N + (\frac{2^N M}{1-\alpha_N})^{\alpha_N}) \cap I
\]
then it is done.\\
Since we already have $2^{-N}g_{\alpha_N } (x-x_N) > M$, we have \[
f(x) > 2^{-N}g_{\alpha_N } (x-x_N) > M
\]
Since $M$ is arbitrary, this proves that the value of $f$ on $I$ can be unboundedly large, finishing the proof that \[
\sup_I f = \infty
\]
\end{proof}


\begin{proof}
\textbf{of (d):}
Notice that we first proved (e) and then let's prove (d) using the conclusion of (e).\\
Let $x \in \mathbb{R}$ s.t. \(f(x)<\infty\).\\
Suppose $f$ is continuous at $x$, then by definition, there exists an open neighborhood $B_\delta(x) = (x-\delta, x+ \delta)$ s.t. $|f(y) - f(x)| < \frac{1}{83}$ for all $y \in B_\delta (x)$.\\
But since the neighborhood is an interval, we have:\[
\sup_{(x-\delta, x+ \delta)} f = \infty
\] by (e). This two facts contradicts. So by contradiction we have proved that $f$ is discontinuous at $x$.\\
So we can conclude that $f$ is discontinuous at any point $x$ s.t. $f(x) < \infty$.\\\\
\end{proof}



\begin{proof}
\textbf{of (f):} 
Let $I$ be an interval.\\
Suppose we have redefined $f$ on a measure $0$ set. We pick a rational $x_N \in I$ (It does not matter whether the new $f$ is defined there.)\\
For arbitrary $M>0$, we can still always find an $x$ s.t. $x \in (x_N, x_N + (\frac{2^N M}{1-\alpha_N})^{\alpha_N}) \cap I$ that \textbf{keeps its original $f(x)$}, which guarantees that $f(x) > M$, implying $\sup_I f = \infty$. This is because, if not so, then it means that we have modified the whole interval $(x_N, x_N + (\frac{2^N M}{1-\alpha_N})^{\alpha_N}) \cap I$, \textbf{which is not a measure zero set}, \textbf{conflicting with the statement} "redefining $f$ on a measure zero set".
So (e) must still hold true.\\
For (d), we apply the same trick as original, getting an open interval around $x$ s.t. $|f(y) - f(x)| < \frac{1}{83}$ for all $y \in B_\delta (x) = (x-\delta, x+ \delta)$. And by the restated (d), even if we modified a set of measure zero on $(x-\delta, x+ \delta)$, we still reaches the the same conclusion that $\sup_{(x-\delta, x+ \delta)} f = \infty$, thus causing the same contradiction.\\
This finishes the proof.\\\\
\end{proof}



\begin{proof}
\textbf{of (g):}
WTS: \(\int_I f^p \, d m = \infty\) for all \(p>1\) and every interval \(I\)
\textbf{Claim: for each $n$,  \(g_{\alpha_n}^p\) \emph{fails} to be in \(L^1\) when \(p>1\), i.e its integral is $\infty$.}
Fix $p>1$.\\
Since by translation invariance of Lebesgue integral,:
\[
  \int_{\mathbb{R}} \Bigl(2^{-n}g_{\alpha_n}(x - x_n)\Bigr)^p \, d m
  \;=\;
  2^{-np}\int_{\mathbb{R}} g_{\alpha_n}(x)^p \, d m
\]
where
\[
  g_{\alpha_n}(t)^p 
  \;=\;
  \bigl(n^{-n}t^{-\,\alpha_n}\bigr)^p
  \;=\;
  n^{-np}\,t^{-\,p\alpha_n}
  \;=\;
  n^{-np}\,t^{-\,p\,(1 - n^{-n})}
\]
Since \(p > 1\), there eixst $N$ such that for all $N\geq n$, the exponent \(-p(1-n^{-n})\) is less than \(-1\), causing \(\int_0^1 t^{-p + p\,n^{-n}}\,dt = +\infty\) for sufficiently large \(n\).  Multiplying by the constant \(n^{-np}\) does not remove the infinity. \\
Hence for large enough $n$, each individual summand has an infinite integral, then by monotonicity of integral, \[
f^p(x) = (\sum_n 2^{-n}g_{\alpha_n}(x - x_n))^p \geq 2^{-N}g^p_{\alpha_N}(x - x_N)
\]also has an infinite integral, finishing the proof.\\\\
\end{proof}








\begin{center}
  \textit{Nur f\"ur Verr\"uckte}
\end{center}
(It's \textbf{really} not necessary to attempt these problems. Do not, under any circumstances, hand them in!) 

\begin{enumerate}
    \item Make an accurate sketch of the graph of the function in the last problem.
\end{enumerate}






\chapter{on product measure and mode of convergence (49/50)}
\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in}.
\end{center}

\section{Order of integration}
  Use Tonelli's Theorem and 1-variable calculus to give a rigorous proof for the equality
  \[
    \int_0^\infty\int_x^\infty e^{-y^2/2}\;d y \;d x=1
  \]
\begin{proof}
 Define \[
 f(x,y) := \begin{cases}
   e^{-y^2/2}, & \text{if } 0 \le x \le y,\\
   0, & \text{otherwise}.
   \end{cases}
 \] Then we have \[
     \int_0^\infty\int_x^\infty e^{-y^2/2}\;d y \;d x=   \int \Big[   \int f(x,y) \; d m(y)  \Big]  \; dm(x) 
 \]
 Since $ f (x,y) = e^{-y^2/2}$ is \textbf{nonnegative} and \textbf{continuous}, it is measurable and thus in $L^+(X \times Y)$, where $X = Y = (\mathbb{R},\mathcal{L}, m)$ is $\sigma$-finite.\\
    Thus we can apply Tonelli's theorem: \begin{align}
      \int \Big[   \int f(x,y) \; d m(y)  \Big]  \; dm(x) &= \int f \; d(m(x)  \times m(y))     \\
& =    \int \Big[   \int f(x,y) \; d m(x)  \Big]  \; dm(y) \\
& =  \int \Big[   \int f(x,y) \; d m(x)  \Big]  \; dm(y) \\
& = \int \Big[   \int e^{-y^2/2} \; d m(x)  \Big]  \; dm(y) 
    \end{align}Where\[
     \int e^{-y^2/2} \; d m(x)   = \int_{[0,y]} e^{-y^2/2} \; dx =  ye^{-y^2/2}
    \]
Thus  \begin{align}
      \int \Big[   \int f(x,y) \; d m(y)  \Big]  \; dm(x) &=\int \Big[   \int e^{-y^2/2} \; d m(x)  \Big]  \; dm(y) \\
      &= \int ye^{-y^2/2} \; dm(y) \\
      & = \int_{[0,\infty)} ye^{-y^2/2} \; dy 
\end{align}
Make the substitution \(t = \frac{y^2}{2}\), then we have
\[
\int_0^\infty y\, e^{-y^2/2}\,dy =
\int_0^\infty e^{-t}\,dt =
\Bigl[ - e^{-t} \Bigr]_{0}^{\infty} = 1
\]
This finishes the proof that \[
 \int_0^\infty\int_x^\infty e^{-y^2/2}\;d y \;d x = 1
\]
\end{proof}




\section{integration of a function $=$ Area under the curve}
  Let $(X,\mathcal{A},\mu)$ be a $\sigma$-finite measure space, and let $f\in L^+(X)$. Consider the subset  $G_f\subset X\times[0,\infty)$ consisting of all points $(x,y)$ with $y<f(x)$.
  \begin{itemize}
  \item[(a)]Prove that $G_f$ is $\mathcal{A}\otimes\mathcal{B}_\mathbb{R}$-measurable.
  \item[(b)]Prove that $(\mu\otimes m)(G_f)=\int f\; d\mu$.
  \end{itemize}  
\begin{remark}
    这个 $G_f$ 即为 $f:X \to \mathbb{R}$ 的 graph 下的 area, 
\end{remark}
\begin{proof}
    \textbf{of 2(a):}\\
\[y < f(x)\quad\Longleftrightarrow\quad
\exists\,q\in\mathbb{Q},\; y < q < f(x)\]
Hence
\[G_f =
\bigcup_{q\in\mathbb{Q},\,q>0}\Bigl(\{x : f(x) > q\}\times \{y : y < q\}\Bigr)
\]
Since \(\{x : f(x) > q\}\in \mathcal{A}\) (by the measurability of \(f\)) and \(\{y : y < q\}\in \mathcal{B}_\mathbb{R}\), each set in the union is a measurable rectangle, thus measurable in the product measurable space \(X \times \mathbb{R}\). Since a countable union of measurable sets is measurable in the product \(\sigma\)-algebra, 
We have \[G_f \in \mathcal{A}\otimes \mathcal{B}_\mathbb{R}\]
\end{proof}
\begin{proof}
    \textbf{of 2(b)}:\\
Since \(f \ge 0\), and \(\sigma\)-finiteness of $X$ is assumed, \(\sigma\)-finiteness of $Y$ is known, \\ 
we can apply Tonelli’s theorem to compute:
\begin{align}
    (\mu \otimes m)(G_f) &= 
\int_{X\times [0,\infty)} \chi_{G_f}(x,y)\, d(\mu\otimes m)\\
&= \int_X  \Big[ \int_ {[0,\infty)} \chi_{G_f}(x,y)\, d m(y)\Big] \;d \mu(x)
\end{align}
By definition of \(G_f\), \(\chi_{G_f}(x,y) = 1\) if and only if \(y < f(x)\), and \(0\) otherwise. Hence, for each fixed \(x\),
\[
\int_{[0,\infty)} \chi_{G_f}(x,y)\,dm(y) =
\int_{[0,\infty)} \chi_{\{ y < f(x)\}}\,dm(y) = 
\begin{cases}
f(x), & \text{if } f(x) < \infty,\\
\infty, & \text{if } f(x) = \infty
\end{cases}
\]
Therefore
\[
\int_{[0,\infty)} \chi_{G_f}(x,y)\,dm(y) = f(x) \;\; a.e.
\]
Applying Tonelli’s theorem again yields
\[
(\mu \otimes m)(G_f) = \int_X  \Big[ \int_ {[0,\infty)} \chi_{G_f}(x,y)\, d m(y)\Big] \;d \mu(x) = 
\int_X f(x)\, d\mu(x)
\]
Thus we conclude that
\[
(\mu \otimes m)(G_f) = 
\int_X f \, d\mu \]
\end{proof}




\section{Oscillations}
  Consider the sequence $f_n(x)=(\sin(\pi n x))^n$, $n=1,2,\dots$, on the interval $[0,1]$. Prove that there exists a set $E\subset[0,1]$ such that $m(E^c)\le 2^{-597}$ and a sequence $1\le n_1<n_2<\dots$ such that $|f_{n_j}(x)|\le j^{-597}$ for all $x\in E$ and all $j\ge1$. \textit{Hint}: use E. Consider convergence in measure
\begin{proof}
\textbf{Claim 1: It suffices to show that $f_n $ converges in measure.}\\
Proof of Claim 1: Suppose $f_n $ converges in measure to $f = 0$, then by Folland 2.30, there exists a subseq $(f_{n_k}) \overset{k \to \infty}{\longrightarrow} f= 0$ a.e. .And since $[0,1]$ has \textbf{finite measure} $1$, \textbf{by Egoroff's Theorem},  for any $\epsilon>0$ there exists $E \subset [0,1]$ s.t. $\mu(E^c) < \epsilon$ and $(f_{n_k}) \overset{k \to \infty}{\longrightarrow} f= 0$ \textbf{uniformly} on $E$. \\
Then we take $\epsilon : = 2^{-597}$and coresponding $E$.\\
And for each $j \in \mathbb{N}$, we let $\delta_j = j^{-597}$. By the uniform convergence property of $(f_{n_k})$, we can take $N_j$ s.t. $|f_{n_k}(x)| < \delta_j $ for all $x \in E$ whenever $n_k \geq N_j$.\\
Therefore, $E$ and the sequence $(f_{N_j})$  satisfty the requirements in the context.\\
This shows that, \textbf{as long as we can show $(f_n)$ converges in measure} to $f = 0$, the statement is proved.\\\\
Let $f_n (x) : = \sin( n\pi x)^n $ for $n\in \mathbb{N}$.\\
\textbf{Claim 2:} $f_n $ \textbf{converges in measure.}\\
Proof of Claim 2: The idea is that the exponent $n$ makes the sequence converge faster than the linear growth of $nx$ that shortens a period and messes up the sin values.\\ 
Fix $\epsilon  > 0$. (WLOG $\epsilon < 1$.) WTS: \[
m(\{ x: |\sin (n \pi x) \geq \epsilon^{1/n}  \}) \to 0 \quad \text{ as } n\to \infty
\]
We know that $\sin(n\pi x) = 1$ iff $x = \frac{2k-1}{2n}$ for some $k = 0,\cdots, 2n-1$.
Consider $x \in [0,\frac{1}{2n})$, let $|\sin(n \pi x_0 ) | : = \epsilon^{1/n}$.\\
Denote \[
\delta_n :=\Big |\frac{1}{2n} - x_0 \Big| 
\]
Then we can express the measure as: \[
m(\{ x: |\sin (n \pi x) \geq \epsilon^{1/n}  \}) = 2n  \delta_n
\]
Notice that by the monotonicity of arcsin function, we can solve for $x_0$ as:\[
x_0  =\frac{1}{n\pi} \arcsin (\epsilon^\frac{1}{n})
\]
Thus \[
\delta_n = \frac{1}{2n} = \frac{1}{n\pi} \arcsin (\epsilon^\frac{1}{n})
\]
Thus  \begin{align}
\lim_{n\to \infty}m(\{ x: |\sin (n \pi x) \geq \epsilon^{1/n}  \}) &=  \lim_{n\to\infty} 2n  \delta_n     \\
&= 1-  \lim_{n\to\infty}  \frac{2}{\pi}\arcsin (\epsilon^\frac{1}{n}) \\
&= 1-\frac{2}{\pi} \cdot \frac{\pi}{2} \\
&=0
\end{align}
Since $\epsilon$ is arbitrary, this finishes the proof that $f_n \to f = 0$ in measure.\\
Thus combining Claim 1, the whole statement is proved.
\end{proof}





\section{Indicator functions 是 $L^+$ 的一个 closed subset}
  Let $(X,\mathcal{A},\mu)$ be any measure space. Let $M\subset L^+$ be the set of indicator functions $\chi_E$, where $E\in\mathcal{A}$ and $\mu(E)<\infty$. Prove that $M$ is a closed subset of $L^1$. In other words, prove that $M\subset L^1$, and that if $f_n\in M$, $f\in L^1$, and $\int|f_n-f|\to0$, then $f\in M$.

\begin{proof}
Let $(f_n := \chi_{E_n})_{n\in\mathbb{N}}$ be a seq of indicator functions in $L^+$ s.t. $\int|f_n-f|\to0$ for some $f\in L^1$.  \\
Define for all $k\in \mathbb{N}$ $$
A_k :=\{x\colon |f(x)|>\frac{1}{k},|f(x)-1|>\frac{1}{k}\}
$$
Fix one $k\in\mathbb{N}$, bt monotonicity of integration in $L^1$, we have
$$\int|f-\chi_{E_n}|\geq \int_{A_k}|f-\chi_{E_n}|\geq   \int_{A_k} \frac{1}{k}   \geq     \frac{\mu(A_k)}{k}$$
Thus \[
\mu(A_k) \leq k \int |f-\chi_{E_n}|
\]
Since $\chi_{E_n}\to f$ in $L^1$, it follows that $\mu(A_k)=0$.\\
Since $A_k$ is arbitrary, by ctbl sub additivity, \[
\mu(\bigcup_{k=1}^{\infty}A_k) \leq \sum_{k=1}^{\infty}\mu(A_k)= 0 
\]
Define \[
A:=\{x\colon f(x)\not=0,1\}
\]
By the definition of $A_k$, we have the equality: \[
A=\bigcup_{k=1}^{\infty}A_k
\]
Thus $\mu(A) = 0$, which means that $f(x)\in\{0,1\}$ a.e., showing that $f$ is a.e. an indicator function, in the same equivalence class of some indicator function in $L^1$, thus we have $f \in M \subset L^1$. This finishes the proof that $M$ is a closed subset of $L^1$.
\end{proof}





\section{a complete metric space of measurable functions (other then $L^1(\mu)$) }
  Suppose that $(X,\mathcal{A},\mu)$ is a measure space such that $\mu(X)<\infty$. Set $\chi(t)=\frac{t}{1+t}$ for $t\ge 0$.\\
  Given measurable functions $f,g\colon X\to\mathbb{C}$, set\[
    \rho(f,g):=\int\chi(|f-g|)\; d\mu
  \]
  \begin{itemize}
  \item[(a)]Prove that $\rho$ induces a metric, also denoted $\rho$, on the space \[
      L:=\{f\colon X\to\mathbb{C}\ \text{measurable}\}/\!\!\sim,
    \]
    where $f\sim g$ iff $f=g$ a.e. \textit{Hint}: prove that $\chi(s+t)\le\chi(s)+\chi(t)$ for $s,t\ge0$.
  \item[(b)]Prove that if $f_n,f\in L$, then $\rho(f_n,f)\to0$ iff $f_n\to f$ in measure.
  \item[(c)] Prove that $(L,\rho)$ is a complete metric space.
  \end{itemize}    
\begin{remark}
\textbf{对于任何 measure $\mu$, $L^1(\mu)$ 都是一个 complete metric space (因为它是 Banach space)}; 这里, 我们略微修改了 $L^1(\mu)$ 的 metric, 嵌套了一个函数, 但是它\textbf{仍然是一个 complete metric space.}
\end{remark}
\begin{proof}
   \textbf{ of 5(a):}
$\chi(t)=\frac{t}{1+t} = 1- \frac{1}{1+t}$ is an increasing function on $t \geq 0$.\\
\textbf{Claim: for all $s,t \geq 0$, we have $ \chi(s) + \chi(t)  \leq \chi(s+t)$.}\\
\textbf{Proof of claim: }\\
Let $s,t \geq 0$, we have
\[
   \chi(s) + \chi(t) =
   \frac{s}{1+s} \;+\; \frac{t}{1+t} =
   \frac{s(1+t) + t(1+s)}{(1+s)(1+t)} =
   \frac{s + st + t + ts}{(1+s)(1+t)} = 
   \frac{s + t + 2st}{(1+s)(1+t)}
\]
while
\[\chi(s+t) =
   \frac{s+t}{1 + s + t}
\]
Note
\begin{align}
        (s+t)(1+s)(1+t)  = (s+t)(1 + s + t + st) &=  s + t + s^2 + 2st + t^2 + s^2t + st^2\\
          (s+t + 2st)(1 + s + t) &=s + t + s^2 + 4st+ t^2 + 2s^2t + 2st^2
\end{align}
We have: \[
  (s+t)(1+s)(1+t) \leq   (s+t + 2st)(1 + s + t)
\]
Since $(1 + s + t)$ and $(1+s)(1+t)$ are positive, we can rearrange the ineq to be  \[
   \frac{s+t}{1+s+t} \leq
   \frac{s+t+2st}{(1+s)(1+t)}
\] which is exactly \[   \chi(s) + \chi(t)  \leq \chi(s+t)\]
as needed.\\\\
First, $\rho$ is a well-defined function on the quotient set, since if \(f \sim g\) and \(f' \sim g'\) then \(|f-g| = |f'-g'|\) a.e. Consequently,
\[
   \chi\bigl(|f-g|\bigr) \;=\; \chi\bigl(|f' - g'|\bigr)
   \quad \text{a.e.}
\]and hence \[
   \int_X \chi\bigl(|f-g|\bigr)\,d\mu  = 
   \int_X \chi\bigl(|f' - g'|\bigr)\,d\mu
\]
Now we prove that \(\rho\) is a metric:
\begin{itemize}
    \item \textbf{Nonnegativity}: \(\rho(f,g) \ge 0\) is immediate since \(\chi(\cdot)\ge0\) and \(\mu\) is a measure; and since $\chi(h) = 0 $ iff $h=0$ a.e., we have \(\rho(f,g) = 0\) iff $f = g$ a.e., that is, $f = g \in L^1(\mu)$
    \item \textbf{Symmetry}: \(\rho(f,g)=\rho(g,f)\) follows immediately from \(\chi(|f-g|) = \chi(|g-f|)\).
    \item \textbf{Triangle inequality}:    For any three functions \(f,g,h\), we have pointwise \[
     |f(x)-h(x)| 
     \;\le\;
     |f(x)-g(x)| + |g(x)-h(x)|.
   \]
   Then applying the subadditivity of \(\chi\) proved above, we have: \[
     \chi\bigl(|f(x)-h(x)|\bigr)  \leq 
     \chi\bigl(|f(x)-g(x)| + |g(x)-h(x)|\bigr) \leq 
     \chi\bigl(|f(x)-g(x)|\bigr)  +
     \chi\bigl(|g(x)-h(x)|\bigr)
   \]
   Integrating both sides over \(X\) gives  \[
     \rho(f,h)  =
     \int_X \chi\bigl(|f-h|\bigr)\,d\mu \leq 
     \int_X \chi\bigl(|f-g|\bigr)\,d\mu  +
     \int_X \chi\bigl(|g-h|\bigr)\,d\mu =
     \rho(f,g) +\rho(g,h)
   \]

\end{itemize} 
Therefore, \(\rho\) is a metric on \( L \;=\; \{f \colon X\to \mathbb{C} \text{ measurable} \}/\!\!\sim\) as desired.
\end{proof}


\begin{proof}
   \textbf{ of 5(b)}: \\
\textbf{Claim 1: \(\rho(f_n,f)\to 0\) \(\implies\) \(f_n\to f\) in measure}\\
Suppose \(\rho(f_n,f)\to 0\).  Let $\epsilon > 0$.\\
Since \(\chi(t)=\tfrac{t}{1+t}\) is\textbf{ strictly increasing} in \(t\): \[
    |f_n-f|> \epsilon \Longleftrightarrow 
    \chi\bigl(|f_n-f|\bigr) \;>\; \chi(\epsilon)\;=\;\frac{\epsilon}{1+\epsilon}
  \]
Hence \[
    \{|f_n-f| > \epsilon\} = \bigl\{\chi(|f_n-f|) > \tfrac{\epsilon}{1+\epsilon}\bigr\}
  \]
Since the function is nonnegative, by Chebyshev:\[
 \mu(  \{|f_n-f| > \epsilon\} ) =    \mu\Bigl(\bigl\{\chi(|f_n-f|)>\tfrac{\epsilon}{1+\epsilon}\bigr\}\Bigr) \leq 
    \frac{1}{\,\tfrac{\epsilon}{1+\epsilon}\,}
    \int\chi\bigl(|f_n-f|\bigr)\,d\mu =  \frac{\rho(f_n,f)}{\chi(\epsilon)}
  \]
By assumption, $\rho(f_n,f) \to 0$, thus \[
    \mu\bigl(\{|f_n-f|>\epsilon\}\bigr) \leq 
    \frac{\rho(f_n,f)}{\chi(\epsilon)}\longrightarrow\;0
  \]
Since $\epsilon$ is arbitrary, it proves that \(f_n\to f\) in measure.\\\\

\textbf{Claim 2: \(f_n\to f\) in measure \(\implies\) \(\rho(f_n,f)\to0\)}\\
Now assume \(f_n\to f\) in measure. \\
Let $\delta > 0$.\\
Observe that for any \(\epsilon>0\): 
\begin{itemize}
    \item \(|f_n-f|\le \epsilon \implies  \tfrac{|f_n-f|}{1+|f_n-f|}\le \tfrac{\epsilon}{1+\epsilon}\).
    \item \(|f_n-f|\ge \epsilon \implies  \tfrac{|f_n-f|}{1+|f_n-f|}\leq 1 \)
\end{itemize}
Hence by choosing any arbitrary $\epsilon$, we can bound the integral by: \[
  0  \leq  \int_X \frac{|f_n-f|}{1+|f_n-f|}\,d\mu \leq
  \int_{\{|f_n-f|\le \epsilon\}} \frac{\epsilon}{1+\epsilon}\, d\mu +
  \int_{\{|f_n-f|> \epsilon\}} 1 \,d\mu
\]
For the first term:
\[
  \int_{\{|f_n-f|\le \epsilon\}} \frac{\epsilon}{1+\epsilon}\, d\mu = 
  \frac{\epsilon}{1+\epsilon}\;\mu\bigl(\{|f_n-f|\le \epsilon\}\bigr) \leq
  \frac{\epsilon}{1+\epsilon}\;\mu(X)
\]
Because \(\mu(X)\) is finite, we can choose $\epsilon$ s.t. \(\tfrac{\epsilon}{1+\epsilon}\mu(X) < \delta / 2\).\\
Once \(\epsilon\) is fixed, by convergence in measure there exists \(N\) such that for all \(n\ge N\),
\[
  \mu\bigl(\{|f_n-f|> \epsilon\}\bigr) < \delta /2
\]
Then for any $n\geq N$, we have:
\[
  \rho(f_n,f) = 
  \int_X \chi(|f_n-f|)\,d\mu \leq
  \mu(X)\,\frac{\epsilon}{1+\epsilon}  +
  \mu\bigl(\{|f_n-f|> \epsilon\}\bigr) < \delta
\]
 Hence \[\rho(f_n,f)\overset{n\to \infty}{\longrightarrow} 0\]
\end{proof}


\begin{proof}
   \textbf{ of 5(c): }\\
   Suppose $(f_n)$ is a Cauchy seq in $(L,\rho)$, i.e. for any $\epsilon > 0$, exists some $N>0$ s.t. \(\rho(f_m, f_n)  < \epsilon\) whenever $n,m \geq N$.\\
   WTS: $(f_n)$ converges, i.e. $\rho(f_n,f)\to0$. \\
By (b) we know \textbf{it suffices to show that $f_n\to f$ in measure}.\\
And by Folland 2.30, \textbf{ STS: $(f_n)$ is Cachy in measure}.\\
Let $\epsilon > 0$. Let $\delta > 0$.\\
by Chebyshev:\[
 \mu(  \{|f_n-f_m| > \epsilon\} ) =    \mu\Bigl(\bigl\{\chi(|f_n-f_m|)>\tfrac{\epsilon}{1+\epsilon}\bigr\}\Bigr) \leq 
    \frac{1}{\,\tfrac{\epsilon}{1+\epsilon}\,}
    \int\chi\bigl(|f_n-f_m|\bigr)\,d\mu =  \frac{\rho(f_n,f_m)}{\chi(\epsilon)}
  \]
So since $(f_n)$ is a Cauchy, there exists $N > 0$ s.t. $\rho(f_n,f_m) < \chi(\epsilon) \delta$ whenever $n,m \geq N$, thus  $ \mu(  \{|f_n-f_m| > \epsilon\} ) \leq \delta$ whenever $m,n \geq N$.\\
This proves that $(f_n)$ is Cachy in measure, thus $f_n\to f$ in measure, and thus $(f_n)$ converges, showing that every Cachy seq converges in $(L,\rho)$. Therefore $(L,\rho)$ is a complete metric space. 
\end{proof}








\section*{Nur f\"ur Verr\"uckte}
(It's \textbf{really} not necessary to attempt these problems. Do not, under any circumstances, hand them in!)
\begin{enumerate}
\item Prove that the category of measurable spaces (see HW1) admits finite products, and that the product of $(X,\mathcal{A})$ and $(Y,\mathcal{B})$ equals $(X\times Y,\mathcal{A}\otimes\mathcal{B})$. 
\item Now consider the category of measure spaces (see HW2). Consider two 
  measure spaces $(X_i,\mathcal{A}_i,\mu_i)$, $i=1,2$, and set $X=X_1\times X_2$, $\mathcal{A}=\mathcal{A}_1\otimes \mathcal{A}_2$, and $\mu=\mu_1\times\mu_2$.
  \begin{itemize}
  \item[(a)]Prove that the projection maps $X\to X_i$ are measurable, and that they are measure preserving iff $\mu_j(X_j)=1$ for $j=1,2$. Thus $(X,\mathcal{A},\mu)$ is \emph{not} the categorical product of $(X_i,\mathcal{A}_i,\mu_i)$ in general.
  \item[(b)]Prove that even if $\mu_i(X_i)=1$, the measure space $(X,\mathcal{A},\mu)$ is \emph{not} the categorical product of $(X_i,\mathcal{A}_i,\mu_i)$ in general.
    \textit{Hint}: consider the case when the $X_i$ consist of two elements, for example $X_i=\{\mathfrak{o}_i,\mathfrak{v}_i\}$.
  \end{itemize}
\end{enumerate}












\chapter{on differentiaion}

\begin{center}
\textit{None of the following questions will be graded. Do them, but do not hand them in}.
\end{center}

\section{Completion of completions}

Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{B}, \nu)$ be measure spaces. Let $(X, \bar{\mathcal{A}}, \bar{\mu})$ and $(Y, \bar{\mathcal{B}}, \bar{\nu})$ be their completions, respectively. 
Then, the completion of $(X\times Y, \mathcal{A}\otimes \mathcal{B}, \mu\times \nu)$ is same as the completion of $(X\times Y, \bar{\mathcal{A}}\otimes \bar{\mathcal{B}}, \bar{\mu}\times \bar{\nu})$.

\section{Modified HL maximal inequality}
Prove that there is a constant $C_n>0$ that only depends on $n$ such that for every $f\in L^1(\mathbb{R}^n)$ and $\alpha>0$,
\[
m(\{x\in \mathbb{R}^n\mid Hf(x)\ge \alpha\}) \le \frac{C_n}{\alpha} \int_{\mathbb{R}^n} |f(x)|\;d x
\]
(Remark: We had $Hf(x)> \alpha$ for the HL maximal inequality. Here we have $Hf(x)\ge \alpha$.) 





\section{Density at a point}
  For a Lebesgue measurable subset $E$ of $\mathbb{R}^n$, the \emph{density of $E$ at $x$} is defined as 
  \[
    D_E(x)= \lim_{r\to 0} \frac{m(E\cap B(x,r))}{m(B(x,r)}
  \]
  provided that the limit exists.
  Prove that $D_E(x)=1$ for a.e. $x\in E$ and $D_E(x)=0$ for a.e. $x\in E^c$. 
  \textit{Hint}: ask Lebesgue.


\newpage
\vspace*{5mm}
\begin{center}
\textit{Some of the following questions will be graded. Do them, and do hand them in}.
\end{center}

\section{An identity}
  Prove that $\int_0^\infty e^{-2sx}\frac{\sin^2x}{x}\;d x=\frac14\log(1+s^{-2})$ for $s>0$ by integrating the function $e^{-2sx}\sin(2xy)$ with respect to $x$ and $y$ over suitable regions.
\begin{proof}
For fixed $x> 0$, by FTC we have:   \[\sin^2 (x)  = \int_0^x \sin(2t)\,dt\]
We do change of variable \(t = xy\). This is a valid diffeomorphism mapping $y\in (0,1)$ to $t \in (0,x)$.\\
Then by change of variable theorem we have: \[\int_{(0,x)} \sin(2t)\,dt = \int_{(0,1)}  x\sin(2xy)\,dy\]Thus \[
\frac{\sin^2 x}{x} = 
\int_0^1 \sin(2xy)\,dy
\]
Then we get: \[
\int_0^\infty e^{-2sx}\frac{\sin^2x}{x}\;d x = \int_0^\infty e^{-2sx}\bigg[\int_0^1 \sin(2xy)\,dy\bigg]\;d x
\]
Consider the function \[
f(x,y) := e^{-2sx}\sin(2xy),\quad (x,y) \in (0,\infty) \times (0,1)
\]
$f$ is a composition of continuous functions, thus continuous. Note that it is also in $L^1( (0,\infty) \times (0,1))$ since $|f(x,y)|$ is bounded by $g (x,y):= e^{-2sx}$, which is $L^1$ on the same domain (its integral is $\frac{1}{2s}$), then by DCT, $f \in L^1( (0,\infty) \times (0,1))$.\\
Thus we can apply Fubini's theorem to switch the order of integration: \begin{align}
    \int_0^\infty e^{-2sx}\bigg[\int_0^1 \sin(2xy)\,dy\bigg]\;d x &= \int_{(0,\infty) \times (0,1)} e^{-2sx}\,\sin(2xy)\,d (x\times y) \\
    &= \int_0^1 
\Bigl(\int_0^\infty e^{-2 s x} \sin(2xy)\,dx\Bigr)dy
\end{align}
Recall back in Calculus we use integration by part to get: \[
\int_0^\infty e^{-a x}\,\sin(b x)\,dx= 
\frac{b}{a^2 + b^2}
\]
for \(a>0\).  In our case, \(a = 2s\) and \(b = 2y\).
Thus \[
\int_0^\infty e^{-2 s x}\,\sin(2xy)\,dx =
\frac{2y}{(2s)^2 + (2y)^2} = 
\frac{y}{2\,(s^2 + y^2)}
\]
Therefore we here get \begin{align}
    \int_0^\infty e^{-2sx}\frac{\sin^2x}{x}\;d x  & =\int_0^1 
\Bigl(\int_0^\infty e^{-2 s x} \sin(2xy)\,dx\Bigr)dy\\
    &= \int_0^1 \frac{y}{2\,(s^2 + y^2)} \, dy \\
    & = \frac{1}{2 } \int_0^1 \frac{y}{s^2 + y^2} \, dy 
\end{align}
By Calculus we have (by chain rule): \[
\int_0^1 \frac{y}{s^2 + y^2}\,dy  =     \bigg[   \frac{1}{2}\log \bigl(s^2 + y^2\bigr)\bigg]_0^1  = \frac{1}{2}
\log\Bigl(\frac{s^2 + 1}{s^2}\Bigr) = 
\frac{1}{2}\log \bigl(1 + \tfrac1{s^2}\bigr)
\]
Thus we conclude: 
\begin{align}
    \int_0^\infty e^{-2sx}\frac{\sin^2x}{x}\;d x  &= \frac{1}{2 } \int_0^1 \frac{y}{s^2 + y^2} \, dy\\ &= \frac{1}{2} \cdot \frac{1}{2}\log \bigl(1 + \tfrac1{s^2}\bigr) \\
    &= \frac{1}{4}\log \bigl(1 + \tfrac1{s^2}\bigr)
\end{align}
as desired. 
\end{proof}



\section{Diagonals}
  \begin{itemize}
  \item[(a)]Prove that if $E\in\mathcal{A}\otimes\mathcal{A}$, then  \[
      \{ x\in X: (x,x)\in E\} \in \mathcal{A}
    \]
  \item[(b)]Using this fact, find an example of a subset $E\subset \mathbb{R}\times \mathbb{R}$ such that $E_x\in \mathcal{L}(\mathbb{R})$ for all $x\in \mathbb{R}$ and $E^y\in \mathcal{L}(\mathbb{R})$ for all $y\in \mathbb{R}$, but $E\notin \mathcal{L}(\mathbb{R})\otimes  \mathcal{L}(\mathbb{R})$.
    \textit{Hint}: ask Vitali.
  \end{itemize}

\begin{proof}
    \textbf{of (a):}\\
We consider the map: \begin{align}
    \phi: X &\to X \times X  \\
     x & \mapsto (x,x)
\end{align}
Then it suffices to show that $\phi$ is $(\mathcal{A},\mathcal{A}\otimes \mathcal{A})$-measurable. Since if so, then for each $E\in\mathcal{A}\otimes\mathcal{A}$, $\phi^{-1}(E)  =  \{x\in X : (x,x)\in E\}\in \mathcal{A}$, which is exactly what we want.\\
Let $A \times B \in  \mathcal{A}\otimes \mathcal{A} $ be a measurable rectangle, we discover that:
$$\phi^{-1}(A \times B)  =  \{x\in X : x \in A , x \in B\} = A \cap B \in \mathcal{A}$$
\pic[0.35]{hw7.assets/image-20250314181717946.png}
We first prove a lemma:
\begin{lemma}
    Suppose $f: X\to Y\times Z$ is a function from a measurable space $(X,\mathcal{A})$ to a product measure space $(Y\times Z, \mathcal{B}_1 \otimes \mathcal{B}_2)$.\\
  Claim: If $f^{-1}(B\times C)\in\mathcal{A}$ for each measurable rectangle $B_1 \times B_2 \in \mathcal{B}_1 \otimes \mathcal{B}_2$, then $f$ is an $(\mathcal{A}, \mathcal{B}_1 \otimes \mathcal{B}_2)$-measurable function.
\end{lemma}
\begin{proof}
    \textbf{of Lemma:}\\
     Since $f^{-1}(B\times C) \in \mathcal{A}$ for each measurable rectangle $B_1 \times B_2 \in \mathcal{B}_1 \otimes \mathcal{B}_2$, the preimage of any countable disjoint unions of measurable rectangles, is also in $\mathcal{A}$, since $\mathcal{A}$ is an $\sigma$-algebra.\\
     We want to show: $f^{-1}(E) \in\mathcal{A}$ for any $E \in  \mathcal{B}_1 \otimes \mathcal{B}_2$. It is equivalent to show that \[
\mathcal{B}_1 \otimes \mathcal{B}_2 \subset   \mathcal{C} : = \{ E \in Y\times Z  : \phi^{-1} (E) \in \mathcal{A}        \}
\]
Note that, it suffices to show that: $\mathcal{C}$ is an $\sigma$-algebra. This is because we have shown $$\{\text{all disjoint unions of measurable rectangles in }   Y\times Z\} \subset \mathcal{C}$$, and this is an algebra generating $\mathcal{B}_1 \otimes \mathcal{B}_2$. Thus, if $\mathcal{C}$ is an $\sigma$-algebra, we must have \(
   \mathcal{B}_1 \otimes \mathcal{B}_2 \subset \mathcal{C}
   \). \\
   And since $\{\text{all disjoint unions of measurable rectangles in }   Y\times Z\}$ is an algebra, it suffices to show that $\mathcal{C}$ is a monotone class, by the monotone class lemma.\\
   
Suppose \(E_1 \subseteq E_2 \subseteq \cdots\) with each \(E_n \in \mathcal{C}\), i.e. $\phi^{-1}(E_n) \in \mathcal{A}$.
Since \(\{E_n\}\) is increasing, we hve
\[
  \phi^{-1}(E_1) \;\subseteq\; \phi^{-1}(E_2) \;\subseteq\; \cdots \;\subseteq\; \phi^{-1}(E_n) \;\subseteq\; \cdots
\]
Since \(\mathcal{A}\) is an \(\sigma\)-algebra, we have \[
  \phi^{-1}\Bigl(\bigcup_{n=1}^\infty E_n\Bigr) = 
  \bigcup_{n=1}^\infty \phi^{-1}(E_n) \in\mathcal{A}
\]Thus \[
   \bigcup_{n=1}^\infty E_n \;\in\; \mathcal{C}
\]
This is dually true for decreasing intersection, \textbf{finishing the proof that $\mathcal{C}$ is a monotone class thus $\sigma$-algebra,} \textbf{thus proving the lemma.}\\
\end{proof}
After we proved the Lemma, we return to the original statement, concluding that $\phi$ is $(\mathcal{A},\mathcal{A}\otimes \mathcal{A})$-measurable, thus finishing the proof: if $E\in\mathcal{A}\otimes\mathcal{A}$, then  \[
      \{ x\in X: (x,x)\in E\} \in \mathcal{A}
    \]
\end{proof}



\begin{solution}
    \textbf{of (b):}\\
\end{solution}



\section{Too dense}
  Prove that if $E\subset \mathcal{L}(\mathbb{R})$ is a Lebesgue measurable subset such that  \[
    m(E\cap I)\le 0.123m(I) 
  \]
  for all open intervals $I\subset  \mathcal{L}(\mathbb{R})$, then $m(E)=0$. 
\begin{proof}
    Since $E$ is Lebesgue measurable, $m(E) = m^*(E)$.\\
    Let $\epsilon > 0$.\\
    Then by definition of outer mesure, we can pick open intervals seq $\{I_k\}_{k=1}^\infty$ covering $E$ s.t. \[
   m(E) >  \sum_{k=1}^\infty m(I_k )    -\epsilon
    \] Since $E \subset \bigcup_k I_k$, we have  \begin{align}
        E & = (\bigcup_k I_k)  \cap E \\
        & = \bigcup_k (I_k \cap E)\\
    \end{align}
    Thus \begin{align}
        m(E) = m(\bigcup_k (I_k \cap E)) &\leq \sum_k m(I_k \cap E)\quad\text{by ctbl subadditivity }\\
        &\leq 0.123 \sum_k \,m(I_k)  \quad \text{by our requirement}
    \end{align}
    Thus we have: 
    \begin{align}
            \sum_k  m(I_k )    -\epsilon &<  0.123 \sum_k m(I_k)\\
            0.877 \sum_k m(I_k) &< \epsilon\\
            \sum_k m(I_k) &< \frac{\epsilon}{0.877}
    \end{align}
  Thus   \[
  m(E) \leq   \sum_k  m(I_k )   <  \frac{\epsilon}{0.877}
    \]
    Since $\epsilon > 0$ is arbitrary, this proves that \[
    m(E)  = 0
    \]
\end{proof}




\section{Prescribing a Lebesgue density}
  Let $0<\alpha <1$.
    Find an example of a Lebesgue measurable subset $E$ of $[0,\infty)\subset  \mathcal{L}(\mathbb{R})$ whose density at $0$ is $\alpha/2$. 
    \textit{Hint}: Consider $E=\bigcup_{n=1}^\infty I_n$. where $I_n=(x_n,x_n+\delta_n)$ are disjoint small intervals accumulating at $0$.
\begin{proof}
    Consider \[
E := \bigcup_{n=1}^{\infty}
\bigr( \frac{1}{2^{n+1}},
 \frac{1+\alpha}{2^{n+1}}\bigr)
\]

\end{proof}




\section{Sequences of complex numbers}
  \begin{itemize}
  \item[(a)]
    Prove that $\ell^1\subsetneq\bigcap_{1<p<\infty}\ell^p$.
  \item[(b)]
    Prove that $\bigcup_{1<p<\infty}\ell^p\subsetneq\ell^\infty$.
  \end{itemize}
    
\begin{proof}
    \textbf{of (a):}\\
We first want to show: for any \(1 < p < \infty\), we have: \[
\ell^1 \subseteq \ell^p
\]
Fix $p>1$.\\
Let \((x_n) \in \ell^1\). By definition, 
\[
  \sum_{n=1}^{\infty} |x_n| < \infty
\]
We need to show that \(\sum_{n=1}^\infty |x_n|^p < \infty\).\\
\textbf{Claim: There are at most finitely many $n\in \mathbb{N}$ s.t. $|x_n| \geq 1$}.\\
Proof of Claim: Suppose for contradiction that there are inifinitely many $n\in \mathbb{N}$ s.t. $|x_n| \geq 1$, say, all terms in the subseqence $\{x_{n_j}\}_{j=1}^\infty$ has $|x_{n_j}|\geq 1$. Then \[
\sum_{n=1}^{\infty} |x_n| \geq \sum_{j=1}^{\infty} |x_{n_j}|\geq \sum_{j=1}^{\infty} 1 = \infty
\]which contradicts with \((x_n) \in \ell^1\).\\
Thus, suppose only on the finite terms $\{x_{n_j}\}_{j=1}^N$ we have $|x_{n_j}|\geq 1$ (WLOG $N\geq 1$). Then
\[
\sum_{n=1}^{\infty} |x_n| =\sum_{j=1}^{N} |x_{n_j}| + \sum_{n \not = n_j \text{ for any }j} |x_n|
\]
Since for $n$ s.t. n $\not = n_j \text{ for any subseq index }j$, we have $|x_n| <1$, for these indexes we have: \[
|x_n|^p < |x_n| \quad \text{for any } p >1
\] Thus we have \[
\sum_{n \not = n_j \text{ for any }j} |x_n|^p  < \sum_{n \not = n_j \text{ for any }j} |x_n| < \infty
\]
And also, \[
\sum_{j=1}^{N} |x_{n_j}|^p < \infty \quad \text{ since only have finite terms}
\]
Thus \[
\sum_{n=1}^{\infty} |x_n|^p =\sum_{j=1}^{N} |x_{n_j}|^p + \sum_{n \not = n_j \text{ for any }j} |x_n|^p < \infty
\]
Thus \[
\ell^1 \subseteq \ell^p
\]
Since $p>1$ is arbitrary, this proves that
\[
   \ell^1 \subseteq \bigcap_{1<p<\infty}\ell^p
\]
To show the strictness of the inclusion, we consider the \textbf{harmonic series} \(\sum_{n=1}^\infty \frac{1}{n}\). We know that it diverges and for any \(p>1\), the \textbf{\(p\)-series} \(\sum_{n=1}^\infty \frac{1}{n^p}\) (absolutely for sure) converges, thus  \(\bigl(\tfrac{1}{n}\bigr) \notin \ell^1\) but \(\bigl(\tfrac{1}{n}\bigr) \in \ell^p\) for every \(p>1\), showing that \[
   \ell^1 \not= \bigcap_{1<p<\infty}\ell^p
\]This finishes the proof that 
\[
   \ell^1 \subsetneq \bigcap_{1<p<\infty}\ell^p
\]
\end{proof}


    
\begin{proof}
    \textbf{of (b):}\\
Fix $p>1$.\\
Suppose sequence \(( x_n) \) belongs \(\ell^p\), then \[
\sum_{n=1}^{\infty} |x_n|^p < \infty
\]
This implies that \( x_n \to 0 \) as \( n \to \infty \), because if it did not, there would be infinitely many terms where \( |x_n| \) is bounded away from zero, leading to divergence of the sum.\\
Suppose for contradiction that \[
\sup_{n} |x_n| = \infty
\]Then there are infinitely many terms $n$ s.t. $|x_n| > 1$, since otherwise, exists some $N$ s.t. all $|x_n| \leq 1$ for $n\geq N$, then $\sup |x_n|\leq \max(1, \max_{1\leq n \leq N-1} |x_n| )< \infty$.\\
Suppose for the subseq $\{x_{n_j}\}_{j=1}^\infty$ we have $|x_{n_j}| > 1$. Thus \[
\sum_{n=1}^{\infty} |x_n|^p  \geq \sum_{j=1}^{\infty} |x_{n_j}|^p > \sum_{j=1}^{\infty} 1^p = \infty
\]which contradicts with \(\sum_{n=1}^{\infty} |x_n|^p < \infty\). Therefore we have: \[
\sup_{n} |x_n| < \infty
\]
This shows that \[
\ell^p \subseteq \ell^\infty
\] Since $p>1$ is arbitrary, this proves that \[
\bigcup_{1<p<\infty} \ell^p \subseteq \ell^\infty
\]Now we show the inclusion is strict. Consider the sequence \( x_n = 1 \) for all \( n \). Clearly, \(( x_n)\in \ell^\infty \) because it is bounded. However, \( x_n \notin \ell^p \) for any \( p > 1 \):
\[
\sum_{n=1}^{\infty} |1|^p = \sum_{n=1}^{\infty} 1 = \infty
\]
This shows \[
\bigcup_{1<p<\infty} \ell^p \not =  \ell^\infty
\]Thus we have \[
\bigcup_{1<p<\infty} \ell^p \subsetneq \ell^\infty
\]
\end{proof}




\vspace*{10mm}

\begin{center}
  \textit{Nur f\"ur Verr\"uckte}
\end{center}
(It's \textbf{really} not necessary to attempt these problems. Do not, under any circumstances, hand them in!) 

\section{Prescribing a Lebesgue density, Season 2}
  Let $0<\alpha <1$ and $n\ge 1$. 
    Find an example of a Lebesgue measurable subset $E$ of $\mathcal{L}(\mathbb{R})^n$ whose density at $0$ is $\alpha$.
    \textit{Hint}: think spherically.









\end{document}